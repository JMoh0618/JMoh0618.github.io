<?xml version="1.0" encoding="utf-8"?>
<search> 
  
  
    
    <entry>
      <title>初识C语言（1）</title>
      <link href="/article/f8a5abcf.html"/>
      <url>/article/f8a5abcf.html</url>
      
        <content type="html"><![CDATA[<h2 id="初次新建项目并编写代码"><a href="#初次新建项目并编写代码" class="headerlink" title="初次新建项目并编写代码"></a>初次新建项目并编写代码</h2><p>使用VS2019，新建一个C++的空项目<code>test_1</code></p><p>在<code>解决方案资源管理器</code>中找到 <code>test_1</code>，右键其中的源文件进行新建一个<code>test.c</code></p><p><strong>编写代码</strong></p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//1.主函数（main函数）</span></span><br><span class="line"><span class="comment">//一个工程中可以含有多个.c文件，但只能有一个main函数</span></span><br><span class="line"><span class="comment">//c语言是从主函数第一行代码开始执行，所以需要一个main函数-入口</span></span><br><span class="line"><span class="comment">//int为函数的返回类型 int是整型的意思 main为函数名 &#123;&#125;为函数体</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//printf 库函数 屏幕上打印信息</span></span><br><span class="line"><span class="comment">//printf的使用 需要引用头文件 stdio.h</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//编译+链接+运行代码 ctrl+f5</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;Hello&quot;</span>);</span><br><span class="line">    <span class="comment">//%d 表示打印的是一个整数</span></span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;%d\n&quot;</span>, <span class="number">100</span>);</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="数据类型"><a href="#数据类型" class="headerlink" title="数据类型"></a>数据类型</h2><p>char - 字符数据类型</p><p>short - 短整型</p><p>int - 整型</p><p>long - 长整型</p><p>long long - 更长的整型</p><p>float - 单精度浮点数</p><p>double - 双精度浮点数</p><p><strong>注：float与double的区别在于 double的精度会高于float</strong></p><p><strong>比如圆周率3.1415926… 用float来表示，最多精确到小数点的后6位，而double大约可以精确到小数点后15位左右，具体精确的位数和编译器有关</strong></p><p><strong>当然，double的占用内存空间也更高</strong></p><h3 id="数据类型的占用内存"><a href="#数据类型的占用内存" class="headerlink" title="数据类型的占用内存"></a>数据类型的占用内存</h3><p><code>sizeof</code> 用于计算数据类型和变量所占空间的大小</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;%d\n&quot;</span>, <span class="keyword">sizeof</span>(<span class="type">char</span>));<span class="comment">//1</span></span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;%d\n&quot;</span>, <span class="keyword">sizeof</span>(<span class="type">short</span>));<span class="comment">//2</span></span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;%d\n&quot;</span>, <span class="keyword">sizeof</span>(<span class="type">int</span>));<span class="comment">//4</span></span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;%d\n&quot;</span>, <span class="keyword">sizeof</span>(<span class="type">long</span>));<span class="comment">//4</span></span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;%d\n&quot;</span>, <span class="keyword">sizeof</span>(<span class="type">long</span> <span class="type">long</span>));<span class="comment">//8</span></span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;%d\n&quot;</span>, <span class="keyword">sizeof</span>(<span class="type">float</span>));<span class="comment">//4</span></span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;%d\n&quot;</span>, <span class="keyword">sizeof</span>(<span class="type">double</span>));<span class="comment">//8</span></span><br></pre></td></tr></table></figure><p><strong>注：在C语言标准中 sizeof(int) &gt;= sizeof(long) 即可， 所以两者都是4 byte的大小</strong></p><p><strong>那么，<code>sizeof</code> 的单位是什么呢？</strong></p><p>答案是：字节 - byte</p><p><strong>扩展：</strong>计算机中的单位：</p><ul><li><p>​    bit - 比特位 （一个比特位可以储存一个二进制位）</p></li><li><p>​    byte - 字节 - 8bit  </p></li><li><p>​    kb - 1024byte</p></li><li><p>​    mb - 1024kb</p></li><li><p>​    gb - 1024mb</p></li><li><p>​    tb - 1024gb</p></li><li><p>​    pb - 1024tb</p></li></ul><h2 id="常量与变量"><a href="#常量与变量" class="headerlink" title="常量与变量"></a>常量与变量</h2><p>常量 - 不能改变的量</p><p>变量 - 能被改变的量 </p><h3 id="变量"><a href="#变量" class="headerlink" title="变量"></a>变量</h3><h4 id="定义变量"><a href="#定义变量" class="headerlink" title="定义变量"></a>定义变量</h4><p>数据类型 变量名 = 值 ；</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//%lf 表示打印的是一个双精度浮点数</span></span><br><span class="line"><span class="comment">//%f 表示打印的是一个单精度浮点数</span></span><br><span class="line"><span class="type">int</span> age = <span class="number">20</span>;</span><br><span class="line"><span class="type">double</span> weight = <span class="number">75.3</span>;</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;%d\n&quot;</span>, age);</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;%lf\n&quot;</span>, weight);</span><br></pre></td></tr></table></figure><h4 id="变量的分类"><a href="#变量的分类" class="headerlink" title="变量的分类"></a>变量的分类</h4><p>变量分为：局部变量和全局变量</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//全局变量 - &#123;&#125;外部定义的变量</span></span><br><span class="line"><span class="type">int</span> a = <span class="number">100</span>;</span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="comment">//局部变量 - &#123;&#125;内部定义的变量</span></span><br><span class="line"><span class="comment">//当局部变量和全局变量名字冲突时，局部优先</span></span><br><span class="line">    <span class="comment">//写代码时，不建议把全局变量和局部变量名字命名成一样的</span></span><br><span class="line"><span class="type">int</span> a = <span class="number">10</span>;</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;%d\n&quot;</span>, a); <span class="comment">//10</span></span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="变量的应用"><a href="#变量的应用" class="headerlink" title="变量的应用"></a>变量的应用</h4><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//计算输入的两个值的和</span></span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="type">int</span> a = <span class="number">0</span>;</span><br><span class="line"><span class="type">int</span> b = <span class="number">0</span>;</span><br><span class="line"><span class="type">int</span> sum = <span class="number">0</span>;</span><br><span class="line"><span class="comment">//scanf 是输入函数 &amp;a是把输入的值存放到a里，&amp;b是把输入的值存放到b里</span></span><br><span class="line"><span class="built_in">scanf</span>(<span class="string">&quot;%d %d&quot;</span>,&amp;a,&amp;b);</span><br><span class="line">sum = a + b;</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;sum = %d\n&quot;</span>, sum);</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>注意这时会报一个错误，告诉你无法使用<code>scanf</code>，请替换成<code>scanf_s</code></p><p>而<code>scanf_s</code>函数是VS编译提供的，并不是C语言标准，只能在VS编译器下运行</p><p><strong>‘scanf’: This function or variable may be unsafe. Consider using scanf_s instead. To disable deprecation, use _CRT_SECURE_NO_WARNINGS. See online help for details.</strong></p><p>在文件第一行加上下列代码即可解决报错</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">define</span> _CRT_SECURE_NO_WARNINGS 1</span></span><br></pre></td></tr></table></figure><p><strong>也可以找到vs的根目录，搜索<code>newc++file.cpp</code>文件，管理员运行后添加以上代码，之后新建的文件都会自动填写上这串代码</strong></p><h4 id="变量的作用域"><a href="#变量的作用域" class="headerlink" title="变量的作用域"></a>变量的作用域</h4><p>局部变量的作用域：就是变量所在的局部范围<br>全局变量的作用域：整个工程</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//作用域和生命周期</span></span><br><span class="line"><span class="type">int</span> val = <span class="number">2022</span>;</span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;1: %d\n&quot;</span>, val);</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;hello\n&quot;</span>);</span><br><span class="line"><span class="comment">//printf(&quot;a = %d\n&quot;, a); //报错</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="type">int</span> a = <span class="number">10</span>;</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;a = %d\n&quot;</span>, a); <span class="comment">//a = 10</span></span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;2: %d\n&quot;</span>, val);</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;3: %d\n&quot;</span>, val);</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>注意：全局变量的作用域是整个工程，你可以在其他源文件中定义一个全局变量</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> val = <span class="number">2023</span>;</span><br></pre></td></tr></table></figure><p>当你需要在其他文件使用这个全局变量时，你需要声明变量才可以使用</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//声明变量</span></span><br><span class="line"><span class="keyword">extern</span> <span class="type">int</span> val;</span><br></pre></td></tr></table></figure><h4 id="生命周期"><a href="#生命周期" class="headerlink" title="生命周期"></a>生命周期</h4><p>变量的生命周期：变量的创建和销毁之间的时间段</p><p>局部变量的生命周期：进入作用域时生命周期开始，出作用域生命周期结束</p><p>全局变量的生命周期：程序的生命周期</p><h3 id="常量"><a href="#常量" class="headerlink" title="常量"></a>常量</h3><h4 id="常量的分类"><a href="#常量的分类" class="headerlink" title="常量的分类"></a>常量的分类</h4><ul><li>字面常量</li><li><code>const</code>修饰的常变量</li><li>#define定义的标识符常量</li><li>枚举常量</li></ul><p><strong>字面常量</strong></p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//1.字面常量</span></span><br><span class="line"><span class="number">3.14</span>;</span><br><span class="line"><span class="number">10</span>;</span><br><span class="line"><span class="string">&#x27;a&#x27;</span>;</span><br><span class="line"><span class="string">&quot;hello&quot;</span>;</span><br></pre></td></tr></table></figure><p><strong><code>const</code>修饰的常变量</strong></p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//2.`const`修饰的常变量</span></span><br><span class="line"><span class="type">const</span> <span class="type">int</span> num = <span class="number">10</span>; <span class="comment">//注意num为常变量 - 具有常属性（不能被改变的属性）</span></span><br><span class="line"><span class="comment">//num = 20; //报错无法修改</span></span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;num = %d\n&quot;</span>,num);</span><br></pre></td></tr></table></figure><p><strong>#define定义的标识符常量</strong></p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//3.#define定义的标识符常量</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> MAX 10000 <span class="comment">//#define定义的常量</span></span></span><br><span class="line"><span class="type">int</span> n = MAX;</span><br><span class="line"><span class="comment">//MAX = 20000; //报错</span></span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;n = %d\n&quot;</span>, n);</span><br></pre></td></tr></table></figure><p><strong>枚举常量</strong></p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//性别</span></span><br><span class="line"><span class="comment">//enum为枚举关键字</span></span><br><span class="line"><span class="class"><span class="keyword">enum</span> <span class="title">Sex</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line"><span class="comment">//这种枚举类型变量的未来可能取值</span></span><br><span class="line"><span class="comment">//枚举常量</span></span><br><span class="line"><span class="comment">//MALE = 3,赋初值 赋初值后下面打印输出的则依次是3 4 5</span></span><br><span class="line">MALE,</span><br><span class="line">FEMALE,</span><br><span class="line">SECRET,</span><br><span class="line">&#125;;</span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="comment">//4.枚举常量</span></span><br><span class="line"><span class="comment">//可以一一列举的常量</span></span><br><span class="line"><span class="class"><span class="keyword">enum</span> <span class="title">Sex</span> <span class="title">s</span> =</span> MALE;</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;%d\n&quot;</span>, MALE);<span class="comment">//0</span></span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;%d\n&quot;</span>, FEMALE);<span class="comment">//1</span></span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;%d\n&quot;</span>, SECRET);<span class="comment">//2</span></span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> C语言 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> C语言 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Uni-App图形验证码</title>
      <link href="/article/1e6d7440.html"/>
      <url>/article/1e6d7440.html</url>
      
        <content type="html"><![CDATA[<h2 id="一、功能概述"><a href="#一、功能概述" class="headerlink" title="一、功能概述"></a>一、功能概述</h2><p>点击按钮后，弹出一个窗口，进行图形验证，验证失败进行抖动，成功后返回滑块的x轴。</p><h2 id="二、功能制作"><a href="#二、功能制作" class="headerlink" title="二、功能制作"></a>二、功能制作</h2><p><strong>新建一个<code>home.vue</code>页面，设置一个按钮，点击后弹出<code>slideCode</code>组件</strong></p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">template</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">view</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">button</span> @<span class="attr">click</span>=<span class="string">&quot;slideCode_show = true&quot;</span>&gt;</span>点击获取图形验证码<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">slideCode</span> <span class="attr">v-if</span>=<span class="string">&quot;slideCode_show&quot;</span> <span class="attr">:session_id</span>=<span class="string">&quot;session_id[0]&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">slideCode</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript"><span class="keyword">import</span> slideCode <span class="keyword">from</span> <span class="string">&#x27;../../components/slideCode/slideCode.vue&#x27;</span></span></span><br><span class="line"><span class="language-javascript"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span></span><br><span class="line"><span class="language-javascript"><span class="title function_">data</span>(<span class="params"></span>) &#123;</span></span><br><span class="line"><span class="language-javascript"><span class="keyword">return</span>&#123;</span></span><br><span class="line"><span class="language-javascript"><span class="attr">slideCode_show</span>: <span class="literal">false</span>, <span class="comment">//图形验证码是否显示</span></span></span><br><span class="line"><span class="language-javascript">                <span class="comment">//验证码id</span></span></span><br><span class="line"><span class="language-javascript"><span class="attr">session_id</span>: [<span class="title class_">Math</span>.<span class="title function_">floor</span>(<span class="title class_">Math</span>.<span class="title function_">random</span>() * <span class="number">9999999999</span>)],</span></span><br><span class="line"><span class="language-javascript"><span class="attr">slideCode_x</span>:<span class="string">&#x27;&#x27;</span></span></span><br><span class="line"><span class="language-javascript">&#125;</span></span><br><span class="line"><span class="language-javascript">&#125;,</span></span><br><span class="line"><span class="language-javascript"><span class="attr">components</span>:&#123;</span></span><br><span class="line"><span class="language-javascript">slideCode</span></span><br><span class="line"><span class="language-javascript">&#125;,</span></span><br><span class="line"><span class="language-javascript"><span class="attr">methods</span>:&#123;</span></span><br><span class="line"><span class="language-javascript">&#125;</span></span><br><span class="line"><span class="language-javascript">&#125;</span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure><p><strong>新建<code>slideCode</code>组件，设置遮罩层和固定滑动验证码位置</strong></p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">&quot;slideCode&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">&quot;zhuti&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br></pre></td></tr></table></figure><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">&lt;style lang=&quot;scss&quot; scoped&gt;</span><br><span class="line"><span class="selector-class">.slideCode</span> &#123;</span><br><span class="line"><span class="attribute">background</span>: <span class="built_in">rgba</span>(<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0.3</span>);</span><br><span class="line"><span class="attribute">width</span>: <span class="number">750</span>rpx;</span><br><span class="line"><span class="attribute">height</span>: <span class="number">100vh</span>;</span><br><span class="line"><span class="attribute">position</span>: fixed;</span><br><span class="line"><span class="attribute">top</span>: <span class="number">0</span>;</span><br><span class="line"><span class="attribute">left</span>: <span class="number">0</span>;</span><br><span class="line"><span class="attribute">z-index</span>: <span class="number">999999</span>;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.zhuti</span> &#123;</span><br><span class="line"><span class="attribute">width</span>: <span class="number">600</span>rpx;</span><br><span class="line"><span class="attribute">background</span>: <span class="number">#FFF</span>;</span><br><span class="line"><span class="attribute">position</span>: absolute;</span><br><span class="line"><span class="attribute">top</span>: <span class="number">50%</span>;</span><br><span class="line"><span class="attribute">left</span>: <span class="number">50%</span>;</span><br><span class="line"><span class="attribute">transform</span>: <span class="built_in">translate</span>(-<span class="number">50%</span>, -<span class="number">50%</span>);</span><br><span class="line"><span class="attribute">padding</span>: <span class="number">20</span>rpx <span class="number">25</span>rpx <span class="number">30</span>rpx <span class="number">25</span>rpx;</span><br><span class="line">       &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&lt;/style&gt;</span><br></pre></td></tr></table></figure><p><strong>给滑动图形验证码设置标题</strong></p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">&quot;slideCode&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">&quot;zhuti&quot;</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- 滑动验证码标题 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">view</span> <span class="attr">:class</span>=<span class="string">&quot;[&#x27;msg&#x27;, msgColor]&quot;</span>&gt;</span>&#123;&#123;msg&#125;&#125;<span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">&quot;title&quot;</span>&gt;</span>拖动下方滑块完成拼图<span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br></pre></td></tr></table></figure><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">&lt;script&gt;</span><br><span class="line">    <span class="keyword">export</span> <span class="keyword">default</span> &#123;</span><br><span class="line"><span class="title function_">data</span>(<span class="params"></span>) &#123;</span><br><span class="line"><span class="keyword">return</span> &#123;</span><br><span class="line"><span class="attr">msgColor</span>: <span class="string">&#x27;&#x27;</span>,</span><br><span class="line"><span class="attr">msg</span>: <span class="string">&#x27;安全验证&#x27;</span>,</span><br><span class="line"><span class="attr">msgText</span>: <span class="string">&#x27;加载中&#x27;</span>, <span class="comment">//验证码文字</span></span><br><span class="line">&#125;</span><br><span class="line">&#125;,</span><br><span class="line">&#125;</span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></table></figure><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">//标题提示</span><br><span class="line"><span class="selector-class">.msg</span> &#123;</span><br><span class="line"><span class="attribute">color</span>: <span class="number">#999</span>;</span><br><span class="line"><span class="attribute">font-size</span>: <span class="number">24</span>rpx;</span><br><span class="line"></span><br><span class="line">&amp;<span class="selector-class">.red</span> &#123;</span><br><span class="line"><span class="attribute">color</span>: red;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&amp;<span class="selector-class">.green</span> &#123;</span><br><span class="line"><span class="attribute">color</span>: green;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">//标题</span><br><span class="line"><span class="selector-class">.title</span> &#123;</span><br><span class="line"><span class="attribute">font-size</span>: <span class="number">28</span>rpx;</span><br><span class="line"><span class="attribute">line-height</span>: <span class="number">38</span>rpx;</span><br><span class="line"><span class="attribute">color</span>: <span class="number">#333</span>;</span><br><span class="line"><span class="attribute">margin</span>: <span class="number">0</span> <span class="number">0</span> <span class="number">7</span>rpx <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>然后开始制作图形验证码，这里用到了Uni-App的<code>&lt;movable-area&gt;</code>可拖动区域组件</strong></p><p>拿到父组件传过来的参数</p><p>当图片未加载时，显示一个加载中</p><p>当图片加载完成后，显示图片</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">movable-area</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- 当主图片未加载时显示 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">view</span> <span class="attr">id</span>=<span class="string">&quot;msg&quot;</span> <span class="attr">v-if</span>=<span class="string">&quot;zhutuPic === &#x27;&#x27;&quot;</span>&gt;</span>&#123;&#123;msgText&#125;&#125;<span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- 主图片加载成功 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">view</span> <span class="attr">id</span>=<span class="string">&quot;pic&quot;</span> <span class="attr">v-else</span> <span class="attr">:style</span>=<span class="string">&quot;&#123;&#x27;background-image&#x27;: &#x27;url(&#x27;+zhutuPic+&#x27;)&#x27;&#125;&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">movable-area</span>&gt;</span></span><br></pre></td></tr></table></figure><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><span class="line">&lt;script&gt;</span><br><span class="line">    <span class="keyword">export</span> <span class="keyword">default</span> &#123;</span><br><span class="line"><span class="comment">//从父元素中拿到session_id</span></span><br><span class="line"><span class="attr">props</span>: &#123;</span><br><span class="line"><span class="attr">session_id</span>: &#123;</span><br><span class="line"><span class="attr">type</span>: <span class="title class_">Number</span>,</span><br><span class="line"><span class="attr">default</span>: <span class="number">0</span></span><br><span class="line">&#125;,</span><br><span class="line">&#125;,</span><br><span class="line"><span class="title function_">data</span>(<span class="params"></span>) &#123;</span><br><span class="line"><span class="keyword">return</span> &#123;</span><br><span class="line"><span class="attr">zhutuPic</span>: <span class="string">&#x27;&#x27;</span>, <span class="comment">//主图</span></span><br><span class="line"><span class="attr">futuPic</span>: <span class="string">&#x27;&#x27;</span>, <span class="comment">//缺口图</span></span><br><span class="line"><span class="attr">msgColor</span>: <span class="string">&#x27;&#x27;</span>,</span><br><span class="line"><span class="attr">msg</span>: <span class="string">&#x27;安全验证&#x27;</span>,</span><br><span class="line"><span class="attr">msgText</span>: <span class="string">&#x27;加载中&#x27;</span>, <span class="comment">//验证码文字</span></span><br><span class="line">&#125;</span><br><span class="line">&#125;,</span><br><span class="line"><span class="title function_">mounted</span>(<span class="params"></span>) &#123;</span><br><span class="line"><span class="variable language_">this</span>.<span class="title function_">shuaxin</span>()</span><br><span class="line">&#125;,</span><br><span class="line"><span class="attr">methods</span>: &#123;</span><br><span class="line"><span class="title function_">shuaxin</span>(<span class="params"></span>) &#123;</span><br><span class="line">uni.<span class="title function_">request</span>(&#123;</span><br><span class="line"><span class="attr">method</span>: <span class="string">&#x27;get&#x27;</span>,</span><br><span class="line"><span class="attr">dataType</span>: <span class="string">&#x27;json&#x27;</span>,</span><br><span class="line"><span class="attr">timeout</span>: <span class="number">7000</span>,</span><br><span class="line"><span class="attr">url</span>: <span class="string">&#x27;&#x27;</span><span class="comment">//后端接口地址,</span></span><br><span class="line"><span class="attr">data</span>: &#123;</span><br><span class="line"><span class="comment">//传给后端的数据</span></span><br><span class="line">&#125;,</span><br><span class="line"><span class="attr">success</span>: <span class="function">(<span class="params">res</span>) =&gt;</span> &#123;</span><br><span class="line"><span class="keyword">if</span> (res.<span class="property">data</span>.<span class="property">status</span> == <span class="number">200</span>) &#123; <span class="comment">//生成验证码成功</span></span><br><span class="line"><span class="variable language_">this</span>.<span class="property">zhutuPic</span> = <span class="string">&#x27;&#x27;</span><span class="comment">//后端接口图片地址</span></span><br><span class="line"><span class="variable language_">this</span>.<span class="property">futuPic</span> = <span class="string">&#x27;&#x27;</span><span class="comment">//后端接口图片地址</span></span><br><span class="line">&#125;</span><br><span class="line">&#125;,</span><br><span class="line"><span class="attr">complete</span>: <span class="function">(<span class="params">res</span>) =&gt;</span> &#123;</span><br><span class="line"><span class="comment">//错误的提示</span></span><br><span class="line"><span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line"><span class="keyword">if</span> (res.<span class="property">data</span>.<span class="property">status</span> != <span class="number">200</span>) &#123;</span><br><span class="line"><span class="variable language_">this</span>.<span class="property">msgText</span> = res.<span class="property">message</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&#125;, <span class="number">300</span>);</span><br><span class="line">&#125;</span><br><span class="line">&#125;);</span><br><span class="line">&#125;,</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></table></figure><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">movable-area &#123;</span><br><span class="line"><span class="attribute">width</span>: <span class="number">100%</span>;</span><br><span class="line"><span class="attribute">height</span>: auto;</span><br><span class="line"></span><br><span class="line">//主图片未加载</span><br><span class="line"><span class="selector-id">#msg</span> &#123;</span><br><span class="line"><span class="attribute">width</span>: <span class="number">100%</span>;</span><br><span class="line"><span class="attribute">line-height</span>: <span class="number">310</span>rpx;</span><br><span class="line"><span class="attribute">text-align</span>: center;</span><br><span class="line"><span class="attribute">font-size</span>: <span class="number">30</span>rpx;</span><br><span class="line"><span class="attribute">color</span>: <span class="number">#999</span>;</span><br><span class="line"><span class="attribute">background</span>: <span class="number">#F8F8F8</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">//主图片</span><br><span class="line"><span class="selector-id">#pic</span> &#123;</span><br><span class="line"><span class="attribute">width</span>: <span class="number">100%</span>;</span><br><span class="line"><span class="attribute">height</span>: <span class="number">310</span>rpx;</span><br><span class="line"><span class="attribute">background-color</span>: <span class="number">#F8F8F8</span>;</span><br><span class="line"><span class="attribute">background-size</span>: <span class="number">100%</span> <span class="number">310</span>rpx;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><img src="/article/1e6d7440/gif2.gif" class title="效果展示"> <p><strong>制作滑动栏</strong></p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">movable-area</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- 当主图片未加载时显示 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">view</span> <span class="attr">id</span>=<span class="string">&quot;msg&quot;</span> <span class="attr">v-if</span>=<span class="string">&quot;zhutuPic === &#x27;&#x27;&quot;</span>&gt;</span>&#123;&#123;msgText&#125;&#125;<span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- 主图片加载成功 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">view</span> <span class="attr">id</span>=<span class="string">&quot;pic&quot;</span> <span class="attr">v-else</span> <span class="attr">:style</span>=<span class="string">&quot;&#123;&#x27;background-image&#x27;: &#x27;url(&#x27;+zhutuPic+&#x27;)&#x27;&#125;&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">view</span> <span class="attr">id</span>=<span class="string">&quot;line&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">movable-area</span>&gt;</span></span><br></pre></td></tr></table></figure><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">//滑动栏</span><br><span class="line"><span class="selector-id">#line</span> &#123;</span><br><span class="line"><span class="attribute">background</span>: <span class="number">#e4e4e4</span>;</span><br><span class="line"><span class="attribute">width</span>: <span class="number">100%</span>;</span><br><span class="line"><span class="attribute">height</span>: <span class="number">20</span>rpx;</span><br><span class="line"><span class="attribute">margin</span>: <span class="number">42</span>rpx <span class="number">0</span> <span class="number">15</span>rpx <span class="number">0</span>;</span><br><span class="line"><span class="attribute">border-radius</span>: <span class="number">50</span>rpx;</span><br><span class="line"><span class="attribute">display</span>: inline-block;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>然后使用<code>movable-view</code>可拖拽区域，制作一个拖动按钮和滑块</strong></p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- 可拖拽区域  damping用于控制x或y改变时的动画和过界回弹的动画  direction移动方向--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">movable-view</span> <span class="attr">:style</span>=<span class="string">&quot;&#123;&#x27;background-image&#x27;: &#x27;url(&#x27;+futuPic+&#x27;)&#x27;&#125;&quot;</span> <span class="attr">direction</span>=<span class="string">&quot;horizontal&quot;</span> <span class="attr">:damping</span>=<span class="string">&quot;100&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">&quot;blue&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">movable-view</span>&gt;</span></span><br></pre></td></tr></table></figure><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">movable-view &#123;</span><br><span class="line"><span class="attribute">width</span>: <span class="number">78</span>rpx;</span><br><span class="line"><span class="attribute">height</span>: <span class="number">310</span>rpx;</span><br><span class="line"><span class="attribute">background-size</span>: <span class="number">100%</span> <span class="number">310</span>rpx;</span><br><span class="line"><span class="attribute">background-repeat</span>: no-repeat;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.blue</span> &#123;</span><br><span class="line"><span class="attribute">box-shadow</span>: <span class="built_in">rgba</span>(<span class="number">26</span>, <span class="number">101</span>, <span class="number">255</span>, <span class="number">0.52</span>) <span class="number">0px</span> <span class="number">0px</span> <span class="number">10px</span> <span class="number">1px</span>;</span><br><span class="line"><span class="attribute">width</span>: <span class="number">100</span>rpx;</span><br><span class="line"><span class="attribute">height</span>: <span class="number">50</span>rpx;</span><br><span class="line"><span class="attribute">border-radius</span>: <span class="number">50</span>rpx;</span><br><span class="line"><span class="attribute">position</span>: absolute;</span><br><span class="line"><span class="attribute">top</span>: <span class="number">100%</span>;</span><br><span class="line"><span class="attribute">left</span>: <span class="number">0</span>;</span><br><span class="line"><span class="attribute">background</span>: <span class="built_in">rgb</span>(<span class="number">26</span>, <span class="number">101</span>, <span class="number">255</span>) <span class="built_in">url</span>(<span class="string">data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACgAAAAcAgMAAABuexVFAAAACVBMVEUAAADCwsL9/f1P0DqbAAAAAXRSTlMAQObYZgAAAB1JREFUGNNjCGVgYGANABKhyMwoEHMBkIgaZWIwAdyJJQnaJRg5AAAAAElFTkSuQmCC</span>) no-repeat;</span><br><span class="line"><span class="attribute">background-size</span>: auto <span class="number">20</span>rpx;</span><br><span class="line"><span class="attribute">background-position</span>: <span class="number">50%</span> <span class="number">50%</span>;</span><br><span class="line"><span class="attribute">margin</span>: <span class="number">25</span>rpx <span class="number">0</span> <span class="number">0</span> -<span class="number">14</span>rpx;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><img src="/article/1e6d7440/gif3.gif" class title="效果展示"> <p><strong>然后制作一个返回的图标，并在父组件中获取到子组件的传值</strong></p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- 关闭 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">&quot;close iconfont icon-guanbi1&quot;</span> @<span class="attr">click</span>=<span class="string">&quot;$emit(&#x27;close&#x27;)&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br></pre></td></tr></table></figure><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">@font-face</span> &#123;</span><br><span class="line"><span class="attribute">font-family</span>: <span class="string">&quot;iconfont&quot;</span>;</span><br><span class="line"><span class="comment">/* Project id 2455983 */</span></span><br><span class="line"><span class="attribute">src</span>:</span><br><span class="line"><span class="built_in">url</span>(<span class="string">&#x27;data:application/x-font-woff2;charset=utf-8;base64,d09GMgABAAAAAALEAAsAAAAABngAAAJ5AAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHFQGYACCcApweQE2AiQDCAsGAAQgBYRnBzEbtgUR1ZMhZH8r7lgI/uPREFlgoVBNm5PkuTjzBokvYm9bLZ7Q8ql1k55Aj4zHA0PJeeB/P9x9MjPtolU0rW5JQ58nSAudRqXRCFGs4ZnI+eCEm0caBUARHIiSJ0Je/uBN7D5M8JMncnEcb597Vhpwgr8zfqrALG7aKReheBK7c9X1PWkpfRCyJ+xa5EeKSpKryiT9ZEEApKX5fpaTvxt1KX8DeuAFkS/0PYVK65ROBxbA6AOlV0sohJmgx6MguyNQSw7DMwIqzVsWN3eXu6g9l5xFp8wZDuT14dw7KcrliCzTfLmgFN2bhZdKiE/xxIv48+FvAqKSxGnaPdsa8bZnd0ECRaUvXa6DPhZRgoRpZMJhf2ZbEtr4pNKTDdLWLPBD8aFbOLRD+Ouc2mrQTcVnknz5UWsjyOloL0YmjSXW1/YPW4yJ8wNQ0CBGoTk8cxF1ZFyBX8NkS3/87kgP5pT/K75uD9c2/dWjVVAsXYoFBF57v7LKf5TB1zsOFctgPsp36An8HfUEJGYzRszXKBEQVWlSKqLSjVPgBBp9m2o03UUhKNd0L74yXTmScoNU5iZRosoiSpVbQqUpW4erNLmWhFyBUTcEQb1XiGq9QVLvHZW59yjR6idK1fuPSsfBOK/KaBD0mlAyGlA/8Lpk6+kc272ie0VJTckn0uJpHNqqqeb3mJHm2LC8XcdswVJJsBMfwxgLTFRG1FwNzFNf17btLZUuSawJJaMB9QOvS7Yhmcvfd0X3ipJA6pmhxVP70FYNQO2VDPU8yCvL23XMFiyVBDt5FsZYYGqfNaLmapiQmvraJVlUqbbX0t8TBnDMuHKnJpJ7yax8KwQA&#x27;</span>) <span class="built_in">format</span>(<span class="string">&#x27;woff2&#x27;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.iconfont</span> &#123;</span><br><span class="line"><span class="attribute">font-family</span>: <span class="string">&quot;iconfont&quot;</span> <span class="meta">!important</span>;</span><br><span class="line"><span class="attribute">font-size</span>: <span class="number">16px</span>;</span><br><span class="line"><span class="attribute">font-style</span>: normal;</span><br><span class="line">-webkit-<span class="attribute">font-smoothing</span>: antialiased;</span><br><span class="line">-moz-osx-<span class="attribute">font-smoothing</span>: grayscale;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.icon-guanbi1</span><span class="selector-pseudo">:before</span> &#123;</span><br><span class="line"><span class="attribute">content</span>: <span class="string">&quot;\e696&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.close</span> &#123;</span><br><span class="line"><span class="attribute">position</span>: absolute;</span><br><span class="line"><span class="attribute">top</span>: <span class="number">20</span>rpx;</span><br><span class="line"><span class="attribute">right</span>: <span class="number">20</span>rpx;</span><br><span class="line"><span class="attribute">color</span>: <span class="number">#A6A6A6</span>;</span><br><span class="line"><span class="attribute">font-size</span>: <span class="number">36</span>rpx;</span><br><span class="line"><span class="attribute">padding</span>: <span class="number">10</span>rpx;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><code>home.vue</code></p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">view</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">button</span> @<span class="attr">click</span>=<span class="string">&quot;slideCode_show = true&quot;</span>&gt;</span>点击获取图形验证码<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">slideCode</span> <span class="attr">v-if</span>=<span class="string">&quot;slideCode_show&quot;</span> <span class="attr">:session_id</span>=<span class="string">&quot;session_id[0]&quot;</span> @<span class="attr">close</span>=<span class="string">&quot;slideCode_show = false&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">slideCode</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br></pre></td></tr></table></figure><p><strong>之后就是编写滑动验证码的事件</strong></p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- 可拖拽区域  damping用于控制x或y改变时的动画和过界回弹的动画  direction移动方向</span></span><br><span class="line"><span class="comment">@change拖动过程中触发的事件 @touchend触凭到过程中不断触发事件--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">movable-view</span> <span class="attr">:x</span>=<span class="string">&quot;x&quot;</span> <span class="attr">direction</span>=<span class="string">&quot;horizontal&quot;</span> <span class="attr">:style</span>=<span class="string">&quot;&#123;&#x27;background-image&#x27;: &#x27;url(&#x27;+futuPic+&#x27;)&#x27;&#125;&quot;</span> <span class="attr">:damping</span>=<span class="string">&quot;100&quot;</span> @<span class="attr">change</span>=<span class="string">&quot;onChange&quot;</span> @<span class="attr">touchend</span>=<span class="string">&quot;touchEnd&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">&quot;blue&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">movable-view</span>&gt;</span></span><br></pre></td></tr></table></figure><p><strong>首先是<code>onChange</code>事件，@change拖动过程中触发的事件</strong></p><p><code>e</code>可以获取拖动事件的数据</p><p>我们判断滑块是否放置正确，来进行之后滑块位置错误的抖动效果。</p><p>并且我们可以实时获取滑块的x轴</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="title function_">onChange</span>(<span class="params">e</span>) &#123;</span><br><span class="line"><span class="keyword">if</span> (e.<span class="property">detail</span>.<span class="property">source</span> === <span class="string">&#x27;touch&#x27;</span>) &#123; <span class="comment">//滑块位置放置正确时 只有是手动触发的，才执行，</span></span><br><span class="line"><span class="variable language_">this</span>.<span class="property">huadong</span> = <span class="literal">true</span> <span class="comment">//判断滑块是否正确</span></span><br><span class="line"><span class="variable language_">this</span>.<span class="property">x</span> = e.<span class="property">detail</span>.<span class="property">x</span> <span class="comment">//滑块x轴</span></span><br><span class="line">&#125;</span><br><span class="line">&#125;,</span><br></pre></td></tr></table></figure><p><strong>然后是<code>touchEnd</code>事件，@touchend触凭到过程中不断触发事件</strong></p><p>成功后返回给父组件值，失败后进行抖动</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line"><span class="title function_">touchEnd</span>(<span class="params"></span>) &#123;</span><br><span class="line"><span class="keyword">if</span> (<span class="variable language_">this</span>.<span class="property">huadong</span> === <span class="literal">true</span>) &#123; <span class="comment">//只有拖动过后松开，才会触发，当然这个主要是应对pc端的（pc端是监听body的松开），移动端没这问题</span></span><br><span class="line"><span class="variable language_">this</span>.<span class="property">msg</span> = <span class="string">&#x27;验证中...&#x27;</span></span><br><span class="line"><span class="variable language_">this</span>.<span class="property">msgColor</span> = <span class="string">&#x27;&#x27;</span></span><br><span class="line">uni.<span class="title function_">request</span>(&#123;</span><br><span class="line"><span class="attr">method</span>: <span class="string">&#x27;get&#x27;</span>,</span><br><span class="line"><span class="attr">dataType</span>: <span class="string">&#x27;json&#x27;</span>,</span><br><span class="line"><span class="attr">timeout</span>: <span class="number">7000</span>,</span><br><span class="line"><span class="attr">url</span>: <span class="string">&#x27;&#x27;</span><span class="comment">//后端接口地址,</span></span><br><span class="line"><span class="attr">data</span>: &#123;</span><br><span class="line"><span class="attr">type</span>: <span class="string">&#x27;yanzheng&#x27;</span>,</span><br><span class="line"><span class="attr">session_id</span>: <span class="variable language_">this</span>.<span class="property">session_id</span>,</span><br><span class="line"><span class="attr">x</span>: <span class="built_in">parseInt</span>(<span class="variable language_">this</span>.<span class="property">x</span> * (<span class="number">679</span> / uni.<span class="title function_">upx2px</span>(<span class="number">550</span>)) - <span class="number">35</span>) <span class="comment">//因为x是相对于movable-area容器宽度的，所以需要算出图片实际宽度相 对于 容器宽度的比例</span></span><br><span class="line">&#125;,</span><br><span class="line"><span class="attr">success</span>: <span class="function">(<span class="params">res</span>) =&gt;</span> &#123;</span><br><span class="line"><span class="keyword">if</span> (res.<span class="property">data</span>.<span class="property">status</span> == <span class="number">200</span>) &#123;</span><br><span class="line"><span class="comment">//成功后返回给父组件</span></span><br><span class="line"><span class="variable language_">this</span>.$emit(<span class="string">&#x27;success&#x27;</span>, &#123;</span><br><span class="line"><span class="attr">x</span>: <span class="built_in">parseInt</span>(<span class="variable language_">this</span>.<span class="property">x</span> * (<span class="number">679</span> / uni.<span class="title function_">upx2px</span>(<span class="number">550</span>)) - <span class="number">35</span>)</span><br><span class="line">&#125;)</span><br><span class="line"><span class="variable language_">this</span>.<span class="property">msg</span> = <span class="string">&#x27;验证成功&#x27;</span></span><br><span class="line"><span class="variable language_">this</span>.<span class="property">msgColor</span> = <span class="string">&#x27;green&#x27;</span></span><br><span class="line"><span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line"><span class="variable language_">this</span>.$emit(<span class="string">&#x27;close&#x27;</span>)</span><br><span class="line">&#125;, <span class="number">300</span>);</span><br><span class="line">&#125;</span><br><span class="line">&#125;,</span><br><span class="line"><span class="attr">complete</span>: <span class="function">(<span class="params">res</span>) =&gt;</span> &#123;</span><br><span class="line"><span class="variable language_">this</span>.<span class="property">huadong</span> = <span class="literal">false</span>; <span class="comment">//没有在拖动中了</span></span><br><span class="line"><span class="keyword">if</span> (res.<span class="property">data</span>.<span class="property">status</span> != <span class="number">200</span>) &#123;</span><br><span class="line"><span class="variable language_">this</span>.<span class="title function_">doudong</span>() <span class="comment">//抖动</span></span><br><span class="line"><span class="variable language_">this</span>.<span class="property">msg</span> = res.<span class="property">data</span>.<span class="property">message</span></span><br><span class="line"><span class="variable language_">this</span>.<span class="property">msgColor</span> = <span class="string">&#x27;red&#x27;</span></span><br><span class="line"><span class="keyword">if</span> (res.<span class="property">data</span>.<span class="property">message</span> == <span class="string">&#x27;验证码错误次数过多，请重新获取&#x27;</span>) &#123;</span><br><span class="line"><span class="variable language_">this</span>.<span class="property">msg</span> = <span class="string">&#x27;验证失败次数过多，已重新获取&#x27;</span></span><br><span class="line"><span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line"><span class="variable language_">this</span>.<span class="title function_">shuaxin</span>()</span><br><span class="line">&#125;, <span class="number">500</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line"><span class="variable language_">this</span>.<span class="property">msg</span> = <span class="string">&#x27;安全验证&#x27;</span></span><br><span class="line"><span class="variable language_">this</span>.<span class="property">msgColor</span> = <span class="string">&#x27;&#x27;</span></span><br><span class="line">&#125;, <span class="number">3500</span>);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;);</span><br><span class="line">&#125;</span><br><span class="line">&#125;,</span><br></pre></td></tr></table></figure><p><strong>抖动</strong></p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="title function_">doudong</span>(<span class="params"></span>) &#123; <span class="comment">//抖动 【总耗时 500ms】</span></span><br><span class="line"><span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line"><span class="keyword">if</span> (<span class="variable language_">this</span>.<span class="property">huadong</span>) &#123; <span class="comment">//判断，如果滑块放置正确，则不再执行。否则进行抖动</span></span><br><span class="line"><span class="keyword">return</span></span><br><span class="line">&#125; <span class="comment">//如果在拖动中，就不执行了</span></span><br><span class="line"><span class="variable language_">this</span>.<span class="property">x</span> -= <span class="number">15</span>;</span><br><span class="line"><span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line"><span class="keyword">if</span> (<span class="variable language_">this</span>.<span class="property">huadong</span>) &#123;</span><br><span class="line"><span class="keyword">return</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="variable language_">this</span>.<span class="property">x</span> += <span class="number">30</span></span><br><span class="line"><span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line"><span class="keyword">if</span> (<span class="variable language_">this</span>.<span class="property">huadong</span>) &#123;</span><br><span class="line"><span class="keyword">return</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="variable language_">this</span>.<span class="property">x</span> -= <span class="number">30</span></span><br><span class="line"><span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line"><span class="keyword">if</span> (<span class="variable language_">this</span>.<span class="property">huadong</span>) &#123;</span><br><span class="line"><span class="keyword">return</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="variable language_">this</span>.<span class="property">x</span> += <span class="number">30</span></span><br><span class="line"><span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line"><span class="keyword">if</span> (<span class="variable language_">this</span>.<span class="property">huadong</span>) &#123;</span><br><span class="line"><span class="keyword">return</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="variable language_">this</span>.<span class="property">x</span> = <span class="number">10</span></span><br><span class="line">&#125;, <span class="number">100</span>);</span><br><span class="line">&#125;, <span class="number">100</span>);</span><br><span class="line">&#125;, <span class="number">100</span>);</span><br><span class="line">&#125;, <span class="number">100</span>);</span><br><span class="line">&#125;, <span class="number">100</span>);</span><br><span class="line">&#125;,</span><br></pre></td></tr></table></figure><p>父组件<code>home.vue</code></p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">template</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">view</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">button</span> @<span class="attr">click</span>=<span class="string">&quot;slideCode_show = true&quot;</span>&gt;</span>点击获取图形验证码<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">slideCode</span> <span class="attr">v-if</span>=<span class="string">&quot;slideCode_show&quot;</span> <span class="attr">:session_id</span>=<span class="string">&quot;session_id[0]&quot;</span> @<span class="attr">close</span>=<span class="string">&quot;slideCode_show = false&quot;</span></span></span><br><span class="line"><span class="tag">@<span class="attr">success</span>=<span class="string">&quot;slideCode_success&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">slideCode</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript"><span class="keyword">import</span> slideCode <span class="keyword">from</span> <span class="string">&#x27;../../components/slideCode/slideCode.vue&#x27;</span></span></span><br><span class="line"><span class="language-javascript"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span></span><br><span class="line"><span class="language-javascript"><span class="title function_">data</span>(<span class="params"></span>) &#123;</span></span><br><span class="line"><span class="language-javascript"><span class="keyword">return</span>&#123;</span></span><br><span class="line"><span class="language-javascript"><span class="attr">slideCode_show</span>: <span class="literal">false</span>, <span class="comment">//图形验证码是否显示</span></span></span><br><span class="line"><span class="language-javascript"><span class="attr">session_id</span>: [<span class="title class_">Math</span>.<span class="title function_">floor</span>(<span class="title class_">Math</span>.<span class="title function_">random</span>() * <span class="number">9999999999</span>)],</span></span><br><span class="line"><span class="language-javascript"><span class="attr">slideCode_x</span>:<span class="string">&#x27;&#x27;</span></span></span><br><span class="line"><span class="language-javascript">&#125;</span></span><br><span class="line"><span class="language-javascript">&#125;,</span></span><br><span class="line"><span class="language-javascript"><span class="attr">components</span>:&#123;</span></span><br><span class="line"><span class="language-javascript">slideCode</span></span><br><span class="line"><span class="language-javascript">&#125;,</span></span><br><span class="line"><span class="language-javascript"><span class="attr">methods</span>:&#123;</span></span><br><span class="line"><span class="language-javascript"><span class="attr">slideCode_success</span>: <span class="keyword">function</span>(<span class="params">x</span>) &#123; <span class="comment">//验证通过了</span></span></span><br><span class="line"><span class="language-javascript"><span class="variable language_">this</span>.<span class="property">slideCode_x</span> = x <span class="comment">//偏移值</span></span></span><br><span class="line"><span class="language-javascript">uni.<span class="title function_">showToast</span>(&#123;</span></span><br><span class="line"><span class="language-javascript"><span class="attr">icon</span>:<span class="string">&#x27;success&#x27;</span>,</span></span><br><span class="line"><span class="language-javascript"><span class="attr">title</span>:<span class="string">&#x27;成功&#x27;</span></span></span><br><span class="line"><span class="language-javascript">&#125;)</span></span><br><span class="line"><span class="language-javascript"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="variable language_">this</span>.<span class="property">slideCode_x</span> );<span class="comment">//打印输出验证成功后的滑块x轴</span></span></span><br><span class="line"><span class="language-javascript">&#125;,</span></span><br><span class="line"><span class="language-javascript">&#125;</span></span><br><span class="line"><span class="language-javascript">&#125;</span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure><h2 id="三、结果和代码展示"><a href="#三、结果和代码展示" class="headerlink" title="三、结果和代码展示"></a>三、结果和代码展示</h2><img src="/article/1e6d7440/gif.gif" class title="效果展示"> <p><strong>代码展示</strong></p><p><code>home.vue</code></p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">template</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">view</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">button</span> @<span class="attr">click</span>=<span class="string">&quot;slideCode_show = true&quot;</span>&gt;</span>点击获取图形验证码<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">slideCode</span> <span class="attr">v-if</span>=<span class="string">&quot;slideCode_show&quot;</span> <span class="attr">:session_id</span>=<span class="string">&quot;session_id[0]&quot;</span> @<span class="attr">close</span>=<span class="string">&quot;slideCode_show = false&quot;</span></span></span><br><span class="line"><span class="tag">@<span class="attr">success</span>=<span class="string">&quot;slideCode_success&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">slideCode</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript"><span class="keyword">import</span> slideCode <span class="keyword">from</span> <span class="string">&#x27;../../components/slideCode/slideCode.vue&#x27;</span></span></span><br><span class="line"><span class="language-javascript"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span></span><br><span class="line"><span class="language-javascript"><span class="title function_">data</span>(<span class="params"></span>) &#123;</span></span><br><span class="line"><span class="language-javascript"><span class="keyword">return</span>&#123;</span></span><br><span class="line"><span class="language-javascript"><span class="attr">slideCode_show</span>: <span class="literal">false</span>, <span class="comment">//图形验证码是否显示</span></span></span><br><span class="line"><span class="language-javascript"><span class="attr">session_id</span>: [<span class="title class_">Math</span>.<span class="title function_">floor</span>(<span class="title class_">Math</span>.<span class="title function_">random</span>() * <span class="number">9999999999</span>)],</span></span><br><span class="line"><span class="language-javascript"><span class="attr">slideCode_x</span>:<span class="string">&#x27;&#x27;</span></span></span><br><span class="line"><span class="language-javascript">&#125;</span></span><br><span class="line"><span class="language-javascript">&#125;,</span></span><br><span class="line"><span class="language-javascript"><span class="attr">components</span>:&#123;</span></span><br><span class="line"><span class="language-javascript">slideCode</span></span><br><span class="line"><span class="language-javascript">&#125;,</span></span><br><span class="line"><span class="language-javascript"><span class="attr">methods</span>:&#123;</span></span><br><span class="line"><span class="language-javascript"><span class="attr">slideCode_success</span>: <span class="keyword">function</span>(<span class="params">x</span>) &#123; <span class="comment">//验证通过了</span></span></span><br><span class="line"><span class="language-javascript"><span class="variable language_">this</span>.<span class="property">slideCode_x</span> = x <span class="comment">//偏移值</span></span></span><br><span class="line"><span class="language-javascript">uni.<span class="title function_">showToast</span>(&#123;</span></span><br><span class="line"><span class="language-javascript"><span class="attr">icon</span>:<span class="string">&#x27;success&#x27;</span>,</span></span><br><span class="line"><span class="language-javascript"><span class="attr">title</span>:<span class="string">&#x27;成功&#x27;</span></span></span><br><span class="line"><span class="language-javascript">&#125;)</span></span><br><span class="line"><span class="language-javascript"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="variable language_">this</span>.<span class="property">slideCode_x</span> );<span class="comment">//打印输出验证成功后的滑块x轴</span></span></span><br><span class="line"><span class="language-javascript">&#125;,</span></span><br><span class="line"><span class="language-javascript">&#125;</span></span><br><span class="line"><span class="language-javascript">&#125;</span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">style</span> <span class="attr">lang</span>=<span class="string">&quot;scss&quot;</span> <span class="attr">scoped</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br></pre></td></tr></table></figure><p><code>slideCode.vue</code></p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">template</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">&quot;slideCode&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">&quot;zhuti&quot;</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- 滑动验证码标题 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">view</span> <span class="attr">:class</span>=<span class="string">&quot;[&#x27;msg&#x27;, msgColor]&quot;</span>&gt;</span>&#123;&#123;msg&#125;&#125;<span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">&quot;title&quot;</span>&gt;</span>拖动下方滑块完成拼图<span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- 可拖动区域 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">movable-area</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- 当主图片未加载时显示 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">view</span> <span class="attr">id</span>=<span class="string">&quot;msg&quot;</span> <span class="attr">v-if</span>=<span class="string">&quot;zhutuPic === &#x27;&#x27;&quot;</span>&gt;</span>&#123;&#123;msgText&#125;&#125;<span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- 主图片加载成功 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">view</span> <span class="attr">id</span>=<span class="string">&quot;pic&quot;</span> <span class="attr">v-else</span> <span class="attr">:style</span>=<span class="string">&quot;&#123;&#x27;background-image&#x27;: &#x27;url(&#x27;+zhutuPic+&#x27;)&#x27;&#125;&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- 拖动栏 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">view</span> <span class="attr">id</span>=<span class="string">&quot;line&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- 可拖拽区域  damping用于控制x或y改变时的动画和过界回弹的动画  direction移动方向</span></span><br><span class="line"><span class="comment"> @change拖动过程中触发的事件 @touchend触凭到过程中不断触发事件--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">movable-view</span> <span class="attr">:x</span>=<span class="string">&quot;x&quot;</span> <span class="attr">direction</span>=<span class="string">&quot;horizontal&quot;</span> <span class="attr">:style</span>=<span class="string">&quot;&#123;&#x27;background-image&#x27;: &#x27;url(&#x27;+futuPic+&#x27;)&#x27;&#125;&quot;</span></span></span><br><span class="line"><span class="tag"><span class="attr">:damping</span>=<span class="string">&quot;100&quot;</span> @<span class="attr">change</span>=<span class="string">&quot;onChange&quot;</span> @<span class="attr">touchend</span>=<span class="string">&quot;touchEnd&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">&quot;blue&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">movable-view</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">movable-area</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- 关闭 --&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- &lt;view class=&quot;close iconfont icon-guanbi1&quot; @click=&quot;$emit(&#x27;close&#x27;)&quot;&gt;&lt;/view&gt; --&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript"><span class="keyword">import</span> config <span class="keyword">from</span> <span class="string">&#x27;../../utils/config.js&#x27;</span>;</span></span><br><span class="line"><span class="language-javascript"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span></span><br><span class="line"><span class="language-javascript"><span class="comment">//重父元素中拿到session_id</span></span></span><br><span class="line"><span class="language-javascript"><span class="attr">props</span>: &#123;</span></span><br><span class="line"><span class="language-javascript"><span class="attr">session_id</span>: &#123;</span></span><br><span class="line"><span class="language-javascript"><span class="attr">type</span>: <span class="title class_">Number</span>,</span></span><br><span class="line"><span class="language-javascript"><span class="attr">default</span>: <span class="number">0</span></span></span><br><span class="line"><span class="language-javascript">&#125;,</span></span><br><span class="line"><span class="language-javascript">&#125;,</span></span><br><span class="line"><span class="language-javascript"><span class="title function_">data</span>(<span class="params"></span>) &#123;</span></span><br><span class="line"><span class="language-javascript"><span class="keyword">return</span> &#123;</span></span><br><span class="line"><span class="language-javascript"><span class="attr">zhutuPic</span>: <span class="string">&#x27;&#x27;</span>, <span class="comment">//主图</span></span></span><br><span class="line"><span class="language-javascript"><span class="attr">futuPic</span>: <span class="string">&#x27;&#x27;</span>, <span class="comment">//缺口图</span></span></span><br><span class="line"><span class="language-javascript"><span class="attr">x</span>: <span class="number">10</span>, <span class="comment">//当前的位置</span></span></span><br><span class="line"><span class="language-javascript"><span class="attr">msgColor</span>: <span class="string">&#x27;&#x27;</span>,</span></span><br><span class="line"><span class="language-javascript"><span class="attr">msg</span>: <span class="string">&#x27;安全验证&#x27;</span>,</span></span><br><span class="line"><span class="language-javascript"><span class="attr">msgText</span>: <span class="string">&#x27;加载中&#x27;</span>, <span class="comment">//验证码文字</span></span></span><br><span class="line"><span class="language-javascript"><span class="attr">huadong</span>: <span class="literal">false</span> <span class="comment">//是否已经滑动</span></span></span><br><span class="line"><span class="language-javascript">&#125;</span></span><br><span class="line"><span class="language-javascript">&#125;,</span></span><br><span class="line"><span class="language-javascript"><span class="title function_">mounted</span>(<span class="params"></span>) &#123;</span></span><br><span class="line"><span class="language-javascript"><span class="variable language_">this</span>.<span class="title function_">shuaxin</span>()</span></span><br><span class="line"><span class="language-javascript">&#125;,</span></span><br><span class="line"><span class="language-javascript"><span class="attr">methods</span>: &#123;</span></span><br><span class="line"><span class="language-javascript"><span class="comment">//获取/刷新 主图和滑块图，</span></span></span><br><span class="line"><span class="language-javascript"><span class="title function_">shuaxin</span>(<span class="params"></span>) &#123;</span></span><br><span class="line"><span class="language-javascript">uni.<span class="title function_">request</span>(&#123;</span></span><br><span class="line"><span class="language-javascript"><span class="attr">method</span>: <span class="string">&#x27;get&#x27;</span>,</span></span><br><span class="line"><span class="language-javascript"><span class="attr">dataType</span>: <span class="string">&#x27;json&#x27;</span>,</span></span><br><span class="line"><span class="language-javascript"><span class="attr">timeout</span>: <span class="number">7000</span>,</span></span><br><span class="line"><span class="language-javascript"><span class="attr">url</span>: config.<span class="property">URL</span> + <span class="string">&#x27;User/yzm_pic&#x27;</span>,</span></span><br><span class="line"><span class="language-javascript"><span class="attr">data</span>: &#123;</span></span><br><span class="line"><span class="language-javascript"><span class="attr">type</span>: <span class="string">&#x27;shengcheng&#x27;</span>,</span></span><br><span class="line"><span class="language-javascript"><span class="attr">session_id</span>: <span class="variable language_">this</span>.<span class="property">session_id</span></span></span><br><span class="line"><span class="language-javascript">&#125;,</span></span><br><span class="line"><span class="language-javascript"><span class="attr">success</span>: <span class="function">(<span class="params">res</span>) =&gt;</span> &#123;</span></span><br><span class="line"><span class="language-javascript"><span class="keyword">if</span> (res.<span class="property">data</span>.<span class="property">status</span> == <span class="number">200</span>) &#123; <span class="comment">//生成验证码成功</span></span></span><br><span class="line"><span class="language-javascript"><span class="comment">//time参数作用是让刷新后图片会重新获取</span></span></span><br><span class="line"><span class="language-javascript"><span class="variable language_">this</span>.<span class="property">zhutuPic</span> = config.<span class="property">imgUpload</span> +</span></span><br><span class="line"><span class="language-javascript"><span class="string">&#x27;index.php/api/User/yzm_pic?type=zhutu&amp;session_id=&#x27;</span> + <span class="variable language_">this</span>.<span class="property">session_id</span> +</span></span><br><span class="line"><span class="language-javascript"><span class="string">&#x27;&amp;time=&#x27;</span> + (<span class="keyword">new</span> <span class="title class_">Date</span>() * <span class="number">1</span>)</span></span><br><span class="line"><span class="language-javascript"><span class="variable language_">this</span>.<span class="property">futuPic</span> = config.<span class="property">imgUpload</span> +</span></span><br><span class="line"><span class="language-javascript"><span class="string">&#x27;index.php/api/User/yzm_pic?type=futu&amp;session_id=&#x27;</span> + <span class="variable language_">this</span>.<span class="property">session_id</span> +</span></span><br><span class="line"><span class="language-javascript"><span class="string">&#x27;&amp;time=&#x27;</span> + (<span class="keyword">new</span> <span class="title class_">Date</span>() * <span class="number">1</span>)</span></span><br><span class="line"><span class="language-javascript">&#125;</span></span><br><span class="line"><span class="language-javascript">&#125;,</span></span><br><span class="line"><span class="language-javascript"><span class="attr">complete</span>: <span class="function">(<span class="params">res</span>) =&gt;</span> &#123;</span></span><br><span class="line"><span class="language-javascript"><span class="comment">//错误的提示</span></span></span><br><span class="line"><span class="language-javascript"><span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> &#123;</span></span><br><span class="line"><span class="language-javascript"><span class="keyword">if</span> (res.<span class="property">data</span>.<span class="property">status</span> != <span class="number">200</span>) &#123;</span></span><br><span class="line"><span class="language-javascript"><span class="variable language_">this</span>.<span class="property">msgText</span> = res.<span class="property">message</span>;</span></span><br><span class="line"><span class="language-javascript">&#125;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">&#125;, <span class="number">300</span>);</span></span><br><span class="line"><span class="language-javascript">&#125;</span></span><br><span class="line"><span class="language-javascript">&#125;);</span></span><br><span class="line"><span class="language-javascript">&#125;,</span></span><br><span class="line"><span class="language-javascript"><span class="comment">// @change拖动过程中触发的事件</span></span></span><br><span class="line"><span class="language-javascript"><span class="title function_">onChange</span>(<span class="params">e</span>) &#123;</span></span><br><span class="line"><span class="language-javascript"><span class="keyword">if</span> (e.<span class="property">detail</span>.<span class="property">source</span> === <span class="string">&#x27;touch&#x27;</span>) &#123; <span class="comment">//滑块位置放置正确时 只有是手动触发的，才执行，</span></span></span><br><span class="line"><span class="language-javascript"><span class="variable language_">this</span>.<span class="property">huadong</span> = <span class="literal">true</span> <span class="comment">//判断滑块是否正确</span></span></span><br><span class="line"><span class="language-javascript"><span class="variable language_">this</span>.<span class="property">x</span> = e.<span class="property">detail</span>.<span class="property">x</span> <span class="comment">//滑块x轴</span></span></span><br><span class="line"><span class="language-javascript">&#125;</span></span><br><span class="line"><span class="language-javascript">&#125;,</span></span><br><span class="line"><span class="language-javascript"><span class="comment">// @touchend触屏到过程中不断触发事件</span></span></span><br><span class="line"><span class="language-javascript"><span class="title function_">touchEnd</span>(<span class="params"></span>) &#123;</span></span><br><span class="line"><span class="language-javascript"><span class="keyword">if</span> (<span class="variable language_">this</span>.<span class="property">huadong</span> === <span class="literal">true</span>) &#123; <span class="comment">//只有拖动过后松开，才会触发，当然这个主要是应对pc端的（pc端是监听body的松开），移动端没这问题</span></span></span><br><span class="line"><span class="language-javascript"><span class="variable language_">this</span>.<span class="property">msg</span> = <span class="string">&#x27;验证中...&#x27;</span></span></span><br><span class="line"><span class="language-javascript"><span class="variable language_">this</span>.<span class="property">msgColor</span> = <span class="string">&#x27;&#x27;</span></span></span><br><span class="line"><span class="language-javascript">uni.<span class="title function_">request</span>(&#123;</span></span><br><span class="line"><span class="language-javascript"><span class="attr">method</span>: <span class="string">&#x27;get&#x27;</span>,</span></span><br><span class="line"><span class="language-javascript"><span class="attr">dataType</span>: <span class="string">&#x27;json&#x27;</span>,</span></span><br><span class="line"><span class="language-javascript"><span class="attr">timeout</span>: <span class="number">7000</span>,</span></span><br><span class="line"><span class="language-javascript"><span class="attr">url</span>: config.<span class="property">URL</span> + <span class="string">&#x27;User/yzm_pic&#x27;</span>,</span></span><br><span class="line"><span class="language-javascript"><span class="attr">data</span>: &#123;</span></span><br><span class="line"><span class="language-javascript"><span class="attr">type</span>: <span class="string">&#x27;yanzheng&#x27;</span>,</span></span><br><span class="line"><span class="language-javascript"><span class="attr">session_id</span>: <span class="variable language_">this</span>.<span class="property">session_id</span>,</span></span><br><span class="line"><span class="language-javascript"><span class="attr">x</span>: <span class="built_in">parseInt</span>(<span class="variable language_">this</span>.<span class="property">x</span> * (<span class="number">679</span> / uni.<span class="title function_">upx2px</span>(<span class="number">550</span>)) -</span></span><br><span class="line"><span class="language-javascript"><span class="number">35</span>) <span class="comment">//因为x是相对于movable-area容器宽度的，所以需要算出图片实际宽度相 对于 容器宽度的比例</span></span></span><br><span class="line"><span class="language-javascript">&#125;,</span></span><br><span class="line"><span class="language-javascript"><span class="attr">success</span>: <span class="function">(<span class="params">res</span>) =&gt;</span> &#123;</span></span><br><span class="line"><span class="language-javascript"><span class="keyword">if</span> (res.<span class="property">data</span>.<span class="property">status</span> == <span class="number">200</span>) &#123;</span></span><br><span class="line"><span class="language-javascript"><span class="comment">//成功后返回给父组件</span></span></span><br><span class="line"><span class="language-javascript"><span class="variable language_">this</span>.$emit(<span class="string">&#x27;success&#x27;</span>, &#123;</span></span><br><span class="line"><span class="language-javascript"><span class="attr">x</span>: <span class="built_in">parseInt</span>(<span class="variable language_">this</span>.<span class="property">x</span> * (<span class="number">679</span> / uni.<span class="title function_">upx2px</span>(<span class="number">550</span>)) - <span class="number">35</span>)</span></span><br><span class="line"><span class="language-javascript">&#125;)</span></span><br><span class="line"><span class="language-javascript"><span class="variable language_">this</span>.<span class="property">msg</span> = <span class="string">&#x27;验证成功&#x27;</span></span></span><br><span class="line"><span class="language-javascript"><span class="variable language_">this</span>.<span class="property">msgColor</span> = <span class="string">&#x27;green&#x27;</span></span></span><br><span class="line"><span class="language-javascript"><span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> &#123;</span></span><br><span class="line"><span class="language-javascript"><span class="variable language_">this</span>.$emit(<span class="string">&#x27;close&#x27;</span>)</span></span><br><span class="line"><span class="language-javascript">&#125;, <span class="number">300</span>);</span></span><br><span class="line"><span class="language-javascript">&#125;</span></span><br><span class="line"><span class="language-javascript">&#125;,</span></span><br><span class="line"><span class="language-javascript"><span class="attr">complete</span>: <span class="function">(<span class="params">res</span>) =&gt;</span> &#123;</span></span><br><span class="line"><span class="language-javascript"><span class="variable language_">this</span>.<span class="property">huadong</span> = <span class="literal">false</span>; <span class="comment">//没有在拖动中了</span></span></span><br><span class="line"><span class="language-javascript"><span class="keyword">if</span> (res.<span class="property">data</span>.<span class="property">status</span> != <span class="number">200</span>) &#123;</span></span><br><span class="line"><span class="language-javascript"><span class="variable language_">this</span>.<span class="title function_">doudong</span>() <span class="comment">//抖动</span></span></span><br><span class="line"><span class="language-javascript"><span class="variable language_">this</span>.<span class="property">msg</span> = res.<span class="property">data</span>.<span class="property">message</span></span></span><br><span class="line"><span class="language-javascript"><span class="variable language_">this</span>.<span class="property">msgColor</span> = <span class="string">&#x27;red&#x27;</span></span></span><br><span class="line"><span class="language-javascript"><span class="keyword">if</span> (res.<span class="property">data</span>.<span class="property">message</span> == <span class="string">&#x27;验证码错误次数过多，请重新获取&#x27;</span>) &#123;</span></span><br><span class="line"><span class="language-javascript"><span class="variable language_">this</span>.<span class="property">msg</span> = <span class="string">&#x27;验证失败次数过多，已重新获取&#x27;</span></span></span><br><span class="line"><span class="language-javascript"><span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> &#123;</span></span><br><span class="line"><span class="language-javascript"><span class="variable language_">this</span>.<span class="title function_">shuaxin</span>()</span></span><br><span class="line"><span class="language-javascript">&#125;, <span class="number">500</span>);</span></span><br><span class="line"><span class="language-javascript">&#125;</span></span><br><span class="line"><span class="language-javascript"><span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> &#123;</span></span><br><span class="line"><span class="language-javascript"><span class="variable language_">this</span>.<span class="property">msg</span> = <span class="string">&#x27;安全验证&#x27;</span></span></span><br><span class="line"><span class="language-javascript"><span class="variable language_">this</span>.<span class="property">msgColor</span> = <span class="string">&#x27;&#x27;</span></span></span><br><span class="line"><span class="language-javascript">&#125;, <span class="number">3500</span>);</span></span><br><span class="line"><span class="language-javascript">&#125;</span></span><br><span class="line"><span class="language-javascript">&#125;</span></span><br><span class="line"><span class="language-javascript">&#125;);</span></span><br><span class="line"><span class="language-javascript">&#125;</span></span><br><span class="line"><span class="language-javascript">&#125;,</span></span><br><span class="line"><span class="language-javascript"><span class="title function_">doudong</span>(<span class="params"></span>) &#123; <span class="comment">//抖动 【总耗时 500ms】</span></span></span><br><span class="line"><span class="language-javascript"><span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> &#123;</span></span><br><span class="line"><span class="language-javascript"><span class="keyword">if</span> (<span class="variable language_">this</span>.<span class="property">huadong</span>) &#123; <span class="comment">//判断，如果滑块放置正确，则不再执行。否则进行抖动</span></span></span><br><span class="line"><span class="language-javascript"><span class="keyword">return</span></span></span><br><span class="line"><span class="language-javascript">&#125; <span class="comment">//如果在拖动中，就不执行了</span></span></span><br><span class="line"><span class="language-javascript"><span class="variable language_">this</span>.<span class="property">x</span> -= <span class="number">15</span>;</span></span><br><span class="line"><span class="language-javascript"><span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> &#123;</span></span><br><span class="line"><span class="language-javascript"><span class="keyword">if</span> (<span class="variable language_">this</span>.<span class="property">huadong</span>) &#123;</span></span><br><span class="line"><span class="language-javascript"><span class="keyword">return</span></span></span><br><span class="line"><span class="language-javascript">&#125;</span></span><br><span class="line"><span class="language-javascript"><span class="variable language_">this</span>.<span class="property">x</span> += <span class="number">30</span></span></span><br><span class="line"><span class="language-javascript"><span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> &#123;</span></span><br><span class="line"><span class="language-javascript"><span class="keyword">if</span> (<span class="variable language_">this</span>.<span class="property">huadong</span>) &#123;</span></span><br><span class="line"><span class="language-javascript"><span class="keyword">return</span></span></span><br><span class="line"><span class="language-javascript">&#125;</span></span><br><span class="line"><span class="language-javascript"><span class="variable language_">this</span>.<span class="property">x</span> -= <span class="number">30</span></span></span><br><span class="line"><span class="language-javascript"><span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> &#123;</span></span><br><span class="line"><span class="language-javascript"><span class="keyword">if</span> (<span class="variable language_">this</span>.<span class="property">huadong</span>) &#123;</span></span><br><span class="line"><span class="language-javascript"><span class="keyword">return</span></span></span><br><span class="line"><span class="language-javascript">&#125;</span></span><br><span class="line"><span class="language-javascript"><span class="variable language_">this</span>.<span class="property">x</span> += <span class="number">30</span></span></span><br><span class="line"><span class="language-javascript"><span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> &#123;</span></span><br><span class="line"><span class="language-javascript"><span class="keyword">if</span> (<span class="variable language_">this</span>.<span class="property">huadong</span>) &#123;</span></span><br><span class="line"><span class="language-javascript"><span class="keyword">return</span></span></span><br><span class="line"><span class="language-javascript">&#125;</span></span><br><span class="line"><span class="language-javascript"><span class="variable language_">this</span>.<span class="property">x</span> = <span class="number">10</span></span></span><br><span class="line"><span class="language-javascript">&#125;, <span class="number">100</span>);</span></span><br><span class="line"><span class="language-javascript">&#125;, <span class="number">100</span>);</span></span><br><span class="line"><span class="language-javascript">&#125;, <span class="number">100</span>);</span></span><br><span class="line"><span class="language-javascript">&#125;, <span class="number">100</span>);</span></span><br><span class="line"><span class="language-javascript">&#125;, <span class="number">100</span>);</span></span><br><span class="line"><span class="language-javascript">&#125;,</span></span><br><span class="line"><span class="language-javascript">&#125;</span></span><br><span class="line"><span class="language-javascript">&#125;</span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">style</span> <span class="attr">lang</span>=<span class="string">&quot;scss&quot;</span> <span class="attr">scoped</span>&gt;</span><span class="language-css"></span></span><br><span class="line"><span class="language-css"><span class="keyword">@font-face</span> &#123;</span></span><br><span class="line"><span class="language-css"><span class="attribute">font-family</span>: <span class="string">&quot;iconfont&quot;</span>;</span></span><br><span class="line"><span class="language-css"><span class="comment">/* Project id 2455983 */</span></span></span><br><span class="line"><span class="language-css"><span class="attribute">src</span>:</span></span><br><span class="line"><span class="language-css"><span class="built_in">url</span>(<span class="string">&#x27;data:application/x-font-woff2;charset=utf-8;base64,d09GMgABAAAAAALEAAsAAAAABngAAAJ5AAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHFQGYACCcApweQE2AiQDCAsGAAQgBYRnBzEbtgUR1ZMhZH8r7lgI/uPREFlgoVBNm5PkuTjzBokvYm9bLZ7Q8ql1k55Aj4zHA0PJeeB/P9x9MjPtolU0rW5JQ58nSAudRqXRCFGs4ZnI+eCEm0caBUARHIiSJ0Je/uBN7D5M8JMncnEcb597Vhpwgr8zfqrALG7aKReheBK7c9X1PWkpfRCyJ+xa5EeKSpKryiT9ZEEApKX5fpaTvxt1KX8DeuAFkS/0PYVK65ROBxbA6AOlV0sohJmgx6MguyNQSw7DMwIqzVsWN3eXu6g9l5xFp8wZDuT14dw7KcrliCzTfLmgFN2bhZdKiE/xxIv48+FvAqKSxGnaPdsa8bZnd0ECRaUvXa6DPhZRgoRpZMJhf2ZbEtr4pNKTDdLWLPBD8aFbOLRD+Ouc2mrQTcVnknz5UWsjyOloL0YmjSXW1/YPW4yJ8wNQ0CBGoTk8cxF1ZFyBX8NkS3/87kgP5pT/K75uD9c2/dWjVVAsXYoFBF57v7LKf5TB1zsOFctgPsp36An8HfUEJGYzRszXKBEQVWlSKqLSjVPgBBp9m2o03UUhKNd0L74yXTmScoNU5iZRosoiSpVbQqUpW4erNLmWhFyBUTcEQb1XiGq9QVLvHZW59yjR6idK1fuPSsfBOK/KaBD0mlAyGlA/8Lpk6+kc272ie0VJTckn0uJpHNqqqeb3mJHm2LC8XcdswVJJsBMfwxgLTFRG1FwNzFNf17btLZUuSawJJaMB9QOvS7Yhmcvfd0X3ipJA6pmhxVP70FYNQO2VDPU8yCvL23XMFiyVBDt5FsZYYGqfNaLmapiQmvraJVlUqbbX0t8TBnDMuHKnJpJ7yax8KwQA&#x27;</span>) <span class="built_in">format</span>(<span class="string">&#x27;woff2&#x27;</span>);</span></span><br><span class="line"><span class="language-css">&#125;</span></span><br><span class="line"><span class="language-css"></span></span><br><span class="line"><span class="language-css"><span class="selector-class">.iconfont</span> &#123;</span></span><br><span class="line"><span class="language-css"><span class="attribute">font-family</span>: <span class="string">&quot;iconfont&quot;</span> <span class="meta">!important</span>;</span></span><br><span class="line"><span class="language-css"><span class="attribute">font-size</span>: <span class="number">16px</span>;</span></span><br><span class="line"><span class="language-css"><span class="attribute">font-style</span>: normal;</span></span><br><span class="line"><span class="language-css">-webkit-<span class="attribute">font-smoothing</span>: antialiased;</span></span><br><span class="line"><span class="language-css">-moz-osx-<span class="attribute">font-smoothing</span>: grayscale;</span></span><br><span class="line"><span class="language-css">&#125;</span></span><br><span class="line"><span class="language-css"></span></span><br><span class="line"><span class="language-css"><span class="selector-class">.icon-guanbi1</span><span class="selector-pseudo">:before</span> &#123;</span></span><br><span class="line"><span class="language-css"><span class="attribute">content</span>: <span class="string">&quot;\e696&quot;</span>;</span></span><br><span class="line"><span class="language-css">&#125;</span></span><br><span class="line"><span class="language-css"></span></span><br><span class="line"><span class="language-css"><span class="selector-class">.slideCode</span> &#123;</span></span><br><span class="line"><span class="language-css"><span class="attribute">background</span>: <span class="built_in">rgba</span>(<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0.3</span>);</span></span><br><span class="line"><span class="language-css"><span class="attribute">width</span>: <span class="number">750</span>rpx;</span></span><br><span class="line"><span class="language-css"><span class="attribute">height</span>: <span class="number">100vh</span>;</span></span><br><span class="line"><span class="language-css"><span class="attribute">position</span>: fixed;</span></span><br><span class="line"><span class="language-css"><span class="attribute">top</span>: <span class="number">0</span>;</span></span><br><span class="line"><span class="language-css"><span class="attribute">left</span>: <span class="number">0</span>;</span></span><br><span class="line"><span class="language-css"><span class="attribute">z-index</span>: <span class="number">999999</span>;</span></span><br><span class="line"><span class="language-css"></span></span><br><span class="line"><span class="language-css"><span class="selector-class">.zhuti</span> &#123;</span></span><br><span class="line"><span class="language-css"><span class="attribute">width</span>: <span class="number">600</span>rpx;</span></span><br><span class="line"><span class="language-css"><span class="attribute">background</span>: <span class="number">#FFF</span>;</span></span><br><span class="line"><span class="language-css"><span class="attribute">position</span>: absolute;</span></span><br><span class="line"><span class="language-css"><span class="attribute">top</span>: <span class="number">50%</span>;</span></span><br><span class="line"><span class="language-css"><span class="attribute">left</span>: <span class="number">50%</span>;</span></span><br><span class="line"><span class="language-css"><span class="attribute">transform</span>: <span class="built_in">translate</span>(-<span class="number">50%</span>, -<span class="number">50%</span>);</span></span><br><span class="line"><span class="language-css"><span class="attribute">padding</span>: <span class="number">20</span>rpx <span class="number">25</span>rpx <span class="number">30</span>rpx <span class="number">25</span>rpx;</span></span><br><span class="line"><span class="language-css"></span></span><br><span class="line"><span class="language-css">//标题提示</span></span><br><span class="line"><span class="language-css"><span class="selector-class">.msg</span> &#123;</span></span><br><span class="line"><span class="language-css"><span class="attribute">color</span>: <span class="number">#999</span>;</span></span><br><span class="line"><span class="language-css"><span class="attribute">font-size</span>: <span class="number">24</span>rpx;</span></span><br><span class="line"><span class="language-css"></span></span><br><span class="line"><span class="language-css">&amp;<span class="selector-class">.red</span> &#123;</span></span><br><span class="line"><span class="language-css"><span class="attribute">color</span>: red;</span></span><br><span class="line"><span class="language-css">&#125;</span></span><br><span class="line"><span class="language-css"></span></span><br><span class="line"><span class="language-css">&amp;<span class="selector-class">.green</span> &#123;</span></span><br><span class="line"><span class="language-css"><span class="attribute">color</span>: green;</span></span><br><span class="line"><span class="language-css">&#125;</span></span><br><span class="line"><span class="language-css">&#125;</span></span><br><span class="line"><span class="language-css"></span></span><br><span class="line"><span class="language-css">//标题</span></span><br><span class="line"><span class="language-css"><span class="selector-class">.title</span> &#123;</span></span><br><span class="line"><span class="language-css"><span class="attribute">font-size</span>: <span class="number">28</span>rpx;</span></span><br><span class="line"><span class="language-css"><span class="attribute">line-height</span>: <span class="number">38</span>rpx;</span></span><br><span class="line"><span class="language-css"><span class="attribute">color</span>: <span class="number">#333</span>;</span></span><br><span class="line"><span class="language-css"><span class="attribute">margin</span>: <span class="number">0</span> <span class="number">0</span> <span class="number">7</span>rpx <span class="number">0</span>;</span></span><br><span class="line"><span class="language-css">&#125;</span></span><br><span class="line"><span class="language-css"></span></span><br><span class="line"><span class="language-css"><span class="selector-class">.close</span> &#123;</span></span><br><span class="line"><span class="language-css"><span class="attribute">position</span>: absolute;</span></span><br><span class="line"><span class="language-css"><span class="attribute">top</span>: <span class="number">20</span>rpx;</span></span><br><span class="line"><span class="language-css"><span class="attribute">right</span>: <span class="number">20</span>rpx;</span></span><br><span class="line"><span class="language-css"><span class="attribute">color</span>: <span class="number">#A6A6A6</span>;</span></span><br><span class="line"><span class="language-css"><span class="attribute">font-size</span>: <span class="number">36</span>rpx;</span></span><br><span class="line"><span class="language-css"><span class="attribute">padding</span>: <span class="number">10</span>rpx;</span></span><br><span class="line"><span class="language-css">&#125;</span></span><br><span class="line"><span class="language-css"></span></span><br><span class="line"><span class="language-css">movable-area &#123;</span></span><br><span class="line"><span class="language-css"><span class="attribute">width</span>: <span class="number">100%</span>;</span></span><br><span class="line"><span class="language-css"><span class="attribute">height</span>: auto;</span></span><br><span class="line"><span class="language-css"></span></span><br><span class="line"><span class="language-css">//主图片未加载</span></span><br><span class="line"><span class="language-css"><span class="selector-id">#msg</span> &#123;</span></span><br><span class="line"><span class="language-css"><span class="attribute">width</span>: <span class="number">100%</span>;</span></span><br><span class="line"><span class="language-css"><span class="attribute">line-height</span>: <span class="number">310</span>rpx;</span></span><br><span class="line"><span class="language-css"><span class="attribute">text-align</span>: center;</span></span><br><span class="line"><span class="language-css"><span class="attribute">font-size</span>: <span class="number">30</span>rpx;</span></span><br><span class="line"><span class="language-css"><span class="attribute">color</span>: <span class="number">#999</span>;</span></span><br><span class="line"><span class="language-css"><span class="attribute">background</span>: <span class="number">#F8F8F8</span>;</span></span><br><span class="line"><span class="language-css">&#125;</span></span><br><span class="line"><span class="language-css"></span></span><br><span class="line"><span class="language-css">//主图片</span></span><br><span class="line"><span class="language-css"><span class="selector-id">#pic</span> &#123;</span></span><br><span class="line"><span class="language-css"><span class="attribute">width</span>: <span class="number">100%</span>;</span></span><br><span class="line"><span class="language-css"><span class="attribute">height</span>: <span class="number">310</span>rpx;</span></span><br><span class="line"><span class="language-css"><span class="attribute">background-color</span>: <span class="number">#F8F8F8</span>;</span></span><br><span class="line"><span class="language-css"><span class="attribute">background-size</span>: <span class="number">100%</span> <span class="number">310</span>rpx;</span></span><br><span class="line"><span class="language-css">&#125;</span></span><br><span class="line"><span class="language-css"></span></span><br><span class="line"><span class="language-css">//滑动栏</span></span><br><span class="line"><span class="language-css"><span class="selector-id">#line</span> &#123;</span></span><br><span class="line"><span class="language-css"><span class="attribute">background</span>: <span class="number">#e4e4e4</span>;</span></span><br><span class="line"><span class="language-css"><span class="attribute">width</span>: <span class="number">100%</span>;</span></span><br><span class="line"><span class="language-css"><span class="attribute">height</span>: <span class="number">20</span>rpx;</span></span><br><span class="line"><span class="language-css"><span class="attribute">margin</span>: <span class="number">42</span>rpx <span class="number">0</span> <span class="number">15</span>rpx <span class="number">0</span>;</span></span><br><span class="line"><span class="language-css"><span class="attribute">border-radius</span>: <span class="number">50</span>rpx;</span></span><br><span class="line"><span class="language-css"><span class="attribute">display</span>: inline-block;</span></span><br><span class="line"><span class="language-css">&#125;</span></span><br><span class="line"><span class="language-css"></span></span><br><span class="line"><span class="language-css">movable-view &#123;</span></span><br><span class="line"><span class="language-css"><span class="attribute">width</span>: <span class="number">78</span>rpx;</span></span><br><span class="line"><span class="language-css"><span class="attribute">height</span>: <span class="number">310</span>rpx;</span></span><br><span class="line"><span class="language-css"><span class="attribute">background-size</span>: <span class="number">100%</span> <span class="number">310</span>rpx;</span></span><br><span class="line"><span class="language-css"><span class="attribute">background-repeat</span>: no-repeat;</span></span><br><span class="line"><span class="language-css"></span></span><br><span class="line"><span class="language-css"><span class="selector-class">.blue</span> &#123;</span></span><br><span class="line"><span class="language-css"><span class="attribute">box-shadow</span>: <span class="built_in">rgba</span>(<span class="number">26</span>, <span class="number">101</span>, <span class="number">255</span>, <span class="number">0.52</span>) <span class="number">0px</span> <span class="number">0px</span> <span class="number">10px</span> <span class="number">1px</span>;</span></span><br><span class="line"><span class="language-css"><span class="attribute">width</span>: <span class="number">100</span>rpx;</span></span><br><span class="line"><span class="language-css"><span class="attribute">height</span>: <span class="number">50</span>rpx;</span></span><br><span class="line"><span class="language-css"><span class="attribute">border-radius</span>: <span class="number">50</span>rpx;</span></span><br><span class="line"><span class="language-css"><span class="attribute">position</span>: absolute;</span></span><br><span class="line"><span class="language-css"><span class="attribute">top</span>: <span class="number">100%</span>;</span></span><br><span class="line"><span class="language-css"><span class="attribute">left</span>: <span class="number">0</span>;</span></span><br><span class="line"><span class="language-css"><span class="attribute">background</span>: <span class="built_in">rgb</span>(<span class="number">26</span>, <span class="number">101</span>, <span class="number">255</span>) <span class="built_in">url</span>(<span class="string">data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACgAAAAcAgMAAABuexVFAAAACVBMVEUAAADCwsL9/f1P0DqbAAAAAXRSTlMAQObYZgAAAB1JREFUGNNjCGVgYGANABKhyMwoEHMBkIgaZWIwAdyJJQnaJRg5AAAAAElFTkSuQmCC</span>) no-repeat;</span></span><br><span class="line"><span class="language-css"><span class="attribute">background-size</span>: auto <span class="number">20</span>rpx;</span></span><br><span class="line"><span class="language-css"><span class="attribute">background-position</span>: <span class="number">50%</span> <span class="number">50%</span>;</span></span><br><span class="line"><span class="language-css"><span class="attribute">margin</span>: <span class="number">25</span>rpx <span class="number">0</span> <span class="number">0</span> -<span class="number">14</span>rpx;</span></span><br><span class="line"><span class="language-css">&#125;</span></span><br><span class="line"><span class="language-css">&#125;</span></span><br><span class="line"><span class="language-css">&#125;</span></span><br><span class="line"><span class="language-css">&#125;</span></span><br><span class="line"><span class="language-css">&#125;</span></span><br><span class="line"><span class="language-css"></span><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> Uni-App </category>
          
      </categories>
      
      
        <tags>
            
            <tag> js </tag>
            
            <tag> Uni-App </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Koa2搭建通用API服务</title>
      <link href="/article/f77faeb2.html"/>
      <url>/article/f77faeb2.html</url>
      
        <content type="html"><![CDATA[<h2 id="零、项目结构"><a href="#零、项目结构" class="headerlink" title="零、项目结构"></a>零、项目结构</h2><p><code>main.js</code>是项目的入口文件，导入了<code>config/config.default.js</code>文件和<code>app/index.js</code>文件。</p><p><code>config/config.default.js</code>文件是读取你的<code>.env</code>文件，将配置写到<code>process.env</code>中</p><p><code>.env</code> 全局默认配置文件</p><p><code>app/index.js</code>是项目的app服务，导入了koa框架，koa-body并使用，<code>app/errHandler</code> 错误处理中间件和<code>router/user.router</code>路由模块</p><p><code>router/user.router</code>是项目的路由文件，导入使用了koa-router，<code>middleware/user.middleware</code>和<code>controller/user.controller</code></p><p><code>controller/user.controller</code>是项目的控制器，用于接口的编写，导入了一个<code>service/user.service</code>和<code>consitant/err.type</code></p><p><code>service/user.service</code>主要是做数据库处理,导入了<code>model/user.model</code>，调用model完成数据库操作</p><p><code>model/user.model</code> 编写数据表，导入了<code>db/seq</code>连接数据库，用于<code>service/user.service</code>数据库处理</p><p><code>db/seq</code>连接数据库，导入了<code>.env</code> 全局默认配置文件</p><p><code>middleware/user.middleware</code>为中间件文件，用于处理服务请求的细节，导入了<code>service/user.service</code>和<code>constant/err.type</code></p><p><code>constant/err.type</code>为统一错误定义的文件，定义一些请求中的错误原因</p><p><code>app/errHandler</code>为错误处理函数，需要在app服务中<code>on()</code>绑定错误</p><h2 id="一、项目初始化"><a href="#一、项目初始化" class="headerlink" title="一、项目初始化"></a>一、项目初始化</h2><h3 id="1-npm初始化"><a href="#1-npm初始化" class="headerlink" title="1.npm初始化"></a>1.npm初始化</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm init -y</span><br></pre></td></tr></table></figure><p>生成<code>package.json</code>文件</p><ul><li>记录项目的依赖</li></ul><h3 id="2-git初始化"><a href="#2-git初始化" class="headerlink" title="2.git初始化"></a>2.git初始化</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git init</span><br></pre></td></tr></table></figure><p>生成<code>.git</code>隐藏文件夹, git 的本地仓库</p><h2 id="二、搭建项目"><a href="#二、搭建项目" class="headerlink" title="二、搭建项目"></a>二、搭建项目</h2><h3 id="1-安装Koa框架"><a href="#1-安装Koa框架" class="headerlink" title="1.安装Koa框架"></a>1.安装Koa框架</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm i koa</span><br></pre></td></tr></table></figure><h3 id="2-编写最基本的app"><a href="#2-编写最基本的app" class="headerlink" title="2.编写最基本的app"></a>2.编写最基本的app</h3><p>新建一个<code>/src/main.js</code>文件</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> <span class="title class_">Koa</span> = <span class="built_in">require</span>(<span class="string">&#x27;koa&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> app = <span class="keyword">new</span> <span class="title class_">Koa</span>()</span><br><span class="line"></span><br><span class="line">app.<span class="title function_">use</span>(<span class="function">(<span class="params">ctx,next</span>)=&gt;</span>&#123;</span><br><span class="line">    ctx.<span class="property">body</span> = <span class="string">&quot;hello api&quot;</span></span><br><span class="line">&#125;)</span><br><span class="line">app.<span class="title function_">listen</span>(<span class="number">3000</span>,<span class="function">()=&gt;</span>&#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;server is running on http://localhost:3000&quot;</span>);</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><h3 id="3-测试"><a href="#3-测试" class="headerlink" title="3.测试"></a>3.测试</h3><p>在终端，使用命令</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">node src/main.js</span><br></pre></td></tr></table></figure><p>或者有安装 <code>nodemon</code></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nodemon src/main.js</span><br></pre></td></tr></table></figure><p>浏览器显示 <code>hello api</code></p><h2 id="三、项目的基本优化"><a href="#三、项目的基本优化" class="headerlink" title="三、项目的基本优化"></a>三、项目的基本优化</h2><h3 id="1-自动重启服务"><a href="#1-自动重启服务" class="headerlink" title="1.自动重启服务"></a>1.自动重启服务</h3><p>全局安装<code>nodemon</code>工具</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm i nodemon -g</span><br></pre></td></tr></table></figure><p>编写<code>package.json</code>脚本</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">&quot;scripts&quot;</span>: &#123;</span><br><span class="line">    <span class="string">&quot;dev&quot;</span>: <span class="string">&quot;nodemon ./src/main.js&quot;</span>,</span><br><span class="line">    <span class="string">&quot;test&quot;</span>: <span class="string">&quot;echo \&quot;Error: no test specified\&quot; &amp;&amp; exit 1&quot;</span></span><br><span class="line">  &#125;,</span><br></pre></td></tr></table></figure><p>执行<code>npm run dev</code>启动服务</p><h3 id="2-读取配置文件"><a href="#2-读取配置文件" class="headerlink" title="2.读取配置文件"></a>2.读取配置文件</h3><p>安装<code>dotenv</code>, 读取根目录中的<code>.env</code>文件, 将配置写到<code>process.env</code>中</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm i dotenv</span><br></pre></td></tr></table></figure><p>在项目根目录中创建<code>.env</code>文件</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">APP_PORT=8000</span><br></pre></td></tr></table></figure><p>创建<code>src/config/config.default.js</code></p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> dotenv = <span class="built_in">require</span>(<span class="string">&#x27;dotenv&#x27;</span>)</span><br><span class="line"></span><br><span class="line">dotenv.<span class="title function_">config</span>()</span><br><span class="line"><span class="comment">// console.log(process.env.APP_PORT );</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//process 模块是 nodejs 提供给开发者用来和当前进程交互的工具</span></span><br><span class="line"><span class="variable language_">module</span>.<span class="property">exports</span> = process.<span class="property">env</span></span><br></pre></td></tr></table></figure><p>修改<code>main.js</code></p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> <span class="title class_">Koa</span> = <span class="built_in">require</span>(<span class="string">&#x27;koa&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> &#123;<span class="variable constant_">APP_PORT</span>&#125; = <span class="built_in">require</span>(<span class="string">&#x27;./config/config.default&#x27;</span>)</span><br><span class="line"><span class="keyword">const</span> app = <span class="keyword">new</span> <span class="title class_">Koa</span>()</span><br><span class="line"></span><br><span class="line">app.<span class="title function_">use</span>(<span class="function">(<span class="params">ctx,next</span>)=&gt;</span>&#123;</span><br><span class="line">    ctx.<span class="property">body</span> = <span class="string">&quot;hello api&quot;</span></span><br><span class="line"></span><br><span class="line">&#125;)</span><br><span class="line">app.<span class="title function_">listen</span>(<span class="variable constant_">APP_PORT</span>,<span class="function">()=&gt;</span>&#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">`server is running on http://localhost:<span class="subst">$&#123;APP_PORT&#125;</span>`</span>);</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><h2 id="四、添加路由"><a href="#四、添加路由" class="headerlink" title="四、添加路由"></a>四、添加路由</h2><p>路由: 根据不同的 URL, 调用对应处理函数</p><h3 id="1-安装koa-router"><a href="#1-安装koa-router" class="headerlink" title="1.安装koa-router"></a>1.安装koa-router</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm i koa-router</span><br></pre></td></tr></table></figure><p>步骤:</p><ol><li>导入包</li><li>实例化对象</li><li>编写路由</li><li>注册中间件</li></ol><h3 id="2-编写路由"><a href="#2-编写路由" class="headerlink" title="2.编写路由"></a>2.编写路由</h3><p>创建<code>src/router</code>目录, 编写<code>user.router.js</code></p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//导入路由</span></span><br><span class="line"><span class="keyword">const</span> <span class="title class_">Router</span> = <span class="built_in">require</span>(<span class="string">&#x27;koa-router&#x27;</span>)</span><br><span class="line"><span class="comment">//实例化</span></span><br><span class="line"><span class="keyword">const</span> router = <span class="keyword">new</span> <span class="title class_">Router</span>(&#123; <span class="attr">prefix</span>: <span class="string">&#x27;/users&#x27;</span>&#125;)</span><br><span class="line"><span class="comment">//编写路由接口</span></span><br><span class="line">router.<span class="title function_">get</span>(<span class="string">&#x27;/&#x27;</span>,<span class="function">(<span class="params">ctx,next</span>)=&gt;</span>&#123;</span><br><span class="line">    ctx.<span class="property">body</span> = <span class="string">&#x27;hello users&#x27;</span></span><br><span class="line">&#125;)</span><br><span class="line"><span class="comment">//暴露路由对象</span></span><br><span class="line"><span class="variable language_">module</span>.<span class="property">exports</span> = router</span><br></pre></td></tr></table></figure><h3 id="3-修改main-js"><a href="#3-修改main-js" class="headerlink" title="3.修改main.js"></a>3.修改main.js</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> <span class="title class_">Koa</span> = <span class="built_in">require</span>(<span class="string">&#x27;koa&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> &#123;<span class="variable constant_">APP_PORT</span>&#125; = <span class="built_in">require</span>(<span class="string">&#x27;./config/config.default&#x27;</span>)</span><br><span class="line"><span class="comment">//导入/router/user.router文件</span></span><br><span class="line"><span class="keyword">const</span> userRouter = <span class="built_in">require</span>(<span class="string">&#x27;./router/user.router&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> app = <span class="keyword">new</span> <span class="title class_">Koa</span>()</span><br><span class="line"><span class="comment">//使用</span></span><br><span class="line">app.<span class="title function_">use</span>(userRouter.<span class="title function_">routes</span>())</span><br><span class="line"></span><br><span class="line">app.<span class="title function_">listen</span>(<span class="variable constant_">APP_PORT</span>,<span class="function">()=&gt;</span>&#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">`server is running on http://localhost:<span class="subst">$&#123;APP_PORT&#125;</span>`</span>);</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><h2 id="五、目录结构优化"><a href="#五、目录结构优化" class="headerlink" title="五、目录结构优化"></a>五、目录结构优化</h2><h3 id="1-将-http-服务和-app-服务拆分"><a href="#1-将-http-服务和-app-服务拆分" class="headerlink" title="1.将 http 服务和 app 服务拆分"></a>1.将 http 服务和 app 服务拆分</h3><p>创建<code>src/app/index.js</code>文件</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> <span class="title class_">Koa</span> = <span class="built_in">require</span>(<span class="string">&#x27;koa&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> userRouter = <span class="built_in">require</span>(<span class="string">&#x27;../router/user.router&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> app = <span class="keyword">new</span> <span class="title class_">Koa</span>()</span><br><span class="line"></span><br><span class="line">app.<span class="title function_">use</span>(userRouter.<span class="title function_">routes</span>())</span><br><span class="line"></span><br><span class="line"><span class="variable language_">module</span>.<span class="property">exports</span> = app</span><br></pre></td></tr></table></figure><p>修改<code>main.js</code></p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> &#123;<span class="variable constant_">APP_PORT</span>&#125; = <span class="built_in">require</span>(<span class="string">&#x27;./config/config.default&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> app = <span class="built_in">require</span>(<span class="string">&quot;./app&quot;</span>)</span><br><span class="line"></span><br><span class="line">app.<span class="title function_">listen</span>(<span class="variable constant_">APP_PORT</span>,<span class="function">()=&gt;</span>&#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">`server is running on http://localhost:<span class="subst">$&#123;APP_PORT&#125;</span>`</span>);</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><h3 id="2-将路由和控制器拆分"><a href="#2-将路由和控制器拆分" class="headerlink" title="2.将路由和控制器拆分"></a>2.将路由和控制器拆分</h3><p>路由: 解析 URL, 分布给控制器对应的方法</p><p>控制器: 处理不同的业务</p><p>修改<code>user.route.js</code></p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> <span class="title class_">Router</span> = <span class="built_in">require</span>(<span class="string">&#x27;koa-router&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> &#123;register,login&#125; = <span class="built_in">require</span>(<span class="string">&#x27;../controller/user.controller&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> router = <span class="keyword">new</span> <span class="title class_">Router</span>(&#123; <span class="attr">prefix</span>: <span class="string">&#x27;/users&#x27;</span>&#125;)</span><br><span class="line"></span><br><span class="line"><span class="comment">//注册接口</span></span><br><span class="line">router.<span class="title function_">post</span>(<span class="string">&#x27;/register&#x27;</span>,register)</span><br><span class="line"><span class="comment">//登录接口</span></span><br><span class="line">router.<span class="title function_">post</span>(<span class="string">&#x27;/login&#x27;</span>,login)</span><br><span class="line"></span><br><span class="line"><span class="variable language_">module</span>.<span class="property">exports</span> = router</span><br></pre></td></tr></table></figure><p>创建<code>controller/user.controller.js</code></p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">UserController</span> &#123;</span><br><span class="line">  <span class="keyword">async</span> <span class="title function_">register</span>(<span class="params">ctx, next</span>) &#123;</span><br><span class="line">    ctx.<span class="property">body</span> = <span class="string">&#x27;用户注册成功&#x27;</span></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">async</span> <span class="title function_">login</span>(<span class="params">ctx, next</span>) &#123;</span><br><span class="line">    ctx.<span class="property">body</span> = <span class="string">&#x27;登录成功&#x27;</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="variable language_">module</span>.<span class="property">exports</span> = <span class="keyword">new</span> <span class="title class_">UserController</span>()</span><br></pre></td></tr></table></figure><h2 id="六-解析-body"><a href="#六-解析-body" class="headerlink" title="六. 解析 body"></a>六. 解析 body</h2><h3 id="1-安装-koa-body"><a href="#1-安装-koa-body" class="headerlink" title="1.安装 koa-body"></a>1.安装 koa-body</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm i koa-body</span><br></pre></td></tr></table></figure><h3 id="2-注册中间件"><a href="#2-注册中间件" class="headerlink" title="2.注册中间件"></a>2.注册中间件</h3><p>改写<code>app/index.js</code></p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> <span class="title class_">Koa</span> = <span class="built_in">require</span>(<span class="string">&#x27;koa&#x27;</span>)</span><br><span class="line"><span class="comment">//导入koa-body</span></span><br><span class="line"><span class="keyword">const</span> <span class="title class_">KoaBody</span> = <span class="built_in">require</span>(<span class="string">&#x27;koa-body&#x27;</span>)</span><br><span class="line"><span class="keyword">const</span> userRouter = <span class="built_in">require</span>(<span class="string">&#x27;../router/user.router&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> app = <span class="keyword">new</span> <span class="title class_">Koa</span>()</span><br><span class="line"></span><br><span class="line"><span class="comment">//注册koabody中间件的时候要在所有路由之前</span></span><br><span class="line">app.<span class="title function_">use</span>(<span class="title class_">KoaBody</span>())</span><br><span class="line"></span><br><span class="line">app.<span class="title function_">use</span>(userRouter.<span class="title function_">routes</span>())</span><br><span class="line"></span><br><span class="line"><span class="variable language_">module</span>.<span class="property">exports</span> = app</span><br></pre></td></tr></table></figure><h3 id="3-解析请求数据"><a href="#3-解析请求数据" class="headerlink" title="3.解析请求数据"></a>3.解析请求数据</h3><p>修改<code>user.controller.js</code>文件</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> &#123; createUser &#125; = <span class="built_in">require</span>(<span class="string">&#x27;../service/user.service&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">UserController</span> &#123;</span><br><span class="line">    <span class="keyword">async</span> <span class="title function_">register</span>(<span class="params">ctx, next</span>) &#123;</span><br><span class="line">        <span class="comment">// 获取数据</span></span><br><span class="line">        <span class="comment">// console.log(ctx.request.body);</span></span><br><span class="line">        <span class="keyword">const</span> &#123; user_name, password &#125; = ctx.<span class="property">request</span>.<span class="property">body</span></span><br><span class="line">        <span class="comment">// 操作数据库</span></span><br><span class="line">        <span class="keyword">const</span> res = <span class="keyword">await</span> <span class="title function_">createUser</span>(user_name, password)</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(res);</span><br><span class="line">        <span class="comment">// 返回结果</span></span><br><span class="line">        ctx.<span class="property">body</span> = ctx.<span class="property">request</span>.<span class="property">body</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">async</span> <span class="title function_">login</span>(<span class="params">ctx, next</span>) &#123;</span><br><span class="line">        ctx.<span class="property">body</span> = <span class="string">&#x27;登录成功&#x27;</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="variable language_">module</span>.<span class="property">exports</span> = <span class="keyword">new</span> <span class="title class_">UserController</span>()</span><br></pre></td></tr></table></figure><h3 id="4-拆分-service-层"><a href="#4-拆分-service-层" class="headerlink" title="4.拆分 service 层"></a>4.拆分 service 层</h3><p>service 层主要是做数据库处理</p><p>创建<code>src/service/user.service.js</code></p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">UserService</span> &#123;</span><br><span class="line">    <span class="keyword">async</span> <span class="title function_">createUser</span>(<span class="params">user_name,password</span>)&#123;</span><br><span class="line">        <span class="comment">//todo:写入数据库</span></span><br><span class="line">        <span class="keyword">return</span> <span class="string">&#x27;写入数据库成功&#x27;</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="variable language_">module</span>.<span class="property">exports</span> = <span class="keyword">new</span> <span class="title class_">UserService</span>()</span><br></pre></td></tr></table></figure><h2 id="七-数据库操作"><a href="#七-数据库操作" class="headerlink" title="七. 数据库操作"></a>七. 数据库操作</h2><p>sequelize ORM 数据库工具</p><p>ORM: 对象关系映射</p><ul><li>数据表映射(对应)一个类</li><li>数据表中的数据行(记录)对应一个对象</li><li>数据表字段对应对象的属性</li><li>数据表的操作对应对象的方法</li></ul><h3 id="1-安装-Sequelize-和-MySQL"><a href="#1-安装-Sequelize-和-MySQL" class="headerlink" title="1.安装 Sequelize 和 MySQL"></a>1.安装 Sequelize 和 MySQL</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm i mysql2 sequelize</span><br></pre></td></tr></table></figure><h3 id="2-连接数据库"><a href="#2-连接数据库" class="headerlink" title="2.连接数据库"></a>2.连接数据库</h3><p>新建<code>src/db/seq.js</code></p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> &#123; <span class="title class_">Sequelize</span> &#125; = <span class="built_in">require</span>(<span class="string">&#x27;sequelize&#x27;</span>)</span><br><span class="line"><span class="keyword">const</span> &#123; <span class="variable constant_">MYSQL_HOST</span>,</span><br><span class="line">    <span class="variable constant_">MYSQL_PORT</span>,</span><br><span class="line">    <span class="variable constant_">MYSQL_USER</span>,</span><br><span class="line">    <span class="variable constant_">MYSQL_PWD</span>,</span><br><span class="line">    <span class="variable constant_">MYSQL_DB</span> &#125; = <span class="built_in">require</span>(<span class="string">&#x27;../config/config.default&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> seq = <span class="keyword">new</span> <span class="title class_">Sequelize</span>(<span class="variable constant_">MYSQL_DB</span>, <span class="variable constant_">MYSQL_USER</span>, <span class="variable constant_">MYSQL_PWD</span>, &#123;</span><br><span class="line">    <span class="attr">host</span>: <span class="variable constant_">MYSQL_HOST</span>,</span><br><span class="line">    <span class="attr">dialect</span>: <span class="string">&#x27;mysql&#x27;</span></span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">seq.<span class="title function_">authenticate</span>().<span class="title function_">then</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;数据库连接成功&#x27;</span>);</span><br><span class="line">&#125;).<span class="title function_">catch</span>(<span class="function">(<span class="params">err</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;数据库连接失败&#x27;</span>, err);</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><h3 id="3-编写配置文件"><a href="#3-编写配置文件" class="headerlink" title="3.编写配置文件"></a>3.编写配置文件</h3><p>修改<code>.env</code></p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable constant_">APP_PORT</span> = <span class="number">8000</span></span><br><span class="line"></span><br><span class="line"><span class="variable constant_">MYSQL_HOST</span> = localhost</span><br><span class="line"><span class="variable constant_">MYSQL_PORT</span> = <span class="number">3306</span></span><br><span class="line"><span class="variable constant_">MYSQL_USER</span> = root</span><br><span class="line"><span class="variable constant_">MYSQL_PWD</span> = <span class="number">123456</span></span><br><span class="line"><span class="variable constant_">MYSQL_DB</span> = zdsc</span><br></pre></td></tr></table></figure><h2 id="八-创建-User-模型"><a href="#八-创建-User-模型" class="headerlink" title="八. 创建 User 模型"></a>八. 创建 User 模型</h2><h3 id="拆分-Model-层"><a href="#拆分-Model-层" class="headerlink" title="拆分 Model 层"></a>拆分 Model 层</h3><p>sequelize 主要通过 Model 对应数据表</p><p>创建<code>src/model/user.model.js</code></p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> &#123;<span class="title class_">DataTypes</span>&#125; = <span class="built_in">require</span>(<span class="string">&#x27;sequelize&#x27;</span>)</span><br><span class="line"><span class="keyword">const</span> seq = <span class="built_in">require</span>(<span class="string">&#x27;../db/seq&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">//创建模型</span></span><br><span class="line"><span class="keyword">const</span> <span class="title class_">User</span> = seq.<span class="title function_">define</span>(<span class="string">&#x27;zd_user&#x27;</span>,&#123;</span><br><span class="line">    <span class="comment">//id会被sequelize自动创建</span></span><br><span class="line">    <span class="attr">user_name</span>:&#123;</span><br><span class="line">        <span class="attr">type</span>:<span class="title class_">DataTypes</span>.<span class="property">STRING</span>,</span><br><span class="line">        <span class="attr">allowNull</span>:<span class="literal">false</span>,</span><br><span class="line">        <span class="attr">unique</span>:<span class="literal">true</span>,</span><br><span class="line">        <span class="attr">comment</span>:<span class="string">&#x27;用户名，唯一&#x27;</span>,</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="attr">password</span>:&#123;</span><br><span class="line">        <span class="attr">type</span>:<span class="title class_">DataTypes</span>.<span class="title function_">CHAR</span>(<span class="number">64</span>),</span><br><span class="line">        <span class="attr">allowNull</span>:<span class="literal">false</span>,</span><br><span class="line">        <span class="attr">comment</span>:<span class="string">&#x27;密码&#x27;</span>,</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="attr">is_admin</span>:&#123;</span><br><span class="line">        <span class="attr">type</span>:<span class="title class_">DataTypes</span>.<span class="property">BOOLEAN</span>,</span><br><span class="line">        <span class="attr">allowNull</span>:<span class="literal">false</span>,</span><br><span class="line">        <span class="attr">defaultValue</span>:<span class="number">0</span>,</span><br><span class="line">        <span class="attr">comment</span>:<span class="string">&#x27;是否为管理员 0:不是,1:是&#x27;</span></span><br><span class="line">    &#125;,</span><br><span class="line">&#125;,</span><br><span class="line"><span class="comment">// &#123;</span></span><br><span class="line"><span class="comment">//     timestamps:false</span></span><br><span class="line"><span class="comment">// &#125;</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="comment">// User.sync(&#123;force:true&#125;)</span></span><br><span class="line"></span><br><span class="line"><span class="variable language_">module</span>.<span class="property">exports</span> = <span class="title class_">User</span></span><br></pre></td></tr></table></figure><h2 id="九-添加用户入库"><a href="#九-添加用户入库" class="headerlink" title="九. 添加用户入库"></a>九. 添加用户入库</h2><p>所有数据库的操作都在 Service 层完成, Service 调用 Model 完成数据库操作</p><p>修改<code>src/service/user.service.js</code></p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> <span class="title class_">User</span> = <span class="built_in">require</span>(<span class="string">&#x27;../model/user.model&#x27;</span>)</span><br><span class="line"><span class="keyword">class</span> <span class="title class_">UserService</span> &#123;</span><br><span class="line">    <span class="keyword">async</span> <span class="title function_">createUser</span>(<span class="params">user_name, password</span>) &#123;</span><br><span class="line">        <span class="comment">//todo:写入数据库</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">//await表达式:promise对象的值</span></span><br><span class="line">        <span class="keyword">const</span> res = <span class="keyword">await</span> <span class="title class_">User</span>.<span class="title function_">create</span>(&#123;</span><br><span class="line">            user_name, password</span><br><span class="line">        &#125;)</span><br><span class="line">        <span class="comment">//console.log(res);</span></span><br><span class="line">        <span class="keyword">return</span> res.<span class="property">dataValues</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="variable language_">module</span>.<span class="property">exports</span> = <span class="keyword">new</span> <span class="title class_">UserService</span>()</span><br></pre></td></tr></table></figure><p>修改<code>user.controller.js</code></p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> &#123; createUser &#125; = <span class="built_in">require</span>(<span class="string">&#x27;../service/user.service&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">UserController</span> &#123;</span><br><span class="line">    <span class="keyword">async</span> <span class="title function_">register</span>(<span class="params">ctx, next</span>) &#123;</span><br><span class="line">        <span class="comment">// 获取数据</span></span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(ctx.<span class="property">request</span>.<span class="property">body</span>);</span><br><span class="line">        <span class="keyword">const</span> &#123; user_name, password &#125; = ctx.<span class="property">request</span>.<span class="property">body</span></span><br><span class="line">        <span class="comment">// 操作数据库</span></span><br><span class="line">        <span class="keyword">const</span> res = <span class="keyword">await</span> <span class="title function_">createUser</span>(user_name, password)</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(res);</span><br><span class="line">        <span class="comment">// 返回结果</span></span><br><span class="line">        ctx.<span class="property">body</span> = &#123;</span><br><span class="line">            <span class="attr">code</span>:<span class="number">200</span>,</span><br><span class="line">            <span class="attr">message</span>:<span class="string">&#x27;用户注册成功&#x27;</span>,</span><br><span class="line">            <span class="attr">result</span>:&#123;</span><br><span class="line">                <span class="attr">id</span>:res.<span class="property">id</span>,</span><br><span class="line">                <span class="attr">user_name</span>:res.<span class="property">user_name</span></span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">async</span> <span class="title function_">login</span>(<span class="params">ctx, next</span>) &#123;</span><br><span class="line">        ctx.<span class="property">body</span> = <span class="string">&#x27;登录成功&#x27;</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="variable language_">module</span>.<span class="property">exports</span> = <span class="keyword">new</span> <span class="title class_">UserController</span>()</span><br></pre></td></tr></table></figure><h2 id="十-错误处理"><a href="#十-错误处理" class="headerlink" title="十. 错误处理"></a>十. 错误处理</h2><p>在控制器中, 对不同的错误进行处理, 返回不同的提示错误提示, 提高代码质量</p><p><code>user.controller.js</code></p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> &#123; createUser,getUserInfo &#125; = <span class="built_in">require</span>(<span class="string">&#x27;../service/user.service&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">UserController</span> &#123;</span><br><span class="line">    <span class="keyword">async</span> <span class="title function_">register</span>(<span class="params">ctx, next</span>) &#123;</span><br><span class="line">        <span class="comment">// 获取数据</span></span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(ctx.<span class="property">request</span>.<span class="property">body</span>);</span><br><span class="line">        <span class="keyword">const</span> &#123; user_name, password &#125; = ctx.<span class="property">request</span>.<span class="property">body</span></span><br><span class="line">        <span class="comment">//合法性</span></span><br><span class="line">        <span class="keyword">if</span>(!user_name || !password)&#123;</span><br><span class="line">            <span class="variable language_">console</span>.<span class="title function_">error</span>(<span class="string">&#x27;用户名或密码为空&#x27;</span>,ctx.<span class="property">request</span>.<span class="property">body</span>);</span><br><span class="line">            ctx.<span class="property">status</span> = <span class="number">400</span>,</span><br><span class="line">            ctx.<span class="property">body</span> = &#123;</span><br><span class="line">                <span class="attr">code</span>: <span class="string">&#x27;400&#x27;</span>,</span><br><span class="line">                <span class="attr">message</span>: <span class="string">&#x27;用户名或密码为空&#x27;</span>,</span><br><span class="line">                <span class="attr">result</span>: <span class="string">&#x27;&#x27;</span></span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">return</span></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">//合理性</span></span><br><span class="line">        <span class="keyword">if</span>(<span class="title function_">getUserInfo</span>(&#123;user_name&#125;))&#123;</span><br><span class="line">            ctx.<span class="property">status</span> = <span class="number">409</span>,</span><br><span class="line">            ctx.<span class="property">body</span> = &#123;</span><br><span class="line">                <span class="attr">code</span>:<span class="string">&#x27;409&#x27;</span>,</span><br><span class="line">                <span class="attr">message</span>: <span class="string">&#x27;用户已经存在&#x27;</span>,</span><br><span class="line">                <span class="attr">result</span>:<span class="string">&#x27;&#x27;</span></span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">return</span></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// 操作数据库</span></span><br><span class="line">        <span class="keyword">const</span> res = <span class="keyword">await</span> <span class="title function_">createUser</span>(user_name, password)</span><br><span class="line">        <span class="comment">// console.log(res);</span></span><br><span class="line">        <span class="comment">// 返回结果</span></span><br><span class="line">        ctx.<span class="property">body</span> = &#123;</span><br><span class="line">            <span class="attr">code</span>:<span class="number">200</span>,</span><br><span class="line">            <span class="attr">message</span>:<span class="string">&#x27;用户注册成功&#x27;</span>,</span><br><span class="line">            <span class="attr">result</span>:&#123;</span><br><span class="line">                <span class="attr">id</span>:res.<span class="property">id</span>,</span><br><span class="line">                <span class="attr">user_name</span>:res.<span class="property">user_name</span></span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">async</span> <span class="title function_">login</span>(<span class="params">ctx, next</span>) &#123;</span><br><span class="line">        ctx.<span class="property">body</span> = <span class="string">&#x27;登录成功&#x27;</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="variable language_">module</span>.<span class="property">exports</span> = <span class="keyword">new</span> <span class="title class_">UserController</span>()</span><br></pre></td></tr></table></figure><p>在 service 中封装函数</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> <span class="title class_">User</span> = <span class="built_in">require</span>(<span class="string">&#x27;../model/user.model&#x27;</span>)</span><br><span class="line"><span class="keyword">class</span> <span class="title class_">UserService</span> &#123;</span><br><span class="line">    <span class="keyword">async</span> <span class="title function_">createUser</span>(<span class="params">user_name, password</span>) &#123;</span><br><span class="line">        <span class="comment">//todo:写入数据库</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">//await表达式:promise对象的值</span></span><br><span class="line">        <span class="keyword">const</span> res = <span class="keyword">await</span> <span class="title class_">User</span>.<span class="title function_">create</span>(&#123;</span><br><span class="line">            user_name, password</span><br><span class="line">        &#125;)</span><br><span class="line">        <span class="comment">//console.log(res);</span></span><br><span class="line">        <span class="keyword">return</span> res.<span class="property">dataValues</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">async</span> <span class="title function_">getUserInfo</span>(<span class="params">&#123;id,user_name,password,is_admin&#125;</span>) &#123;</span><br><span class="line">        <span class="keyword">const</span>  whereOpt = &#123;&#125;</span><br><span class="line">        id &amp;&amp; <span class="title class_">Object</span>.<span class="title function_">assign</span>(whereOpt,&#123;id&#125;)</span><br><span class="line">        user_name &amp;&amp; <span class="title class_">Object</span>.<span class="title function_">assign</span>(whereOpt,&#123;user_name&#125;)</span><br><span class="line">        password &amp;&amp; <span class="title class_">Object</span>.<span class="title function_">assign</span>(whereOpt,&#123;password&#125;)</span><br><span class="line">        is_admin &amp;&amp; <span class="title class_">Object</span>.<span class="title function_">assign</span>(whereOpt,&#123;is_admin&#125;)</span><br><span class="line"></span><br><span class="line">      <span class="keyword">const</span> res = <span class="keyword">await</span> <span class="title class_">User</span>.<span class="title function_">findOne</span>(&#123;</span><br><span class="line">            <span class="attr">attributes</span>:[<span class="string">&#x27;id&#x27;</span>,<span class="string">&#x27;user_name&#x27;</span>,<span class="string">&#x27;password&#x27;</span>,<span class="string">&#x27;is_admin&#x27;</span>],</span><br><span class="line">            <span class="attr">where</span>:whereOpt</span><br><span class="line">        &#125;)</span><br><span class="line">        <span class="keyword">return</span> res ? res.<span class="property">dataValues</span> : <span class="literal">null</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="variable language_">module</span>.<span class="property">exports</span> = <span class="keyword">new</span> <span class="title class_">UserService</span>()</span><br></pre></td></tr></table></figure><h2 id="十一、拆分中间件"><a href="#十一、拆分中间件" class="headerlink" title="十一、拆分中间件"></a>十一、拆分中间件</h2><ul><li>在出错的地方使用<code>ctx.app.emit</code>提交错误</li><li>在 app 中通过<code>app.on</code>监听</li></ul><h3 id="1-拆分中间件"><a href="#1-拆分中间件" class="headerlink" title="1.拆分中间件"></a>1.拆分中间件</h3><p>添加<code>src/middleware/user.middleware.js</code></p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> &#123; getUserInfo &#125; = <span class="built_in">require</span>(<span class="string">&#x27;../service/user.service&#x27;</span>)</span><br><span class="line"><span class="keyword">const</span> &#123; userFormateError, userAlreadyExited,userRegisterError&#125; = <span class="built_in">require</span>(<span class="string">&#x27;../consitant/err.type&#x27;</span>)</span><br><span class="line"><span class="keyword">const</span> <span class="title function_">userValidator</span> = <span class="keyword">async</span> (<span class="params">ctx, next</span>) =&gt; &#123;</span><br><span class="line">    <span class="keyword">const</span> &#123; user_name, password &#125; = ctx.<span class="property">request</span>.<span class="property">body</span></span><br><span class="line">    <span class="comment">//合法性</span></span><br><span class="line">    <span class="keyword">if</span> (!user_name || !password) &#123;</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">error</span>(<span class="string">&#x27;用户名或密码为空&#x27;</span>, ctx.<span class="property">request</span>.<span class="property">body</span>);</span><br><span class="line">        ctx.<span class="property">app</span>.<span class="title function_">emit</span>(<span class="string">&#x27;error&#x27;</span>, userFormateError, ctx)</span><br><span class="line">        <span class="keyword">return</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">await</span> <span class="title function_">next</span>()</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">const</span> <span class="title function_">userVerify</span> = <span class="keyword">async</span> (<span class="params">ctx, next</span>) =&gt; &#123;</span><br><span class="line">    <span class="keyword">const</span> &#123; user_name &#125; = ctx.<span class="property">request</span>.<span class="property">body</span></span><br><span class="line">    <span class="comment">//合理性</span></span><br><span class="line">    <span class="comment">// if (await getUserInfo(&#123; user_name &#125;)) &#123;</span></span><br><span class="line">    <span class="comment">//     ctx.app.emit(&#x27;error&#x27;,userAlreadyExited,ctx)</span></span><br><span class="line">    <span class="comment">//     return</span></span><br><span class="line">    <span class="comment">// &#125;</span></span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        <span class="keyword">const</span> res = <span class="keyword">await</span> <span class="title function_">getUserInfo</span>(&#123;user_name&#125;)</span><br><span class="line">        <span class="keyword">if</span> (res) &#123;</span><br><span class="line">            <span class="variable language_">console</span>.<span class="title function_">error</span>(<span class="string">&#x27;用户名已经存在&#x27;</span>,&#123;user_name&#125;);</span><br><span class="line">            ctx.<span class="property">app</span>.<span class="title function_">emit</span>(<span class="string">&#x27;error&#x27;</span>,userAlreadyExited,ctx)</span><br><span class="line">            <span class="keyword">return</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125; <span class="keyword">catch</span> (err) &#123;</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">error</span>(<span class="string">&#x27;获取用户信息错误&#x27;</span>,err);</span><br><span class="line">        ctx.<span class="property">app</span>.<span class="title function_">emit</span>(<span class="string">&#x27;error&#x27;</span>,userRegisterError,ctx)</span><br><span class="line">        <span class="keyword">return</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">await</span> <span class="title function_">next</span>()</span><br><span class="line">&#125;</span><br><span class="line"><span class="variable language_">module</span>.<span class="property">exports</span> = &#123; userValidator, userVerify &#125;</span><br></pre></td></tr></table></figure><h3 id="2-统一错误处理"><a href="#2-统一错误处理" class="headerlink" title="2.统一错误处理"></a>2.统一错误处理</h3><p>编写统一的错误定义文件</p><p>新建<code>src/consitant/err.type.js</code></p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable language_">module</span>.<span class="property">exports</span> = &#123;</span><br><span class="line">    <span class="attr">userFormateError</span>:&#123;</span><br><span class="line">        <span class="attr">code</span>: <span class="string">&#x27;400&#x27;</span>,</span><br><span class="line">        <span class="attr">message</span>: <span class="string">&#x27;用户名或密码为空&#x27;</span>,</span><br><span class="line">        <span class="attr">result</span>:<span class="string">&#x27;&#x27;</span></span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="attr">userAlreadyExited</span>:&#123;</span><br><span class="line">        <span class="attr">code</span>: <span class="string">&#x27;409&#x27;</span>,</span><br><span class="line">        <span class="attr">message</span>: <span class="string">&#x27;用户已存在&#x27;</span>,</span><br><span class="line">        <span class="attr">result</span>:<span class="string">&#x27;&#x27;</span></span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="attr">userRegisterError</span>:&#123;</span><br><span class="line">        <span class="attr">code</span>: <span class="string">&#x27;400&#x27;</span>,</span><br><span class="line">        <span class="attr">message</span>: <span class="string">&#x27;用户注册失败&#x27;</span>,</span><br><span class="line">        <span class="attr">result</span>:<span class="string">&#x27;&#x27;</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="3-错误处理函数"><a href="#3-错误处理函数" class="headerlink" title="3.错误处理函数"></a>3.错误处理函数</h3><p>新建<code>src/app/errHandler.js</code></p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable language_">module</span>.<span class="property">exports</span> = <span class="function">(<span class="params">err,ctx</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">let</span> status = <span class="number">500</span></span><br><span class="line">    <span class="keyword">switch</span> (err.<span class="property">code</span>) &#123;</span><br><span class="line">        <span class="keyword">case</span> <span class="string">&#x27;400&#x27;</span>:</span><br><span class="line">            status = <span class="number">400</span></span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        <span class="keyword">case</span> <span class="string">&#x27;409&#x27;</span>:</span><br><span class="line">            status = <span class="number">409</span></span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        <span class="attr">default</span>:</span><br><span class="line">            status = <span class="number">500</span></span><br><span class="line">    &#125;</span><br><span class="line">    ctx.<span class="property">status</span> = status</span><br><span class="line">    ctx.<span class="property">body</span> = err</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>修改<code>app/index.js</code></p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> errHandler = <span class="built_in">require</span>(<span class="string">&#x27;./errHandler&#x27;</span>)</span><br><span class="line"><span class="comment">// 统一的错误处理</span></span><br><span class="line">app.<span class="title function_">on</span>(<span class="string">&#x27;error&#x27;</span>, errHandler)</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> js </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Node.js </tag>
            
            <tag> js </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>字符串的常用方法</title>
      <link href="/article/8c816929.html"/>
      <url>/article/8c816929.html</url>
      
        <content type="html"><![CDATA[<h3 id="1-增"><a href="#1-增" class="headerlink" title="1. 增"></a>1. 增</h3><p>这里增的意思并不是说直接增添内容，而是创建字符串的一个副本，再进行操作</p><p>除了常用<code>+</code>以及<code>$&#123;&#125;</code>进行字符串拼接之外，还可通过<code>concat</code></p><h4 id="1-1-concat"><a href="#1-1-concat" class="headerlink" title="1.1 concat()"></a>1.1 concat()</h4><p>用于将一个或多个字符串拼接成一个新字符串</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> stringValue = <span class="string">&quot;hello &quot;</span>;</span><br><span class="line"><span class="keyword">let</span> result = stringValue.<span class="title function_">concat</span>(<span class="string">&quot;world&quot;</span>);</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(result); <span class="comment">// &quot;hello world&quot;</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(stringValue); <span class="comment">// &quot;hello&quot;</span></span><br></pre></td></tr></table></figure><h4 id="2-删"><a href="#2-删" class="headerlink" title="2. 删"></a>2. 删</h4><p>这里的删的意思并不是说删除原字符串的内容，而是创建字符串的一个副本，再进行操作</p><p>常见的有：</p><ul><li>slice()</li><li>substr()</li><li>substring()</li></ul><p>这三个方法都返回调用它们的字符串的一个子字符串，而且都接收一或两个参数。</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> stringValue = <span class="string">&quot;hello world&quot;</span>;</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(stringValue.<span class="title function_">slice</span>(<span class="number">3</span>)); <span class="comment">// &quot;lo world&quot;</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(stringValue.<span class="title function_">substring</span>(<span class="number">3</span>)); <span class="comment">// &quot;lo world&quot;</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(stringValue.<span class="title function_">substr</span>(<span class="number">3</span>)); <span class="comment">// &quot;lo world&quot;</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(stringValue.<span class="title function_">slice</span>(<span class="number">3</span>, <span class="number">7</span>)); <span class="comment">// &quot;lo w&quot;</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(stringValue.<span class="title function_">substring</span>(<span class="number">3</span>,<span class="number">7</span>)); <span class="comment">// &quot;lo w&quot;</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(stringValue.<span class="title function_">substr</span>(<span class="number">3</span>, <span class="number">7</span>)); <span class="comment">// &quot;lo worl&quot;</span></span><br></pre></td></tr></table></figure><h4 id="3-改"><a href="#3-改" class="headerlink" title="3. 改"></a>3. 改</h4><p>这里改的意思也不是改变原字符串，而是创建字符串的一个副本，再进行操作</p><p>常见的有：</p><ul><li>trim()、trimLeft()、trimRight()</li><li>repeat()</li><li>padStart()、padEnd()</li><li>toLowerCase()、 toUpperCase()</li></ul><h4 id="3-1-trim-、trimLeft-、trimRight"><a href="#3-1-trim-、trimLeft-、trimRight" class="headerlink" title="3.1  trim()、trimLeft()、trimRight()"></a>3.1  trim()、trimLeft()、trimRight()</h4><p>删除前、后或前后所有空格符，再返回新的字符串</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> stringValue = <span class="string">&quot; hello world &quot;</span>;</span><br><span class="line"><span class="keyword">let</span> trimmedStringValue = stringValue.<span class="title function_">trim</span>();</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(stringValue); <span class="comment">// &quot; hello world &quot;</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(trimmedStringValue); <span class="comment">// &quot;hello world&quot;</span></span><br></pre></td></tr></table></figure><h4 id="3-2-repeat"><a href="#3-2-repeat" class="headerlink" title="3.2 repeat()"></a>3.2 repeat()</h4><p>接收一个整数参数，表示要将字符串复制多少次，然后返回拼接所有副本后的结果</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> stringValue = <span class="string">&quot;na &quot;</span>;</span><br><span class="line"><span class="keyword">let</span> copyResult = stringValue.<span class="title function_">repeat</span>(<span class="number">2</span>) <span class="comment">// na na </span></span><br></pre></td></tr></table></figure><h4 id="3-3-padStart-、padEnd"><a href="#3-3-padStart-、padEnd" class="headerlink" title="3.3 padStart()、padEnd()"></a>3.3 padStart()、padEnd()</h4><p>复制字符串，如果小于指定长度，则在相应一边填充字符，直至满足长度条件</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">let stringValue = &quot;foo&quot;;</span><br><span class="line">console.log(stringValue.padStart(6)); // &quot; foo&quot;</span><br><span class="line">console.log(stringValue.padStart(9, &quot;.&quot;)); // &quot;......foo&quot;</span><br></pre></td></tr></table></figure><h4 id="3-4-toLowerCase-、-toUpperCase"><a href="#3-4-toLowerCase-、-toUpperCase" class="headerlink" title="3.4 toLowerCase()、 toUpperCase()"></a>3.4 toLowerCase()、 toUpperCase()</h4><p>大小写转化</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> stringValue = <span class="string">&quot;hello world&quot;</span>;</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(stringValue.<span class="title function_">toUpperCase</span>()); <span class="comment">// &quot;HELLO WORLD&quot;</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(stringValue.<span class="title function_">toLowerCase</span>()); <span class="comment">// &quot;hello world&quot;</span></span><br></pre></td></tr></table></figure><h3 id="4-查"><a href="#4-查" class="headerlink" title="4. 查"></a>4. 查</h3><p>除了通过索引的方式获取字符串的值，还可通过：</p><ul><li>chatAt()</li><li>indexOf()</li><li>startWith()</li><li>includes()</li></ul><h4 id="4-1-charAt"><a href="#4-1-charAt" class="headerlink" title="4.1 charAt()"></a>4.1 charAt()</h4><p>返回给定索引位置的字符，由传给方法的整数参数指定</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> message = <span class="string">&quot;abcde&quot;</span>;</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(message.<span class="title function_">charAt</span>(<span class="number">2</span>)); <span class="comment">// &quot;c&quot;</span></span><br></pre></td></tr></table></figure><h4 id="4-2-indexOf"><a href="#4-2-indexOf" class="headerlink" title="4.2 indexOf()"></a>4.2 indexOf()</h4><p>从字符串开头去搜索传入的字符串，并返回位置（如果没找到，则返回 -1 ）</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> stringValue = <span class="string">&quot;hello world&quot;</span>;</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(stringValue.<span class="title function_">indexOf</span>(<span class="string">&quot;o&quot;</span>)); <span class="comment">// 4</span></span><br></pre></td></tr></table></figure><h4 id="4-3-startWith-、includes"><a href="#4-3-startWith-、includes" class="headerlink" title="4.3 startWith()、includes()"></a>4.3 startWith()、includes()</h4><p>从字符串中搜索传入的字符串，并返回一个表示是否包含的布尔值</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> message = <span class="string">&quot;foobarbaz&quot;</span>;</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(message.<span class="title function_">startsWith</span>(<span class="string">&quot;foo&quot;</span>)); <span class="comment">// true</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(message.<span class="title function_">startsWith</span>(<span class="string">&quot;bar&quot;</span>)); <span class="comment">// false</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(message.<span class="title function_">includes</span>(<span class="string">&quot;bar&quot;</span>)); <span class="comment">// true</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(message.<span class="title function_">includes</span>(<span class="string">&quot;qux&quot;</span>)); <span class="comment">// false</span></span><br></pre></td></tr></table></figure><h3 id="5-转换方法"><a href="#5-转换方法" class="headerlink" title="5.转换方法"></a>5.转换方法</h3><h4 id="5-1-split"><a href="#5-1-split" class="headerlink" title="5.1 split"></a>5.1 split</h4><p>把字符串按照指定的分割符，拆分成数组中的每一项</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> str = <span class="string">&quot;12+23+34&quot;</span></span><br><span class="line"><span class="keyword">let</span> arr = str.<span class="title function_">split</span>(<span class="string">&quot;+&quot;</span>) <span class="comment">// [12,23,34]</span></span><br></pre></td></tr></table></figure><h3 id="6-模板匹配方法"><a href="#6-模板匹配方法" class="headerlink" title="6.模板匹配方法"></a>6.模板匹配方法</h3><h4 id="6-1-match"><a href="#6-1-match" class="headerlink" title="6.1. match()"></a>6.1. match()</h4><p>接收一个参数，可以是一个正则表达式字符串，也可以是一个<code>RegExp</code>对象，返回数组</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> text = <span class="string">&quot;cat, bat, sat, fat&quot;</span>;</span><br><span class="line"><span class="keyword">let</span> pattern = <span class="regexp">/.at/</span>;</span><br><span class="line"><span class="keyword">let</span> matches = text.<span class="title function_">match</span>(pattern);</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(matches[<span class="number">0</span>]); <span class="comment">// &quot;cat&quot;</span></span><br></pre></td></tr></table></figure><h4 id="6-2-search"><a href="#6-2-search" class="headerlink" title="6.2.  search()"></a>6.2.  search()</h4><p>接收一个参数，可以是一个正则表达式字符串，也可以是一个<code>RegExp</code>对象，找到则返回匹配索引，否则返回 -1</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> text = <span class="string">&quot;cat, bat, sat, fat&quot;</span>;</span><br><span class="line"><span class="keyword">let</span> pos = text.<span class="title function_">search</span>(<span class="regexp">/at/</span>);</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(pos); <span class="comment">// 1</span></span><br></pre></td></tr></table></figure><h4 id="6-3-replace"><a href="#6-3-replace" class="headerlink" title="6.3 replace()"></a>6.3 replace()</h4><p>接收两个参数，第一个参数为匹配的内容，第二个参数为替换的元素（可用函数）</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> text = <span class="string">&quot;cat, bat, sat, fat&quot;</span>;</span><br><span class="line"><span class="keyword">let</span> result = text.<span class="title function_">replace</span>(<span class="string">&quot;at&quot;</span>, <span class="string">&quot;ond&quot;</span>);</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(result); <span class="comment">// &quot;cond, bat, sat, fat&quot;</span></span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> js </category>
          
      </categories>
      
      
        <tags>
            
            <tag> js </tag>
            
            <tag> 面试 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>数组的常用方法</title>
      <link href="/article/aa760b4.html"/>
      <url>/article/aa760b4.html</url>
      
        <content type="html"><![CDATA[<h3 id="1-增"><a href="#1-增" class="headerlink" title="1. 增"></a>1. 增</h3><ul><li>push() - 影响原数组</li><li>unshift() - 影响原数组</li><li>splice() - 影响原数组</li><li>concat() - 不影响原数组</li></ul><h4 id="1-1-push"><a href="#1-1-push" class="headerlink" title="1.1 push()"></a>1.1 push()</h4><p><code>push()</code>方法接收任意数量的参数，并将它们添加到数组末尾，返回数组的最新长度</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> color = []; <span class="comment">// 创建一个数组</span></span><br><span class="line"><span class="keyword">let</span> a = color.<span class="title function_">push</span>(<span class="string">&quot;red&quot;</span>, <span class="string">&quot;green&quot;</span>); <span class="comment">// 推入两项</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(a) <span class="comment">// 2</span></span><br></pre></td></tr></table></figure><h4 id="1-2-unshift"><a href="#1-2-unshift" class="headerlink" title="1.2 unshift()"></a>1.2 unshift()</h4><p><code>unshift()</code>在数组开头添加任意多个值，然后返回新的数组长度</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> color = []; <span class="comment">// 创建一个数组</span></span><br><span class="line"><span class="keyword">let</span> a = color.<span class="title function_">unshift</span>(<span class="string">&quot;red&quot;</span>, <span class="string">&quot;green&quot;</span>); <span class="comment">// 从数组开头推入两项</span></span><br><span class="line"><span class="title function_">alert</span>(a); <span class="comment">// 2</span></span><br></pre></td></tr></table></figure><h4 id="1-3-splice"><a href="#1-3-splice" class="headerlink" title="1.3 splice()"></a>1.3 splice()</h4><p><code>splice()</code>传入三个参数，分别是开始位置、0（要删除的元素数量）、插入的元素，返回空数组</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> colors = [<span class="string">&quot;red&quot;</span>, <span class="string">&quot;green&quot;</span>, <span class="string">&quot;blue&quot;</span>];</span><br><span class="line"><span class="keyword">let</span> removed = colors.<span class="title function_">splice</span>(<span class="number">1</span>, <span class="number">0</span>, <span class="string">&quot;yellow&quot;</span>, <span class="string">&quot;orange&quot;</span>)</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(colors) <span class="comment">// red,yellow,orange,green,blue</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(removed) <span class="comment">// []</span></span><br></pre></td></tr></table></figure><h4 id="1-4-concat"><a href="#1-4-concat" class="headerlink" title="1.4 concat()"></a>1.4 concat()</h4><p>首先会创建一个当前数组的副本，然后再把它的参数添加到副本末尾，最后返回这个新构建的数组，不会影响原始数组</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> color = [<span class="string">&quot;red&quot;</span>, <span class="string">&quot;green&quot;</span>, <span class="string">&quot;blue&quot;</span>];</span><br><span class="line"><span class="keyword">let</span> color1 = colors.<span class="title function_">concat</span>(<span class="string">&quot;yellow&quot;</span>, [<span class="string">&quot;black&quot;</span>, <span class="string">&quot;brown&quot;</span>]);</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(color); <span class="comment">// [&quot;red&quot;, &quot;green&quot;,&quot;blue&quot;]</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(color1); <span class="comment">// [&quot;red&quot;, &quot;green&quot;, &quot;blue&quot;, &quot;yellow&quot;, &quot;black&quot;, &quot;brown&quot;]</span></span><br></pre></td></tr></table></figure><h3 id="2-删"><a href="#2-删" class="headerlink" title="2. 删"></a>2. 删</h3><ul><li>pop()： 删除数组的最后一项</li><li>shift()： 删除数组的第一项</li><li>splice()</li><li>slice()</li></ul><h4 id="2-1-pop"><a href="#2-1-pop" class="headerlink" title="2.1 pop()"></a>2.1 pop()</h4><p><code>pop()</code> 方法用于删除数组的最后一项，同时减少数组的<code>length</code> 值，返回被删除的项</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> color = [<span class="string">&quot;red&quot;</span>, <span class="string">&quot;green&quot;</span>]</span><br><span class="line"><span class="keyword">let</span> item = colors.<span class="title function_">pop</span>(); <span class="comment">// 取得最后一项</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(item) <span class="comment">// green</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(color.<span class="property">length</span>) <span class="comment">// 1</span></span><br></pre></td></tr></table></figure><h4 id="2-2-shift"><a href="#2-2-shift" class="headerlink" title="2.2 shift()"></a>2.2 shift()</h4><p><code>shift()</code>方法用于删除数组的第一项，同时减少数组的<code>length</code> 值，返回被删除的项</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> color = [<span class="string">&quot;red&quot;</span>, <span class="string">&quot;green&quot;</span>]</span><br><span class="line"><span class="keyword">let</span> item = color.<span class="title function_">shift</span>(); <span class="comment">// 取得第一项</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(item) <span class="comment">// red</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(color.<span class="property">length</span>) <span class="comment">// 1</span></span><br></pre></td></tr></table></figure><h4 id="2-3-splice"><a href="#2-3-splice" class="headerlink" title="2.3 splice()"></a>2.3 splice()</h4><p>传入两个参数，分别是开始位置，删除元素的数量，返回包含删除元素的数组</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> colors = [<span class="string">&quot;red&quot;</span>, <span class="string">&quot;green&quot;</span>, <span class="string">&quot;blue&quot;</span>];</span><br><span class="line"><span class="keyword">let</span> removed = colors.<span class="title function_">splice</span>(<span class="number">0</span>,<span class="number">1</span>); <span class="comment">// 删除第一项</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(colors); <span class="comment">// green,blue</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(removed); <span class="comment">// red，只有一个元素的数组</span></span><br></pre></td></tr></table></figure><h4 id="2-4-slice"><a href="#2-4-slice" class="headerlink" title="2.4 slice()"></a>2.4 slice()</h4><p><code>slice()</code> 用于创建一个包含原有数组中一个或多个元素的新数组，不会影响原始数组</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> colors = [<span class="string">&quot;red&quot;</span>, <span class="string">&quot;green&quot;</span>, <span class="string">&quot;blue&quot;</span>, <span class="string">&quot;yellow&quot;</span>, <span class="string">&quot;purple&quot;</span>];</span><br><span class="line"><span class="keyword">let</span> colors2 = colors.<span class="title function_">slice</span>(<span class="number">1</span>);</span><br><span class="line"><span class="keyword">let</span> colors3 = colors.<span class="title function_">slice</span>(<span class="number">1</span>, <span class="number">4</span>);</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(colors)   <span class="comment">// red,green,blue,yellow,purple</span></span><br><span class="line">concole.<span class="title function_">log</span>(colors2); <span class="comment">// green,blue,yellow,purple</span></span><br><span class="line">concole.<span class="title function_">log</span>(colors3); <span class="comment">// green,blue,yellow</span></span><br></pre></td></tr></table></figure><h3 id="3-改"><a href="#3-改" class="headerlink" title="3.改"></a>3.改</h3><p>即修改原来数组的内容，常用<code>splice</code></p><h4 id="3-1-splice"><a href="#3-1-splice" class="headerlink" title="3.1 splice()"></a>3.1 splice()</h4><p>传入三个参数，分别是开始位置，要删除元素的数量，要插入的任意多个元素，返回删除元素的数组，对原数组产生影响 </p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> colors = [<span class="string">&quot;red&quot;</span>, <span class="string">&quot;green&quot;</span>, <span class="string">&quot;blue&quot;</span>];</span><br><span class="line"><span class="keyword">let</span> removed = colors.<span class="title function_">splice</span>(<span class="number">1</span>, <span class="number">1</span>, <span class="string">&quot;red&quot;</span>, <span class="string">&quot;purple&quot;</span>); <span class="comment">// 插入两个值，删除一个元素</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(colors); <span class="comment">// red,red,purple,blue</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(removed); <span class="comment">// green，只有一个元素的数组</span></span><br></pre></td></tr></table></figure><h3 id="4-查"><a href="#4-查" class="headerlink" title="4.查"></a>4.查</h3><ul><li>indexOf()</li><li>includes()</li><li>find()</li></ul><h4 id="4-1-indexOf"><a href="#4-1-indexOf" class="headerlink" title="4.1 indexOf()"></a>4.1 indexOf()</h4><p>返回要查找的元素在数组中的位置，如果没找到则返回 -1</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> numbers = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">4</span>, <span class="number">3</span>, <span class="number">2</span>, <span class="number">1</span>];</span><br><span class="line">numbers.<span class="title function_">indexOf</span>(<span class="number">4</span>) <span class="comment">// 3</span></span><br><span class="line">numbers.<span class="title function_">indexOf</span>(<span class="number">6</span>) <span class="comment">// -1</span></span><br></pre></td></tr></table></figure><h4 id="4-2-includes"><a href="#4-2-includes" class="headerlink" title="4.2  includes()"></a>4.2  includes()</h4><p>返回要查找的元素在数组中的位置，找到返回<code>true</code>，否则<code>false</code></p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> numbers = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">4</span>, <span class="number">3</span>, <span class="number">2</span>, <span class="number">1</span>];</span><br><span class="line">numbers.<span class="title function_">includes</span>(<span class="number">4</span>) <span class="comment">// true</span></span><br><span class="line">numbers.<span class="title function_">indexOf</span>(<span class="number">6</span>) <span class="comment">// false</span></span><br></pre></td></tr></table></figure><h4 id="4-3-find"><a href="#4-3-find" class="headerlink" title="4.3 find()"></a>4.3 find()</h4><p>返回第一个匹配的元素</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> people = [</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="attr">name</span>: <span class="string">&quot;Matt&quot;</span>,</span><br><span class="line">        <span class="attr">age</span>: <span class="number">27</span></span><br><span class="line">    &#125;,</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="attr">name</span>: <span class="string">&quot;Nicholas&quot;</span>,</span><br><span class="line">        <span class="attr">age</span>: <span class="number">29</span></span><br><span class="line">    &#125;</span><br><span class="line">];</span><br><span class="line">people.<span class="title function_">find</span>(<span class="function">(<span class="params">element, index, array</span>) =&gt;</span> element.<span class="property">age</span> &lt; <span class="number">28</span>) </span><br><span class="line"><span class="comment">// &#123;name: &quot;Matt&quot;, age: 27&#125;</span></span><br></pre></td></tr></table></figure><h3 id="5-排序方法"><a href="#5-排序方法" class="headerlink" title="5.排序方法"></a>5.排序方法</h3><ul><li>reverse()</li><li>sort()</li></ul><h4 id="5-1-reverse"><a href="#5-1-reverse" class="headerlink" title="5.1 reverse()"></a>5.1 reverse()</h4><p>顾名思义，将数组元素方向反转</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> values = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>];</span><br><span class="line">values.<span class="title function_">reverse</span>();</span><br><span class="line"><span class="title function_">alert</span>(values); <span class="comment">// 5,4,3,2,1</span></span><br></pre></td></tr></table></figure><h4 id="5-2-sort"><a href="#5-2-sort" class="headerlink" title="5.2 sort()"></a>5.2 sort()</h4><p>sort()方法接受一个比较函数，用于判断哪个值应该排在前面</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">compare</span>(<span class="params">value1, value2</span>) &#123;</span><br><span class="line">    <span class="keyword">if</span> (value1 &lt; value2) &#123;</span><br><span class="line">        <span class="keyword">return</span> -<span class="number">1</span>;</span><br><span class="line">    &#125; <span class="keyword">else</span> <span class="keyword">if</span> (value1 &gt; value2) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">let</span> values = [<span class="number">0</span>, <span class="number">1</span>, <span class="number">5</span>, <span class="number">10</span>, <span class="number">15</span>];</span><br><span class="line">values.<span class="title function_">sort</span>(compare);</span><br><span class="line"><span class="title function_">alert</span>(values); <span class="comment">// 0,1,5,10,15</span></span><br></pre></td></tr></table></figure><h3 id="6-转换方法"><a href="#6-转换方法" class="headerlink" title="6. 转换方法"></a>6. 转换方法</h3><h4 id="6-1-join"><a href="#6-1-join" class="headerlink" title="6.1 join()"></a>6.1 join()</h4><p>join() 方法接收一个参数，即字符串分隔符，返回包含所有项的字符串</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> colors = [<span class="string">&quot;red&quot;</span>, <span class="string">&quot;green&quot;</span>, <span class="string">&quot;blue&quot;</span>];</span><br><span class="line"><span class="title function_">alert</span>(colors.<span class="title function_">join</span>(<span class="string">&quot;,&quot;</span>)); <span class="comment">// red,green,blue</span></span><br><span class="line"><span class="title function_">alert</span>(colors.<span class="title function_">join</span>(<span class="string">&quot;||&quot;</span>)); <span class="comment">// red||green||blue</span></span><br></pre></td></tr></table></figure><h3 id="7-迭代方法"><a href="#7-迭代方法" class="headerlink" title="7.迭代方法"></a>7.迭代方法</h3><h4 id="7-1-some"><a href="#7-1-some" class="headerlink" title="7.1 some()"></a>7.1 some()</h4><p>对数组每一项都运行传入的测试函数，如果至少有1个元素返回 true ，则这个方法返回 true</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> numbers = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">4</span>, <span class="number">3</span>, <span class="number">2</span>, <span class="number">1</span>];</span><br><span class="line"><span class="keyword">let</span> someResult = numbers.<span class="title function_">some</span>(<span class="function">(<span class="params">item, index, array</span>) =&gt;</span> item &gt; <span class="number">2</span>);</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(someResult) <span class="comment">// true</span></span><br></pre></td></tr></table></figure><h4 id="7-2-every"><a href="#7-2-every" class="headerlink" title="7.2 every()"></a>7.2 every()</h4><p>对数组每一项都运行传入的测试函数，如果所有元素都返回 true ，则这个方法返回 true</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> numbers = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">4</span>, <span class="number">3</span>, <span class="number">2</span>, <span class="number">1</span>];</span><br><span class="line"><span class="keyword">let</span> everyResult = numbers.<span class="title function_">every</span>(<span class="function">(<span class="params">item, index, array</span>) =&gt;</span> item &gt; <span class="number">2</span>);</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(everyResult) <span class="comment">// false</span></span><br></pre></td></tr></table></figure><h4 id="7-3-forEach"><a href="#7-3-forEach" class="headerlink" title="7.3 forEach()"></a>7.3 forEach()</h4><p>对数组每一项都运行传入的函数，没有返回值</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> numbers = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">4</span>, <span class="number">3</span>, <span class="number">2</span>, <span class="number">1</span>];</span><br><span class="line"><span class="comment">//第一个参数，就是当前正在遍历的元素</span></span><br><span class="line"><span class="comment">//第二个参数，就是当前正在遍历的元素的索引</span></span><br><span class="line"><span class="comment">//第三个参数，就是当前正在遍历的数组</span></span><br><span class="line">numbers.<span class="title function_">forEach</span>(<span class="function">(<span class="params">item, index, array</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="comment">// 执行某些操作</span></span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(item);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><h4 id="7-4-filter"><a href="#7-4-filter" class="headerlink" title="7.4 filter()"></a>7.4 filter()</h4><p>对数组每一项都运行传入的函数，函数返回 <code>true</code> 的项会组成数组之后返回</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> numbers = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">4</span>, <span class="number">3</span>, <span class="number">2</span>, <span class="number">1</span>];</span><br><span class="line"><span class="keyword">let</span> filterResult = numbers.<span class="title function_">filter</span>(<span class="function">(<span class="params">item, index, array</span>) =&gt;</span> item &gt; <span class="number">2</span>);</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(filterResult); <span class="comment">// 3,4,5,4,3</span></span><br></pre></td></tr></table></figure><h4 id="7-5-map"><a href="#7-5-map" class="headerlink" title="7.5 map()"></a>7.5 map()</h4><p>对数组每一项都运行传入的函数，返回由每次函数调用的结果构成的数组</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> numbers = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">4</span>, <span class="number">3</span>, <span class="number">2</span>, <span class="number">1</span>];</span><br><span class="line"><span class="keyword">let</span> mapResult = numbers.<span class="title function_">map</span>(<span class="function">(<span class="params">item, index, array</span>) =&gt;</span> item * <span class="number">2</span>);</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(mapResult) <span class="comment">// 2,4,6,8,10,8,6,4,2</span></span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> js </category>
          
      </categories>
      
      
        <tags>
            
            <tag> js </tag>
            
            <tag> 面试 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>前端面试知识点（js）01</title>
      <link href="/article/4e578b14.html"/>
      <url>/article/4e578b14.html</url>
      
        <content type="html"><![CDATA[<h3 id="1-typeof-与-instanceof-区别"><a href="#1-typeof-与-instanceof-区别" class="headerlink" title="1. typeof 与 instanceof 区别"></a>1. typeof 与 instanceof 区别</h3><blockquote><p>typeof会返回一个变量的基本类型，<code>instanceof</code>返回的是一个布尔值</p><p>instanceof` 可以准确地判断复杂引用数据类型，但是不能正确判断基础数据类型</p></blockquote><h3 id="2-let-var-const-区别"><a href="#2-let-var-const-区别" class="headerlink" title="2. let  var  const 区别"></a>2. let  var  const 区别</h3><blockquote><p><strong>1.var 声明的变量是存在变量提升的，let ，const声明的变量不存在变量提升。</strong></p><p>变量提升：变量提升是指代码在未定义之前可以使用且不会报错</p><p><strong>2.在同一作用域下var可以重复声明，let，const不可以重复声明。</strong></p><p><strong>3.var声明的变量不存在块级作用域， let，const声明的变量存在块级作用域。</strong></p><p><strong>4.var和let可以重新赋值 ，const声明的是一个常量，const声明的变量必须要进行初始化 不能够重新赋值 。</strong></p><p><strong>5.var声明的变量不存在暂时性死区,let，const声明的变量存在暂时性死区。</strong></p><p>暂时性死区：在变量声明之前,任何的地方都不能去提前使用,一旦使用就会报错,那么这之前的这些代码,对于这个变量来说就是暂时性死区 </p></blockquote><h3 id="3-对作用域的理解"><a href="#3-对作用域的理解" class="headerlink" title="3. 对作用域的理解"></a>3. 对作用域的理解</h3><p>作用域，即变量（变量作用域又称上下文）和函数生效（能被访问）的区域或集合。换句话说，作用域决定了代码区块中变量和其他资源的可见性</p><p><strong>比如：</strong></p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">myFunction</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">let</span> a = <span class="string">&quot;函数内部变量&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="title function_">myFunction</span>();<span class="comment">//要先执行这个函数，否则根本不知道里面是啥</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(inVariable); </span><br></pre></td></tr></table></figure><p>上述例子中，函数 myFunction 内部创建一个 a 变量，当我们在全局访问这个变量的时候，系统会报错。说明我们在全局是无法获取到（闭包除外）函数内部的变量</p><p>从变量查找的范围的角度，js 的作用域可以分为3类：全局作用域、函数作用域和块级作用域。</p><h4 id="3-1-全局作用域"><a href="#3-1-全局作用域" class="headerlink" title="3.1 全局作用域"></a>3.1 全局作用域</h4><p>任何不在函数中或是大括号中声明的变量，都是在全局作用域下，全局作用域下声明的变量可以在程序的任意位置访问</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> a = <span class="string">&#x27;Hello World!&#x27;</span>;</span><br><span class="line"><span class="keyword">function</span> <span class="title function_">my</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(a);</span><br><span class="line">&#125;</span><br><span class="line"><span class="title function_">my</span>();<span class="comment">// 打印 &#x27;Hello World!&#x27;</span></span><br></pre></td></tr></table></figure><h4 id="3-2-局部作用域"><a href="#3-2-局部作用域" class="headerlink" title="3.2 局部作用域"></a>3.2 局部作用域</h4><p>局部作用域也叫函数作用域，如果一个变量是在函数内部声明的它就在一个函数作用域下面。这些变量只能在函数内部访问，不能在函数以外去访问</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">my</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">var</span> a = <span class="string">&#x27;Hello World!&#x27;</span>;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(a);</span><br><span class="line">&#125;</span><br><span class="line"><span class="title function_">greet</span>();<span class="comment">// 打印 &#x27;Hello World!&#x27;</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(a);<span class="comment">// 报错</span></span><br></pre></td></tr></table></figure><h4 id="3-3-块级作用域"><a href="#3-3-块级作用域" class="headerlink" title="3.3 块级作用域"></a>3.3 块级作用域</h4><p>ES6引入了<code>let</code>和<code>const</code>关键字,和<code>var</code>关键字不同，在大括号中使用<code>let</code>和<code>const</code>声明的变量存在于块级作用域中。在大括号之外不能访问这些变量</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="comment">// 块级作用域中的变量</span></span><br><span class="line">  <span class="keyword">let</span> a = <span class="string">&#x27;Hello World!&#x27;</span>;</span><br><span class="line">  <span class="keyword">var</span> b = <span class="string">&#x27;English&#x27;</span>;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(a); <span class="comment">// &#x27;Hello World!&#x27;</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(b);<span class="comment">// 变量 &#x27;English&#x27;</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(a);<span class="comment">// 报错：</span></span><br></pre></td></tr></table></figure><h4 id="3-4-词法作用域"><a href="#3-4-词法作用域" class="headerlink" title="3.4 词法作用域"></a>3.4 词法作用域</h4><p>词法作用域，又叫静态作用域，变量被创建时就确定好了，而非执行阶段确定的。也就是说我们写好代码时它的作用域就确定了，JavaScript 遵循的就是词法作用域</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> a = <span class="number">2</span>;</span><br><span class="line"><span class="keyword">function</span> <span class="title function_">foo</span>(<span class="params"></span>)&#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(a)</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">function</span> <span class="title function_">bar</span>(<span class="params"></span>)&#123;</span><br><span class="line">    <span class="keyword">var</span> a = <span class="number">3</span>;</span><br><span class="line">    <span class="title function_">foo</span>();</span><br><span class="line">&#125;</span><br><span class="line"><span class="title function_">n</span>() <span class="comment">//2</span></span><br></pre></td></tr></table></figure><p>因为 JavaScript 遵循词法作用域，相同层级的 foo 和 bar 就没有办法访问到彼此块作用域中的变量，所以输出2</p><h4 id="3-5-作用域链"><a href="#3-5-作用域链" class="headerlink" title="3.5 作用域链"></a>3.5 作用域链</h4><p>当在 JavaScript 中使用一个变量的时候，首先<code>Javascript</code>引擎会尝试在当前作用域下去寻找该变量，如果没找到，再到它的上层作用域寻找，以此类推直到找到该变量或是已经到了全局作用域。</p><p>如果在全局作用域里仍然找不到该变量，它就会在全局范围内隐式声明该变量(非严格模式下)或是直接报错</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> sex = <span class="string">&#x27;男&#x27;</span>;</span><br><span class="line"><span class="keyword">function</span> <span class="title function_">person</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">var</span> name = <span class="string">&#x27;张三&#x27;</span>;</span><br><span class="line">    <span class="keyword">function</span> <span class="title function_">student</span>(<span class="params"></span>) &#123;</span><br><span class="line">        <span class="keyword">var</span> age = <span class="number">18</span>;</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(name); <span class="comment">// 张三</span></span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(sex); <span class="comment">// 男 </span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="title function_">student</span>();</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(age); <span class="comment">// Uncaught ReferenceError: age is not defined</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="title function_">person</span>();</span><br></pre></td></tr></table></figure><p>上述代码主要主要做了以下工作：</p><p>1.student函数内部属于最内层作用域，找不到name，向上一层作用域 person 函数内部找，找到了输出“张三”</p><p>2.student内部输出cat时找不到，向上一层作用域 person 函数找，还找不到继续向上一层找，即全局作用域，找到了输出“男”</p><p>3.在person函数内部输出age时找不到，向上一层作用域找，即全局作用域，还是找不到则报错</p><h3 id="4-原型和原型链"><a href="#4-原型和原型链" class="headerlink" title="4. 原型和原型链"></a>4. 原型和原型链</h3><p><strong>原型</strong>：函数有原型，函数上有个属性叫 prototype ，函数的这个原型指向一个对象 ，也就是<strong>原型对象</strong> ，这个原型对象有一个 constructor 属性 指向函数本身</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">a</span>(<span class="params"></span>)&#123;&#125;</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>( a.<span class="property"><span class="keyword">prototype</span></span> );</span><br></pre></td></tr></table></figure><p>控制台的输出：</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    <span class="attr">constructor</span>: ƒ <span class="title function_">a</span>(),</span><br><span class="line">    <span class="attr">__proto__</span>: &#123;</span><br><span class="line">        <span class="attr">constructor</span>: ƒ <span class="title class_">Object</span>(),</span><br><span class="line">        <span class="attr">hasOwnProperty</span>: ƒ <span class="title function_">hasOwnProperty</span>(),</span><br><span class="line">        <span class="attr">isPrototypeOf</span>: ƒ <span class="title function_">isPrototypeOf</span>(),</span><br><span class="line">        <span class="attr">propertyIsEnumerable</span>: ƒ <span class="title function_">propertyIsEnumerable</span>(),</span><br><span class="line">        <span class="attr">toLocaleString</span>: ƒ <span class="title function_">toLocaleString</span>(),</span><br><span class="line">        <span class="attr">toString</span>: ƒ <span class="title function_">toString</span>(),</span><br><span class="line">        <span class="attr">valueOf</span>: ƒ <span class="title function_">valueOf</span>()</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>原型链</strong>：每一个实例对象上都有一个<strong>proto</strong>属性，指向构造函数的原型对象，构造函数的原型对象也是一个对象；也有一个<strong>proto属性</strong>，这样一层一层往上找到过程就形成<strong>原型链</strong></p><img src="/article/4e578b14/top01.png" class> <p>当我们访问对象中的属性时候，会先访问该对象中的本身的属性（私有属性），如果访问不到，会查找对象的“proto”指向的构造函数的prototype对象，如果其中有要访问的属性，就使用该值，否则继续访问prototype的“proto”，在其中查找要访问属性。这样一直上溯到Object对象。这个就是“<strong>原型链</strong>”。</p><h3 id="5-防抖与节流"><a href="#5-防抖与节流" class="headerlink" title="5. 防抖与节流"></a>5. 防抖与节流</h3><p>本质上是优化高频率执行代码的一种手段</p><p>如：浏览器的 <code>resize</code>、<code>scroll</code>、<code>keypress</code>、<code>mousemove</code> 等事件在触发时，会不断地调用绑定在事件上的回调函数，极大地浪费资源，降低前端性能</p><p>为了优化体验，需要对这类事件进行调用次数的限制，对此我们就可以采用<code>throttle</code>（防抖）和<code>debounce</code>（节流）的方式来减少调用频率</p><h4 id="5-1-防抖与节流的定义"><a href="#5-1-防抖与节流的定义" class="headerlink" title="5.1 防抖与节流的定义"></a>5.1 防抖与节流的定义</h4><p><strong>节流：</strong>当持续触发事件时，保证在一定时间内只调用一次事件处理函数，意思就是说，假设一个用户一直触发这个函数，且每次触发小于既定值，函数节流会每隔这个时间调用一次</p><p><strong>防抖：</strong>当持续触发事件时，一定时间段内没有再触发事件，事件处理函数才会执行一次，如果设定时间到来之前，又触发了事件，就重新开始延时。也就是说当一个用户一直触发这个函数，且每次触发函数的间隔小于既定时间，那么防抖的情况下只会执行一次。</p><p>用一句话总结防抖和节流的区别：<strong>防抖是将多次执行变为最后一次执行，节流是将多次执行变为每隔一段时间执行</strong></p><h4 id="5-2-节流"><a href="#5-2-节流" class="headerlink" title="5.2 节流"></a>5.2 节流</h4><p><strong>场景：点击按钮重复发送请求：</strong></p><p>项目中点击创建、编辑、删除等按钮都会发送http请求，网络卡顿的情况下点击按钮之后不能快速的响应，一般情况下用户会重复点击按钮，所以会造成<strong>重复发送请求</strong>问题，一定量造成卡顿延迟问题，这个时候便可以采用<strong>节流</strong></p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> throttle = <span class="keyword">function</span>(<span class="params">func, delay</span>) &#123;</span><br><span class="line">    <span class="keyword">var</span> timer = <span class="literal">null</span>; <span class="comment">//定义一个计时器</span></span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">        <span class="keyword">var</span> context = <span class="variable language_">this</span>; <span class="comment">//this指向window</span></span><br><span class="line">        <span class="keyword">var</span> args = <span class="variable language_">arguments</span>; <span class="comment">//</span></span><br><span class="line">        <span class="keyword">if</span> (!timer) &#123;</span><br><span class="line">            timer = <span class="built_in">setTimeout</span>(<span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">                func.<span class="title function_">apply</span>(context, args);</span><br><span class="line">                timer = <span class="literal">null</span>;</span><br><span class="line">            &#125;, delay);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">function</span> <span class="title function_">handle</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="title class_">Math</span>.<span class="title function_">random</span>());</span><br><span class="line">&#125;</span><br><span class="line"><span class="variable language_">window</span>.<span class="title function_">addEventListener</span>(<span class="string">&#x27;scroll&#x27;</span>, <span class="title function_">throttle</span>(handle, <span class="number">1000</span>));</span><br></pre></td></tr></table></figure><h4 id="5-3-防抖"><a href="#5-3-防抖" class="headerlink" title="5.3 防抖"></a>5.3 防抖</h4><p><strong>场景：input事件模糊查询</strong></p><p>input输入框的input事件会在输入框内容发生改变的时候执行，那么就存在一个问题：每次输入，都会触发input事件，执行函数，或者接口请求，而这并不是我们想要的：比如，你想要模糊查询 “liu” 相关的所有数据，而当你在input框中输入 “l” 的时候就已经触发了input事件，去请求了接口，而这并不是我们想要的。所以，我们的防抖函数就登场了；</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">debounce</span>(<span class="params">fn, wait</span>) &#123;</span><br><span class="line">    <span class="keyword">var</span> timeout = <span class="literal">null</span>;      <span class="comment">//定义一个定时器</span></span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">        <span class="keyword">if</span>(timeout !== <span class="literal">null</span>) </span><br><span class="line">                <span class="built_in">clearTimeout</span>(timeout);  <span class="comment">//清除这个定时器</span></span><br><span class="line">        timeout = <span class="built_in">setTimeout</span>(fn, wait);  </span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// 处理函数</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">handle</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="title class_">Math</span>.<span class="title function_">random</span>()); </span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// 滚动事件</span></span><br><span class="line"><span class="variable language_">window</span>.<span class="title function_">addEventListener</span>(<span class="string">&#x27;scroll&#x27;</span>, <span class="title function_">debounce</span>(handle, <span class="number">1000</span>));</span><br></pre></td></tr></table></figure><h3 id="6-JS-数组去重"><a href="#6-JS-数组去重" class="headerlink" title="6. JS 数组去重"></a>6. JS 数组去重</h3><p><strong>Set去重：</strong></p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> arr = [<span class="number">1</span>,<span class="number">2</span>,<span class="number">2</span>,<span class="number">4</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">1</span>,<span class="number">3</span>,<span class="number">2</span>,<span class="number">7</span>,<span class="number">5</span>,<span class="number">6</span>,<span class="number">1</span>]</span><br><span class="line"><span class="keyword">var</span> newArr = <span class="keyword">new</span> <span class="title class_">Set</span>(arr)</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(newArr)</span><br></pre></td></tr></table></figure><p><strong>indexOf去重：</strong></p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 数组去重 </span></span><br><span class="line"><span class="keyword">var</span> arr =  [<span class="number">1</span>,<span class="number">2</span>,<span class="number">2</span>,<span class="number">4</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">1</span>,<span class="number">3</span>,<span class="number">2</span>,<span class="number">7</span>,<span class="number">5</span>,<span class="number">6</span>,<span class="number">1</span>]</span><br><span class="line"><span class="keyword">function</span> <span class="title function_">fn</span>(<span class="params">arr</span>)&#123; </span><br><span class="line"><span class="keyword">let</span> newArr = [] ;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">let</span> i = <span class="number">0</span>;i&lt;arr.<span class="property">length</span>;i++)&#123;</span><br><span class="line">        <span class="comment">//判断新数组是否存在当前元素arr[i]</span></span><br><span class="line">        <span class="keyword">if</span>(newArr.<span class="title function_">indexOf</span>(arr[i]) === -<span class="number">1</span>)&#123;</span><br><span class="line">            <span class="comment">//元素不存在</span></span><br><span class="line">            newArr.<span class="title function_">push</span>(arr[i])</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> newArr;</span><br><span class="line">&#125;</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="title function_">fn</span>(arr))</span><br></pre></td></tr></table></figure><h3 id="7-this指向问题"><a href="#7-this指向问题" class="headerlink" title="7. this指向问题"></a>7. this指向问题</h3><h4 id="1-全局作用域或者普通函数中-this-指向全局对象-window。"><a href="#1-全局作用域或者普通函数中-this-指向全局对象-window。" class="headerlink" title="1.全局作用域或者普通函数中 this 指向全局对象 window。"></a>1.全局作用域或者普通函数中 this 指向全局对象 window。</h4><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//直接打印</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="variable language_">this</span>) <span class="comment">//window</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//function声明函数</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">a</span>(<span class="params"></span>) &#123;<span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="variable language_">this</span>)&#125;</span><br><span class="line"><span class="title function_">a</span>() <span class="comment">//window</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//function声明函数赋给变量</span></span><br><span class="line"><span class="keyword">var</span> bar = <span class="keyword">function</span> (<span class="params"></span>) &#123;<span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="variable language_">this</span>)&#125;</span><br><span class="line"><span class="title function_">bar</span>() <span class="comment">//window</span></span><br></pre></td></tr></table></figure><h4 id="2-方法调用中谁调用-this-指向谁"><a href="#2-方法调用中谁调用-this-指向谁" class="headerlink" title="2. 方法调用中谁调用 this 指向谁"></a>2. 方法调用中谁调用 this 指向谁</h4><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//对象方法调用</span></span><br><span class="line"><span class="keyword">var</span> a = &#123;</span><br><span class="line">  <span class="attr">run</span>: <span class="keyword">function</span> (<span class="params"></span>) &#123;<span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="variable language_">this</span>)&#125;</span><br><span class="line">&#125;</span><br><span class="line">a.<span class="title function_">run</span>() <span class="comment">// a</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//事件绑定</span></span><br><span class="line"><span class="keyword">var</span> btn = <span class="variable language_">document</span>.<span class="title function_">querySelector</span>(<span class="string">&quot;button&quot;</span>)</span><br><span class="line">btn.<span class="property">onclick</span> = <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="variable language_">this</span>) <span class="comment">// btn</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//事件监听</span></span><br><span class="line"><span class="keyword">var</span> btn = <span class="variable language_">document</span>.<span class="title function_">querySelector</span>(<span class="string">&quot;button&quot;</span>)</span><br><span class="line">btn.<span class="title function_">addEventListener</span>(<span class="string">&#x27;click&#x27;</span>, <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="variable language_">this</span>) <span class="comment">//btn</span></span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><h4 id="3-在构造函数或者构造函数原型对象中-this-指向构造函数的实例"><a href="#3-在构造函数或者构造函数原型对象中-this-指向构造函数的实例" class="headerlink" title="3. 在构造函数或者构造函数原型对象中 this 指向构造函数的实例"></a>3. 在构造函数或者构造函数原型对象中 this 指向构造函数的实例</h4><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//不使用new指向window</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">a</span>(<span class="params">name</span>) &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="variable language_">this</span>) <span class="comment">// window</span></span><br><span class="line">  <span class="variable language_">this</span>.<span class="property">name</span> = name;</span><br><span class="line">&#125;</span><br><span class="line"><span class="title function_">a</span>(<span class="string">&#x27;111&#x27;</span>)</span><br><span class="line"><span class="comment">//使用new</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">a</span>(<span class="params">name</span>) &#123;</span><br><span class="line">  <span class="variable language_">this</span>.<span class="property">name</span> = name</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="variable language_">this</span>) <span class="comment">//people</span></span><br><span class="line">  self = <span class="variable language_">this</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//这里new改变了this指向，将this由window指向Person的实例对象people</span></span><br><span class="line"><span class="keyword">var</span> people = <span class="keyword">new</span> <span class="title class_">Person</span>(<span class="string">&#x27;iwen&#x27;</span>)</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(self === people) <span class="comment">//true</span></span><br></pre></td></tr></table></figure><h4 id="4-箭头函数中指向外层作用域的-this"><a href="#4-箭头函数中指向外层作用域的-this" class="headerlink" title="4. 箭头函数中指向外层作用域的 this"></a>4. 箭头函数中指向外层作用域的 this</h4><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> obj = &#123;</span><br><span class="line">  <span class="title function_">foo</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="variable language_">this</span>);</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="attr">bar</span>: <span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="variable language_">this</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">obj.<span class="title function_">foo</span>() <span class="comment">// &#123;foo: ƒ, bar: ƒ&#125;</span></span><br><span class="line">obj.<span class="title function_">bar</span>() <span class="comment">// window</span></span><br></pre></td></tr></table></figure><h3 id="8-箭头函数和普通函数有什么区别"><a href="#8-箭头函数和普通函数有什么区别" class="headerlink" title="8.箭头函数和普通函数有什么区别"></a>8.箭头函数和普通函数有什么区别</h3><p><strong>区别：</strong></p><blockquote><p>箭头函数在一些情况下书写更简洁（如只有一个参数、函数体直接返回值时候）。</p><p>箭头函数没有自己的this，箭头函数内的this变量指向外层非箭头函数的函数的this，或者将该箭头函数作为属性的对象。箭头函数也不支持call()和apply()函数特性。</p><p>箭头函数内部不可以使用arguments对象。</p><p>箭头函数不可以当做构造函数。</p></blockquote>]]></content>
      
      
      <categories>
          
          <category> js </category>
          
      </categories>
      
      
        <tags>
            
            <tag> js </tag>
            
            <tag> 面试 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>浅谈BFC</title>
      <link href="/article/f03f69b2.html"/>
      <url>/article/f03f69b2.html</url>
      
        <content type="html"><![CDATA[<h3 id="1-BFC的定义"><a href="#1-BFC的定义" class="headerlink" title="1. BFC的定义"></a>1. BFC的定义</h3><p>BFC - Block Formatting Context 块级格式化上下文 BFC的定义，在官方文档到中，是这么介绍BFC的。</p><blockquote><p>A block formatting context contains everything inside of the element creating it that is not also inside a descendant element that creates a new block formatting context.</p></blockquote><p>翻译过来便是：一个BFC区域包含创建该上下文元素的所有子元素，但是不包括创建了新的BFC的子元素的内部元素。</p><p><strong>比如：</strong></p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;box1&quot;</span> <span class="attr">id</span>=<span class="string">&quot;bfc1&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;box2&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;box3&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;box4&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;box5&quot;</span> <span class="attr">id</span>=<span class="string">&quot;bfc2&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;box6&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;box7&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;box8&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure><p>以上面这段代码来解释，#bfc1是一块 BFC 区域，这块区域包括了box2、box3、box4、box5，但是并不包括box5下的子元素box6、box7、box8。而#bfc2也是一块 BFC 区域，包括了box6、box7、box8。所以，<strong>每一个BFC区域只包括其子元素，不包括其子元素的子元素。</strong></p><h3 id="2-BFC的触发条件"><a href="#2-BFC的触发条件" class="headerlink" title="2. BFC的触发条件"></a>2. BFC的触发条件</h3><p>并不是任意一个元素都可以被当做BFC，只有当这个元素满足以下任意一个条件的时候，这个元素才会被当做一个BFC。</p><blockquote><p>body根元素</p><p>设置浮动，不包括none</p><p>设置定位，absoulte或者fixed</p><p>行内块显示模式，inline-block</p><p>设置overflow，即hidden，auto，scroll</p><p>表格单元格，table-cell</p><p>弹性布局，flex</p></blockquote><p><strong>比如：</strong></p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;box1&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;box2&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;box3&quot;</span> <span class="attr">id</span>=<span class="string">&quot;bfc&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;box4&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;box5&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br></pre></td></tr></table></figure><p>首先，以上的代码中，body元素是一个BFC，因为他满足BFC的第一个触发条件（body根元素）。但是#bfc并不是一个BFC区域，因为他并没有满足任何一个触发条件。如果我们要使他变为一个BFC区域，让其满足任意一个触发条件即可。</p><p><strong>比如：</strong></p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&lt;style&gt;</span><br><span class="line"><span class="selector-id">#bfc</span>&#123;</span><br><span class="line"><span class="attribute">overflow</span>: hidden;</span><br><span class="line">&#125;</span><br><span class="line">&lt;/style&gt;</span><br></pre></td></tr></table></figure><p>当#bfc元素设置为 overflow: hidden 后，满足触发条件，此时#bfc就是一个BFC区域，这个BFC区域包括box4和box5。</p><h3 id="3-BFC解决问题"><a href="#3-BFC解决问题" class="headerlink" title="3. BFC解决问题"></a>3. BFC解决问题</h3><p>理解了BFC的触发条件后，就需要使用BFC的特点来解决布局时遇到的问题了。</p><p>首先要明白BFC有一个特点：<strong>每一个BFC区域都是相互独立，互不影响的。</strong></p><h4 id="3-1-解决外边距的塌陷问题"><a href="#3-1-解决外边距的塌陷问题" class="headerlink" title="3.1 解决外边距的塌陷问题"></a>3.1 <strong>解决外边距的塌陷问题</strong></h4><p>我们设置两个class值为box的div盒子，并把他的margin设置为100px</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;box&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;box&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br></pre></td></tr></table></figure><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">&lt;style&gt;</span><br><span class="line"><span class="selector-class">.box</span> &#123;</span><br><span class="line"><span class="attribute">width</span>: <span class="number">200px</span>;</span><br><span class="line"><span class="attribute">height</span>: <span class="number">200px</span>;</span><br><span class="line"><span class="attribute">background-color</span>: red;</span><br><span class="line"><span class="attribute">margin</span>: <span class="number">100px</span>;</span><br><span class="line">&#125;</span><br><span class="line">&lt;/style&gt;</span><br></pre></td></tr></table></figure><p>这时你会发现，我们对.box设置了四个方向的margin，都为100px。那么上一个盒子和下一个盒子之间的距离应该是 100px+100px=200px。但事实并非如此，上下两个盒子之间的距离只有100px。</p><img src="/article/f03f69b2/tp001.png" class> <p>这就是margin的塌陷，两段margin重叠到了一块，互相影响。那么要解决这个问题，就要用到BFC的特点：<strong>每一个BFC区域都是相互独立，互不影响的。</strong>所以，我们可以将这两个盒子放到两个BFC区域中</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;bfc&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;box&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;bfc&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;box&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br></pre></td></tr></table></figure><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">&lt;style&gt;</span><br><span class="line"><span class="selector-class">.box</span> &#123;</span><br><span class="line"><span class="attribute">width</span>: <span class="number">200px</span>;</span><br><span class="line"><span class="attribute">height</span>: <span class="number">200px</span>;</span><br><span class="line"><span class="attribute">background-color</span>: red;</span><br><span class="line"><span class="attribute">margin</span>: <span class="number">100px</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.bfc</span>&#123;</span><br><span class="line"><span class="attribute">overflow</span>: hidden;</span><br><span class="line">&#125;</span><br><span class="line">&lt;/style&gt;</span><br></pre></td></tr></table></figure><h4 id="3-2-利用BFC解决包含塌陷"><a href="#3-2-利用BFC解决包含塌陷" class="headerlink" title="3.2 利用BFC解决包含塌陷"></a>3.2 <strong>利用BFC解决包含塌陷</strong></h4><p>当一个父子关系的盒子，给子元素添加margin-top，会带着父元素盒子一起</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;father&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;son&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br></pre></td></tr></table></figure><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">&lt;style&gt;</span><br><span class="line"><span class="selector-class">.father</span> &#123;</span><br><span class="line"><span class="attribute">width</span>: <span class="number">300px</span>;</span><br><span class="line"><span class="attribute">height</span>: <span class="number">300px</span>;</span><br><span class="line"><span class="attribute">background-color</span>: red;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.son</span>&#123;</span><br><span class="line"><span class="attribute">width</span>: <span class="number">100px</span>;</span><br><span class="line"><span class="attribute">height</span>: <span class="number">100px</span>;</span><br><span class="line"><span class="attribute">background-color</span>: gold;</span><br><span class="line"><span class="attribute">margin-top</span>: <span class="number">50px</span>;</span><br><span class="line">&#125;</span><br><span class="line">&lt;/style&gt;</span><br></pre></td></tr></table></figure><p>原本是子元素盒子与父元素盒子顶部距离50px，由于margin塌陷问题，导致盒子的内部布局影响到了外部。</p><img src="/article/f03f69b2/tp002.png" class> <p>这时候，我们可以通过触发BFC，把父元素盒子变为一个BFC区域，由于BFC的特点：<strong>每一个BFC区域都是相互独立，互不影响的。</strong> 外面的父元素BFC区域影响不了bodyBFC区域，就不会改变外部布局了。</p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-class">.father</span> &#123;</span><br><span class="line"><span class="attribute">width</span>: <span class="number">300px</span>;</span><br><span class="line"><span class="attribute">height</span>: <span class="number">300px</span>;</span><br><span class="line"><span class="attribute">background-color</span>: red;</span><br><span class="line"><span class="attribute">overflow</span>: hidden;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="3-3-当浮动产生影响的时候，可以利用BFC来清除浮动的影响"><a href="#3-3-当浮动产生影响的时候，可以利用BFC来清除浮动的影响" class="headerlink" title="3.3 当浮动产生影响的时候，可以利用BFC来清除浮动的影响"></a>3.3 当浮动产生影响的时候，可以利用BFC来清除浮动的影响</h4><p>设置一个没有设高度的父元素盒子，包含6个子元素</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;father&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;son&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;son&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;son&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;son&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;son&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;son&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br></pre></td></tr></table></figure><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">&lt;style&gt;</span><br><span class="line"><span class="selector-class">.father</span> &#123;</span><br><span class="line"><span class="attribute">width</span>: <span class="number">300px</span>;</span><br><span class="line"><span class="attribute">background-color</span>: red;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.son</span>&#123;</span><br><span class="line"><span class="attribute">width</span>: <span class="number">100px</span>;</span><br><span class="line"><span class="attribute">height</span>: <span class="number">30px</span>;</span><br><span class="line"><span class="attribute">background-color</span>: gold;</span><br><span class="line"><span class="attribute">border</span>: <span class="number">1px</span> solid greenyellow;</span><br><span class="line">&#125;</span><br><span class="line">&lt;/style&gt;</span><br></pre></td></tr></table></figure><img src="/article/f03f69b2/tp003.png" class> <p>当给所以子元素都设置浮动后，父元素就会失去原有的高度</p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-class">.son</span>&#123;</span><br><span class="line"><span class="attribute">width</span>: <span class="number">100px</span>;</span><br><span class="line"><span class="attribute">height</span>: <span class="number">30px</span>;</span><br><span class="line"><span class="attribute">background-color</span>: gold;</span><br><span class="line"><span class="attribute">border</span>: <span class="number">1px</span> solid greenyellow;</span><br><span class="line">    <span class="attribute">float</span>: left;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><img src="/article/f03f69b2/tp004.png" class> <p>所以，我们可以触发BFC，来清除浮动带来的影响</p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-class">.father</span> &#123;</span><br><span class="line"><span class="attribute">width</span>: <span class="number">300px</span>;</span><br><span class="line"><span class="attribute">background-color</span>: red;</span><br><span class="line"><span class="attribute">overflow</span>: hidden;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><img src="/article/f03f69b2/tp005.png" class> <h4 id="3-4-BFC可以阻止标准流元素被浮动元素覆盖"><a href="#3-4-BFC可以阻止标准流元素被浮动元素覆盖" class="headerlink" title="3.4 BFC可以阻止标准流元素被浮动元素覆盖"></a>3.4 BFC可以阻止标准流元素被浮动元素覆盖</h4><p>设置红色盒子浮动，蓝色盒子标准流</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;red&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;blue&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br></pre></td></tr></table></figure><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">&lt;style&gt;</span><br><span class="line"><span class="selector-class">.red</span> &#123;</span><br><span class="line"><span class="attribute">width</span>: <span class="number">200px</span>;</span><br><span class="line"><span class="attribute">height</span>: <span class="number">200px</span>;</span><br><span class="line"><span class="attribute">background-color</span>: red;</span><br><span class="line"><span class="attribute">float</span>: left;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.blue</span>&#123;</span><br><span class="line"><span class="attribute">height</span>: <span class="number">300px</span>;</span><br><span class="line"><span class="attribute">background-color</span>: blue;</span><br><span class="line">&#125;</span><br><span class="line">&lt;/style&gt;</span><br></pre></td></tr></table></figure><p>可以看到，红色盒子浮动覆盖了蓝色盒子</p><img src="/article/f03f69b2/tp006.png" class> <p>但是如果蓝色盒子触发了BFC</p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-class">.blue</span>&#123;</span><br><span class="line"><span class="attribute">height</span>: <span class="number">300px</span>;</span><br><span class="line"><span class="attribute">background-color</span>: blue;</span><br><span class="line"><span class="attribute">overflow</span>: hidden;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><img src="/article/f03f69b2/tp007.png" class> <p>可以看到，蓝色盒子触发了BFC后，浮动元素无法覆盖蓝色盒子了，并且我们还可以利用这个特性来实现蓝色盒子的自适应功能。</p><h3 id="4-总结"><a href="#4-总结" class="headerlink" title="4. 总结"></a>4. 总结</h3><p><strong>一个BFC区域只包含其子元素，不包括其子元素的子元素。</strong></p><p><strong>并不是所有的元素都能成为一块BFC区域，只有当这个元素满足条件的时候才会成为一块BFC区域。</strong></p><p><strong>不同的BFC区域之间是相互独立的，互不影响的。利用这个特性我们可以让不同BFC区域之间的布局不产生影响。</strong></p>]]></content>
      
      
      <categories>
          
          <category> Html+CSS </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Html+CSS </tag>
            
            <tag> 面试 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>前端面试知识点（css）</title>
      <link href="/article/f28d6656.html"/>
      <url>/article/f28d6656.html</url>
      
        <content type="html"><![CDATA[<h3 id="1-display：none与visibility-hidden区别"><a href="#1-display：none与visibility-hidden区别" class="headerlink" title="1.display：none与visibility:hidden区别"></a>1.display：none与visibility:hidden区别</h3><p><strong>题目：</strong>display：none与visibility:hidden区别？</p><blockquote><p><strong>答案：</strong>display: none不占据空间，即不在文档流中，而visibility:hidden还在文档流中。</p><p>display: none子元素不可见。visibility:hidden的子元素如果设置visibility:visible则还可以看到。</p></blockquote><h3 id="2-隐藏元素的方法"><a href="#2-隐藏元素的方法" class="headerlink" title="2.隐藏元素的方法"></a>2.隐藏元素的方法</h3><p><strong>题目：</strong>有哪些隐藏元素的方法？</p><blockquote><p><strong>答案：</strong>display: none  ;  visibility: hidden  ;  opacity: 0  ;</p><p>也可以用left: -9999px或者transform: translateX(-9999px);将元素移出视口外部。</p></blockquote><h3 id="3-css画三角形"><a href="#3-css画三角形" class="headerlink" title="3.css画三角形"></a>3.css画三角形</h3><p><strong>题目：</strong>使用css画一个三角形</p><p><strong>答案：</strong></p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span>  </span><br><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span>  </span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span>  </span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>test<span class="tag">&lt;/<span class="name">title</span>&gt;</span>  </span><br><span class="line">    <span class="tag">&lt;<span class="name">style</span> <span class="attr">type</span>=<span class="string">&quot;text/css&quot;</span>&gt;</span><span class="language-css">  </span></span><br><span class="line"><span class="language-css">        <span class="selector-id">#triangle</span> &#123;  </span></span><br><span class="line"><span class="language-css">            <span class="comment">/*1.内容区面积为0*/</span>  </span></span><br><span class="line"><span class="language-css">            <span class="attribute">width</span>: <span class="number">0</span>;  </span></span><br><span class="line"><span class="language-css">            <span class="attribute">height</span>: <span class="number">0</span>;  </span></span><br><span class="line"><span class="language-css">            <span class="comment">/*2.设置边框样式*/</span>  </span></span><br><span class="line"><span class="language-css">            <span class="attribute">border</span>: <span class="number">10px</span> solid;  </span></span><br><span class="line"><span class="language-css">            <span class="attribute">border-color</span>: white white red white;  </span></span><br><span class="line"><span class="language-css">        &#125;  </span></span><br><span class="line"><span class="language-css">    </span><span class="tag">&lt;/<span class="name">style</span>&gt;</span>  </span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span>  </span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span>  </span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;triangle&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span>  </span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span>  </span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure><h3 id="4-盒模型"><a href="#4-盒模型" class="headerlink" title="4.盒模型"></a>4.盒模型</h3><p><strong>题目：</strong>介绍下css的盒模型。</p><p>标准盒模型和怪异盒模型是什么？</p><p>ie 盒模型和 w3c 盒模型的区别 如何使用ie的盒模型</p><blockquote><p><strong>答案：</strong>CSS把每个元素视为一个盒子，每个盒子包括分为内容（content）、填充（padding）、外边界区（margin）、边框区（border）四个部分。这种对界面元素的抽象，称为盒模型。</p><p>有两种盒模型：IE盒模型（也称怪异盒模型）（border-box）、W3C标准盒模型（content-box）</p><p>IE盒模型和W3C标准盒模型的区别：</p><p>W3C标准盒模型：属性width，height只包含内容content，不包含border和padding。</p><p>W3C标准盒模型元素宽度实际占有的位置大小：width+左右padding+左右border+左右margin</p><p>IE盒模型：属性width，height包含content、border和padding，指的是content +padding+border。</p><p>IE盒模型元素的宽度：width（content+border+padding）+margin</p></blockquote><h3 id="5-盒模型盒子的宽度计算"><a href="#5-盒模型盒子的宽度计算" class="headerlink" title="5. 盒模型盒子的宽度计算"></a>5. 盒模型盒子的宽度计算</h3><p><strong>题目：</strong>一个盒子，宽度设为100px，padding设为100px，整个在页面占多少px？</p><blockquote><p><strong>答案：</strong>盒子宽度 = width + padding + border + marign。</p><p>由于padding包括padding-left和padding-right，</p><p>所以这个盒子水平占据100px + 100px*2 +0 +0 = 300px</p></blockquote><h3 id="6-两种盒模型对比"><a href="#6-两种盒模型对比" class="headerlink" title="6.两种盒模型对比"></a>6.两种盒模型对比</h3><p><strong>题目：</strong>在两种盒模型下获取div的宽度分别是多少？</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">style</span>=<span class="string">&quot;width: 200px;padding: 10px;margin: 20px&quot;</span>&gt;</span><span class="tag">&lt;<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure><blockquote><p><strong>答案：</strong>div的宽度指通过div.clientWidth获取的宽度，这个宽度包括content、padding和border。</p><p>标准盒模width指的是content的宽度，因此获取的宽度为200px + 10 × 2 = 220px。</p><p>怪异盒模型width包括content、border和padding，因此width是200px。</p></blockquote><h3 id="7-有哪些CSS选择器"><a href="#7-有哪些CSS选择器" class="headerlink" title="7.有哪些CSS选择器"></a>7.有哪些CSS选择器</h3><p><strong>题目：</strong>介绍一下都有哪些CSS选择器。</p><blockquote><p><strong>答案：</strong></p><p>1、id选择器（#id）</p><p>2、类选择器（.name）</p><p>3、标签选择器（div,h1,p）</p><p>4、后代选择器（h1 p）后代选择器的祖先和后代之间用空格分割</p><p>5、相邻后代选择器（子）选择器（ul&gt;li）</p><p>6、兄弟选择器（li~a）</p><p>7、相邻兄弟选择器（li+a）</p><p>8、属性选择器（a[rel=”external”]）</p><p>9、伪类选择器（a:hover,li:nth-child）</p><p>10、伪元素选择器（::before、 ::after）</p><p>11、通配符选择器（*）</p></blockquote><h3 id="8-CSS样式优先级"><a href="#8-CSS样式优先级" class="headerlink" title="8.CSS样式优先级"></a>8.CSS样式优先级</h3><p><strong>题目：</strong>说一下CSS优先级的计算规则？</p><blockquote><p><strong>答案：</strong>CSS规范为不同类型的<a href="https://so.csdn.net/so/search?q=%E9%80%89%E6%8B%A9%E5%99%A8&spm=1001.2101.3001.7020">选择器</a>定义了特殊性权重，特殊性权重越高，样式会被优先应用。</p><p>第一等级：代表 内联样式，如 style=””，权值为 1,0,0,0；</p><p>第二等级：代表 ID选择器，如 #id=””, 权值为 0,1,0,0；</p><p>第三等级：代表 calss | 伪类 | 属性 选择器，如 .class | :hover,:link,:target | [type], 权值 为0,0,1,0；</p><p>第四等级：代表 标签 | 伪元素 选择器，如 p | ::after, ::before, ::fist-inline, ::selection, 权值 为0,0,0,1；</p><p>此外，通用选择器（*），子选择器（&gt;）， 相邻同胞选择器（+）等选择器不在4等级之内，所以它们的权值都为 0,0,0,0；</p><p>对于每条CSS规则，生成一个优先级四元组&lt;内联,ID,Class|属性|伪类,元素选择器&gt;。</p><p>每一位的数值计算方法是，在规则中选择器出现的个数。</p><p>两条规则之间对比，从左到右对比，数值大的规则优先级高。</p><p>如果某一位相同，对比下一位。</p></blockquote><h3 id="9-css优先级计算"><a href="#9-css优先级计算" class="headerlink" title="9.css优先级计算"></a>9.css优先级计算</h3><p><strong>题目：</strong>判断以下选择器优先级顺序</p><p>1、#foo div</p><p>2、#foo .bar div</p><p>3、#foo~.bar div</p><blockquote><p><strong>答案：</strong>根据知识点中介绍，这3个选择器优先级计算结果为：</p><p>0,1,0,1</p><p>0,1,1,1</p><p>0,1,1,1</p><p>后两个优先级计算结果相同，则后出现的优先级更高</p></blockquote><h3 id="10-div-div-div-div-gt-div-gt-div优先级"><a href="#10-div-div-div-div-gt-div-gt-div优先级" class="headerlink" title="10.div .div #div div&gt;div&gt;div优先级"></a>10.div .div #div div&gt;div&gt;div优先级</h3><p><strong>题目：</strong>div, .div, #div, div&gt;div&gt;div这几个选择器优先级排序？</p><blockquote><p><strong>答案：</strong>根据知识点中介绍，这4个选择器优先级计算结果为：</p><p>① 0,0,0,1</p><p>② 0,0,1,0</p><p>③ 0,1,0,0</p><p>④ 0,0,0,3</p><p>因此优先级排序为③, ②, ④, ①</p></blockquote><h3 id="11-为什么不推荐用多层css选择器"><a href="#11-为什么不推荐用多层css选择器" class="headerlink" title="11.为什么不推荐用多层css选择器"></a>11.为什么不推荐用多层css选择器</h3><p><strong>题目：</strong>为什么不推荐用多层css选择器？</p><blockquote><p><strong>答案：</strong>由于选择器的匹配需要在整个DOM树中查找节点，层级越高性能越低，因此不建议CSS选择器层级太多。</p></blockquote><h3 id="12-css选择器处理"><a href="#12-css选择器处理" class="headerlink" title="12.css选择器处理"></a>12.css选择器处理</h3><p><strong>题目：</strong>div .child p是是从左边往右边开始定位还是从右边往左边开始？为什么？</p><blockquote><p><strong>答案：</strong>当存在后代选择器时候，CSS选择器的匹配是从右往左的，原因是从左往右匹配的话，需要遍历DOM树，可能会有多次回溯，而从右往左的话，先匹配所有的子节点选择器，然后向上查找，这样性能更好。</p></blockquote><h3 id="13-css居中"><a href="#13-css居中" class="headerlink" title="13.css居中"></a>13.css居中</h3><p><strong>题目：</strong>css如何水平居中和垂直居中？</p><p><strong>实例：</strong></p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;parent&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;child&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-class">.parent</span> &#123;</span><br><span class="line">    <span class="attribute">width</span>: <span class="number">200px</span>;</span><br><span class="line">    <span class="attribute">height</span>: <span class="number">100px</span>;</span><br><span class="line">    <span class="attribute">position</span>: relative;</span><br><span class="line">    <span class="attribute">background-color</span>: <span class="number">#374858</span>;</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"><span class="selector-class">.parent</span> <span class="selector-class">.child</span> &#123;</span><br><span class="line">    <span class="attribute">width</span>: <span class="number">100px</span>;</span><br><span class="line">    <span class="attribute">height</span>: <span class="number">50px</span>;</span><br><span class="line">    <span class="attribute">background-color</span>: red;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="13-1-水平居中"><a href="#13-1-水平居中" class="headerlink" title="13.1 水平居中"></a>13.1 水平居中</h4><p>设置子元素为内联样式，只需要父元素设置为 text-align: center。</p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-class">.box</span> &#123;</span><br><span class="line">    <span class="attribute">text-align</span>: center;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.box</span> <span class="selector-class">.child</span> &#123;</span><br><span class="line">    <span class="attribute">display</span>: inline-block;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>当子元素和父元素都为块级元素时，只需要设置子元素(子元素需要有width)为 margin:0  auto</p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-class">.box</span> &#123;&#125;</span><br><span class="line"> </span><br><span class="line"><span class="selector-class">.box</span> <span class="selector-class">.child</span> &#123;</span><br><span class="line"><span class="attribute">display</span>: block;</span><br><span class="line"><span class="attribute">margin</span>: <span class="number">0</span> auto;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>子元素设置为 position:absolute</p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-class">.box</span> &#123;&#125;</span><br><span class="line"> </span><br><span class="line"><span class="selector-class">.box</span> <span class="selector-class">.child</span> &#123;</span><br><span class="line"><span class="attribute">position</span>: absolute;</span><br><span class="line"><span class="attribute">left</span>: <span class="number">0</span>;</span><br><span class="line"><span class="attribute">top</span>:<span class="number">0</span>;</span><br><span class="line"><span class="attribute">transform</span>: <span class="built_in">translate</span>(<span class="number">50%</span>, <span class="number">0</span>);</span><br><span class="line">&#125;</span><br><span class="line">//或者</span><br><span class="line"><span class="selector-class">.box</span> <span class="selector-class">.child</span> &#123;</span><br><span class="line"><span class="attribute">position</span>: absolute;</span><br><span class="line"><span class="attribute">left</span>: <span class="number">50%</span>;</span><br><span class="line"><span class="attribute">transform</span>: <span class="built_in">translate</span>(-<span class="number">50%</span>, <span class="number">0</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>父元素设置为 display:flex，子元素可为内联、块级元素</p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-class">.box</span> &#123;</span><br><span class="line"><span class="attribute">display</span>: flex;</span><br><span class="line"><span class="attribute">justify-content</span>: center;</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"><span class="selector-class">.child</span> &#123;</span><br><span class="line"> <span class="attribute">display</span>: inline-block;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="13-2-垂直居中"><a href="#13-2-垂直居中" class="headerlink" title="13.2 垂直居中"></a>13.2 垂直居中</h4><p>子元素 position: absolute</p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-class">.box</span> &#123;&#125;</span><br><span class="line"> </span><br><span class="line"><span class="selector-class">.box</span> <span class="selector-class">.child</span> &#123;</span><br><span class="line">    <span class="attribute">position</span>: absolute;</span><br><span class="line">    <span class="attribute">top</span>: <span class="number">50%</span>;</span><br><span class="line">    <span class="attribute">transform</span>: <span class="built_in">translate</span>(<span class="number">0</span>, -<span class="number">50%</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>父元素 display:flex，子元素可为内联、块级元素</p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-class">.box</span> &#123;</span><br><span class="line">    <span class="attribute">display</span>: flex;</span><br><span class="line">    <span class="attribute">align-items</span>: center;</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"><span class="selector-class">.box</span> <span class="selector-class">.child</span> &#123;</span><br><span class="line">    <span class="attribute">display</span>: inline-block;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="13-3-水平居中-垂直居中"><a href="#13-3-水平居中-垂直居中" class="headerlink" title="13.3 水平居中+垂直居中"></a>13.3 水平居中+垂直居中</h4><p>子元素 display: inline-block，子元素需要有width和height</p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-class">.box</span> &#123;</span><br><span class="line"><span class="attribute">text-align</span>: center;</span><br><span class="line"><span class="comment">/* 让标签元素以表格单元格的形式呈现 */</span></span><br><span class="line"><span class="attribute">display</span>: table-cell;</span><br><span class="line">//设置元素的垂直排列</span><br><span class="line"><span class="attribute">vertical-align</span>: middle;</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"><span class="selector-class">.box</span> <span class="selector-class">.child</span> &#123;</span><br><span class="line"><span class="attribute">display</span>: inline-block;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>子元素 position: absolute</p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-class">.box</span> &#123;</span><br><span class="line"><span class="attribute">position</span>: relative;</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"><span class="selector-class">.box</span> <span class="selector-class">.child</span> &#123;</span><br><span class="line"><span class="attribute">position</span>: absolute;</span><br><span class="line"><span class="attribute">left</span>: <span class="number">50%</span>;</span><br><span class="line"><span class="attribute">top</span>: <span class="number">50%</span>;</span><br><span class="line"><span class="attribute">transform</span>: <span class="built_in">translate</span>(-<span class="number">50%</span>, -<span class="number">50%</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>父元素 display: flex</p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-class">.box</span> &#123;</span><br><span class="line">    <span class="attribute">display</span>: flex;</span><br><span class="line">    <span class="attribute">justify-content</span>: center;</span><br><span class="line">    <span class="attribute">align-items</span>: center;</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"><span class="selector-class">.box</span> <span class="selector-class">.child</span> &#123;&#125;</span><br></pre></td></tr></table></figure><h3 id="14-如何清除浮动"><a href="#14-如何清除浮动" class="headerlink" title="14.如何清除浮动"></a>14.如何清除浮动</h3><p><strong>题目：</strong>为什么需要清除浮动？</p><p>如何清除浮动？</p><p>clear为什么能清除浮动？</p><p>overflow: hidden为什么能清除浮动？</p><blockquote><p><strong>答案：</strong>浮动的元素会造成父元素高度塌陷，因此需要清除浮动。</p><p>有3种办法：1. 在浮动元素后面增加一个元素，设置clear: both；2. 父元素设置伪元素，给伪元素设置clear: both；3. 父元素设置overflow: hidden。</p><p>设置clear的元素不受前面浮动元素影响，位置会放在浮动元素后面，因此可以把父元素撑开。</p><p>overflow: hidden让父元素形成一个BFC，所以可以清除浮动。</p></blockquote><h3 id="15-block、inline和inline-block的元素有什么差别"><a href="#15-block、inline和inline-block的元素有什么差别" class="headerlink" title="15.block、inline和inline-block的元素有什么差别"></a>15.block、inline和inline-block的元素有什么差别</h3><p><strong>题目：</strong>block、inline和inline-block的元素有什么差别</p><blockquote><p><strong>答案：</strong>block   块类型。默认宽度为父元素宽度，可设置宽高，换行显示。</p><p>inline  行内元素类型。默认宽度为内容宽度，不可设置宽高，同行显示。</p><p>inline-block 默认宽度为内容宽度，可以设置宽高，同行显示。</p></blockquote>]]></content>
      
      
      <categories>
          
          <category> Html+CSS </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Html+CSS </tag>
            
            <tag> 面试 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>浅谈浅拷贝和深拷贝</title>
      <link href="/article/47599914.html"/>
      <url>/article/47599914.html</url>
      
        <content type="html"><![CDATA[<h3 id="1-数据类型"><a href="#1-数据类型" class="headerlink" title="1.数据类型"></a>1.数据类型</h3><p>1.数据的基本类型分为基本数据类型(String, Number, Boolean, Null, Undefined，Symbol)和引用数据类型(Function,Array,Object)</p><p>2.基本数据类型的特点：直接存储在栈(stack)中的数据；引用数据类型的特点：<strong>存储的是该对象在栈中引用，真实的数据存放在堆内存里</strong></p><img src="/article/47599914/tp1.jpg" class> <p>引用数据类型在栈中存储了指针，该指针指向堆中该实体的起始地址。当解释器寻找引用值时，会首先检索其在栈中的地址，取得地址后从堆中获得实体。</p><h3 id="2-浅拷贝和深拷贝的概念"><a href="#2-浅拷贝和深拷贝的概念" class="headerlink" title="2.浅拷贝和深拷贝的概念"></a>2.浅拷贝和深拷贝的概念</h3><p><strong>1.深拷贝和浅拷贝是只针对Object和Array这样的引用数据类型</strong></p><p><strong>2.概念：</strong></p><p>​    <strong>浅拷贝</strong> ：只复制指向某个对象的指针，而不复制对象本身，相当于是新建了一个对象，该对象复制了原对象的指针，新旧对象还是共用同一个堆内存地址</p><p>​    <strong>深拷贝</strong>：是新建一个一模一样的对象，该对象与原对象不共享内存，修改新对象也不会影响原对象</p><h3 id="3-赋值和浅拷贝"><a href="#3-赋值和浅拷贝" class="headerlink" title="3.赋值和浅拷贝"></a>3.赋值和浅拷贝</h3><p><strong>1.赋值：</strong></p><p>当我们把一个对象赋值给一个新的变量时，<strong>赋的其实是该对象的在栈内存中的地址，而不是堆内存中的数据</strong>。也就是两个对象指向的是同一个存储空间，无论哪个对象发生改变，其实都是改变都是同一个堆内存空间</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//定义一个obj1对象</span></span><br><span class="line"><span class="keyword">var</span> obj1 = &#123;</span><br><span class="line">   <span class="string">&#x27;name&#x27;</span> : <span class="string">&#x27;hello&#x27;</span>,</span><br><span class="line">   <span class="string">&#x27;age&#x27;</span> :  <span class="string">&#x27;20&#x27;</span>,</span><br><span class="line">   <span class="string">&#x27;language&#x27;</span> : [<span class="string">&#x27;a&#x27;</span>,[<span class="string">&#x27;b&#x27;</span>,<span class="string">&#x27;c&#x27;</span>],[<span class="number">1</span>,<span class="number">2</span>]],</span><br><span class="line">&#125;;</span><br><span class="line"><span class="comment">//把obj1赋值给obj2</span></span><br><span class="line"><span class="keyword">var</span> obj2 = obj1;</span><br><span class="line"><span class="comment">//修改obj2的数据</span></span><br><span class="line">obj2.<span class="property">name</span> = <span class="string">&quot;world&quot;</span>;</span><br><span class="line">obj2.<span class="property">language</span>[<span class="number">1</span>] = [<span class="string">&quot;你&quot;</span>,<span class="string">&quot;好&quot;</span>];</span><br><span class="line"><span class="comment">//打印输出</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;obj1：&#x27;</span>,obj1)</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;obj2：&#x27;</span>,obj2)</span><br></pre></td></tr></table></figure><img src="/article/47599914/tp2.png" class> <p>以上，可以看出当你把obj1赋值给obj2后，因为赋值后的对象obj2赋值的是原对象obj1的栈内存地址，在对obj2的数据进行修改后,原数据obj1的值也进行了改变。</p><p><strong>2.浅拷贝：</strong></p><p>浅拷贝是按位拷贝对象，<strong>它会创建一个新对象</strong>，这个对象有着原始对象属性值的一份精确拷贝。如果属性是<strong>基本类型</strong>，拷贝的就是<strong>基本类型的值</strong>；如果属性是<strong>内存地址（引用类型）</strong>，拷贝的就是<strong>内存地址</strong> ，因此如果其中一个对象改变了这个地址，就会影响到另一个对象。即默认拷贝构造函数只是对对象进行浅拷贝复制(逐个成员依次拷贝)，即只复制对象空间而不复制资源。</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 定义一个obj1对象</span></span><br><span class="line"><span class="keyword">var</span> obj1 = &#123;</span><br><span class="line">   <span class="string">&#x27;name&#x27;</span> : <span class="string">&#x27;hello&#x27;</span>,</span><br><span class="line">   <span class="string">&#x27;age&#x27;</span> :  <span class="string">&#x27;20&#x27;</span>,</span><br><span class="line">   <span class="string">&#x27;language&#x27;</span> : [<span class="string">&#x27;a&#x27;</span>,<span class="string">&#x27;b&#x27;</span>,<span class="string">&#x27;c&#x27;</span>],</span><br><span class="line">&#125;;</span><br><span class="line"><span class="comment">// 把obj1浅拷贝为obj3</span></span><br><span class="line"><span class="keyword">var</span> obj3 = <span class="title function_">shallowCopy</span>(obj1)</span><br><span class="line"><span class="keyword">function</span> <span class="title function_">shallowCopy</span> (src)&#123;</span><br><span class="line"> <span class="keyword">var</span> newObj = &#123;&#125;;</span><br><span class="line"> <span class="keyword">for</span>(<span class="keyword">var</span> prop <span class="keyword">in</span> src )&#123;</span><br><span class="line">     <span class="variable language_">console</span>.<span class="title function_">log</span>(prop)</span><br><span class="line"><span class="comment">//hasOwnProperty(propertyName)方法 是用来检测属性是否为对象的自有属性，如果是，返回true，否者false;</span></span><br><span class="line"><span class="comment">//参数propertyName指要检测的属性名；</span></span><br><span class="line">     <span class="keyword">if</span>(src.<span class="title function_">hasOwnProperty</span>(prop))&#123;</span><br><span class="line">         newObj[prop] = src[prop]</span><br><span class="line">     &#125;</span><br><span class="line"> &#125;</span><br><span class="line"> <span class="keyword">return</span> newObj</span><br><span class="line">&#125;</span><br><span class="line"> obj3.<span class="property">name</span> = <span class="string">&#x27;world&#x27;</span></span><br><span class="line"> obj3.<span class="property">language</span>[<span class="number">0</span>] = <span class="string">&#x27;ddd&#x27;</span></span><br><span class="line">   </span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;obj1&quot;</span>, obj1);</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;obj3&quot;</span>, obj3); </span><br><span class="line"></span><br></pre></td></tr></table></figure><p>以上，可以看出在进行浅拷贝之后，对obj3基本类型的值name进行修改，而原对象obj1的值name并没有改变，而对obj3的引用类型language进行修改后，原对象obj1的值language发生了改变。</p><p>所以，浅拷贝是对原对象的属性值进行精准复制，如果原对象的属性值是<strong>基本类型</strong>，那就是值的引用，所以浅拷贝后修改基本类型不会修改到原对象的，如果原对象属性值是<strong>引用类型</strong>，那么就是对引用类型属性值的栈内存的复制，所以修改引用类型属性值的时候会修改到原对象。</p><h3 id="4-浅拷贝的方式"><a href="#4-浅拷贝的方式" class="headerlink" title="4.浅拷贝的方式"></a>4.浅拷贝的方式</h3><p><strong>1.Object.assign()</strong></p><p>Object.assign() 方法可以把任意多个的源对象自身的可枚举属性拷贝给目标对象，然后返回目标对象。</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> obj1 = &#123;</span><br><span class="line"><span class="attr">name</span>: <span class="string">&#x27;hello&#x27;</span>,</span><br><span class="line"><span class="attr">age</span>: <span class="number">20</span>,</span><br><span class="line"><span class="attr">hobby</span>: &#123;</span><br><span class="line"><span class="attr">ball</span>: <span class="string">&#x27;a&#x27;</span></span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">let</span> obj2 = <span class="title class_">Object</span>.<span class="title function_">assign</span>(&#123;&#125;,obj1)</span><br><span class="line">obj2.<span class="property">name</span> = <span class="string">&#x27;world&#x27;</span></span><br><span class="line">obj2.<span class="property">hobby</span>.<span class="property">ball</span> = <span class="string">&#x27;b&#x27;</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;obj1&#x27;</span>, obj1.<span class="property">name</span>) <span class="comment">//hello</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;obj2&#x27;</span>, obj2.<span class="property">name</span>) <span class="comment">//world</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;obj1&#x27;</span>, obj1.<span class="property">hobby</span>.<span class="property">ball</span>) <span class="comment">//b</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;obj2&#x27;</span>, obj2.<span class="property">hobby</span>.<span class="property">ball</span>) <span class="comment">//b</span></span><br></pre></td></tr></table></figure><p><strong>注意：</strong>当object只有一层的时候，是深拷贝</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> obj = &#123;</span><br><span class="line">   <span class="attr">name</span>: <span class="string">&#x27;hello&#x27;</span></span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">let</span> obj2 = <span class="title class_">Object</span>.<span class="title function_">assign</span>(&#123;&#125;,obj);</span><br><span class="line">obj2.<span class="property">username</span> = <span class="string">&#x27;world&#x27;</span>;</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(obj);<span class="comment">//name:hello</span></span><br></pre></td></tr></table></figure><p><strong>2.Array.prototype.slice()</strong></p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> arr = [<span class="number">1</span>, <span class="number">2</span>, &#123;</span><br><span class="line">   <span class="attr">name</span>: <span class="string">&#x27; hello&#x27;</span></span><br><span class="line">&#125;];</span><br><span class="line"><span class="keyword">let</span> arr3 = arr.<span class="title function_">slice</span>();</span><br><span class="line">arr3[<span class="number">2</span>].<span class="property">name</span> = <span class="string">&#x27;world&#x27;</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(arr);<span class="comment">//name:world</span></span><br></pre></td></tr></table></figure><p><strong>3.Array.prototype.concat()</strong></p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> arr = [<span class="number">1</span>, <span class="number">2</span>, &#123;</span><br><span class="line">   <span class="attr">name</span>: <span class="string">&#x27;hello&#x27;</span></span><br><span class="line">&#125;];</span><br><span class="line"><span class="keyword">let</span> arr2=arr.<span class="title function_">concat</span>();    </span><br><span class="line">arr2[<span class="number">2</span>].<span class="property">name</span> = <span class="string">&#x27;world&#x27;</span>;</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(arr);<span class="comment">//name:world</span></span><br></pre></td></tr></table></figure><h3 id="5-深拷贝的方式"><a href="#5-深拷贝的方式" class="headerlink" title="5.深拷贝的方式"></a>5.深拷贝的方式</h3><p><strong>1.JSON.parse(JSON.stringify())</strong></p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> arr = [<span class="number">1</span>, <span class="number">2</span>,&#123;</span><br><span class="line"><span class="attr">name</span>: <span class="string">&#x27;hello&#x27;</span></span><br><span class="line">&#125;];</span><br><span class="line"><span class="keyword">let</span> arr1 = <span class="title class_">JSON</span>.<span class="title function_">parse</span>(<span class="title class_">JSON</span>.<span class="title function_">stringify</span>(arr))</span><br><span class="line">arr1[<span class="number">2</span>].<span class="property">name</span> = <span class="string">&#x27;world&#x27;</span></span><br><span class="line">arr1[<span class="number">0</span>] = <span class="number">5</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(arr[<span class="number">2</span>].<span class="property">name</span>) <span class="comment">//hello</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(arr[<span class="number">0</span>]) <span class="comment">//1</span></span><br></pre></td></tr></table></figure><p>原理就是用JSON.stringify将对象转成JSON字符串，再用JSON.parse()把字符串解析成对象，一去一来，新的对象产生了，而且对象会开辟新的栈内存，</p><p><strong>缺点</strong>：当对象里面有函数的话，深拷贝后，函数会消失</p><p><strong>2.手写递归函数实现深拷贝</strong></p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> obj = &#123; <span class="comment">//原数据，包含字符串、对象、函数、数组等不同的类型</span></span><br><span class="line"><span class="attr">name</span>: <span class="string">&quot;hello&quot;</span>,</span><br><span class="line"><span class="attr">main</span>: &#123;</span><br><span class="line"><span class="attr">a</span>: <span class="number">1</span>,</span><br><span class="line"><span class="attr">b</span>: <span class="number">2</span></span><br><span class="line">&#125;,</span><br><span class="line"><span class="attr">fn</span>: <span class="keyword">function</span>(<span class="params"></span>) &#123;&#125;,</span><br><span class="line"><span class="attr">friends</span>: [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, [<span class="number">4</span>, <span class="number">5</span>]]</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">function</span> <span class="title function_">copy</span>(<span class="params">obj</span>) &#123;</span><br><span class="line"><span class="comment">//声明一个变量用来储存拷贝之后的内容</span></span><br><span class="line"><span class="keyword">let</span> newobj = <span class="literal">null</span>; </span><br><span class="line"><span class="comment">//判断数据类型是否是复杂类型，如果是则调用自己，再次循环，如果不是，直接赋值即可，</span></span><br><span class="line"><span class="comment">//由于null不可以循环但类型又是object，所以这个需要对null进行判断</span></span><br><span class="line"><span class="keyword">if</span> (<span class="title function_">typeof</span>(obj) == <span class="string">&#x27;object&#x27;</span> &amp;&amp; obj !== <span class="literal">null</span>) &#123;</span><br><span class="line"><span class="comment">//声明一个变量用以储存拷贝出来的值,根据参数的具体数据类型声明不同的类型来储存</span></span><br><span class="line">newobj = obj <span class="keyword">instanceof</span> <span class="title class_">Array</span> ? [] : &#123;&#125;;</span><br><span class="line"><span class="comment">//循环obj 中的每一项，如果里面还有复杂数据类型，则直接利用递归再次调用copy函数</span></span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">var</span> i <span class="keyword">in</span> obj) &#123;</span><br><span class="line">newobj[i] = <span class="title function_">copy</span>(obj[i])</span><br><span class="line">&#125;</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">newobj = obj</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> newobj; <span class="comment">//函数必须有返回值，否则结构为undefined</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">var</span> obj2 = <span class="title function_">copy</span>(obj)</span><br><span class="line">obj2.<span class="property">name</span> = <span class="string">&#x27;world&#x27;</span></span><br><span class="line">obj2.<span class="property">main</span>.<span class="property">a</span> = <span class="number">100</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(obj)</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(obj2)</span><br></pre></td></tr></table></figure><img src="/article/47599914/tp3.png" class> <p><strong>递归方法实现深度克隆原理</strong>：遍历对象、数组直到里边都是基本数据类型，然后再去复制，就是深度拷贝</p>]]></content>
      
      
      <categories>
          
          <category> js </category>
          
      </categories>
      
      
        <tags>
            
            <tag> js </tag>
            
            <tag> 面试 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Vue+Node.js实现简单的前后端交互</title>
      <link href="/article/39fd23a9.html"/>
      <url>/article/39fd23a9.html</url>
      
        <content type="html"><![CDATA[<h3 id="1-搭建Vue项目"><a href="#1-搭建Vue项目" class="headerlink" title="1.搭建Vue项目"></a>1.搭建Vue项目</h3><p>1.在cmd中运行 vue ui，按照自己想要的配置进行搭建</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">vue ui</span><br></pre></td></tr></table></figure><p>2.在vue项目的根目录下安装axios 和Element UI</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">npm install axios --save</span><br><span class="line">npm i element-ui -S</span><br></pre></td></tr></table></figure><p>3.安装完成后，在main.js中引入</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> axios <span class="keyword">from</span> <span class="string">&#x27;axios&#x27;</span><span class="comment">//引入axios</span></span><br><span class="line"><span class="title class_">Vue</span>.<span class="property"><span class="keyword">prototype</span></span>.<span class="property">$axios</span> = axios;<span class="comment">//把axios挂载到vue上</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">ElementUI</span> <span class="keyword">from</span> <span class="string">&#x27;element-ui&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> <span class="string">&#x27;element-ui/lib/theme-chalk/index.css&#x27;</span>;</span><br><span class="line"><span class="title class_">Vue</span>.<span class="title function_">use</span>(<span class="title class_">ElementUI</span>);</span><br></pre></td></tr></table></figure><h3 id="2-搭建Node-js项目"><a href="#2-搭建Node-js项目" class="headerlink" title="2.搭建Node.js项目"></a>2.搭建Node.js项目</h3><p>1.新建一个 server 文件夹，作为项目的根目录，并运行命令</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm init -y</span><br></pre></td></tr></table></figure><p>2.安装 express，cors</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">npm i express@4.17.1</span><br><span class="line">npm i cors@2.8.5</span><br></pre></td></tr></table></figure><p>3.在项目根目录新建 app.js 作为入口文件，并写入如下代码：</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 导入express</span></span><br><span class="line"><span class="keyword">const</span> express = <span class="built_in">require</span>(<span class="string">&#x27;express&#x27;</span>)</span><br><span class="line"><span class="comment">// 创建express服务器实例</span></span><br><span class="line"><span class="keyword">const</span> app = <span class="title function_">express</span>()</span><br><span class="line"><span class="comment">// 导入cors 中间件</span></span><br><span class="line"><span class="keyword">const</span> cors = <span class="built_in">require</span>(<span class="string">&#x27;cors&#x27;</span>)</span><br><span class="line"><span class="comment">// cors注册为全局中间件</span></span><br><span class="line">app.<span class="title function_">use</span>(<span class="title function_">cors</span>())</span><br><span class="line"><span class="comment">// 解析application/x-www-form-urlencoded 格式</span></span><br><span class="line">app.<span class="title function_">use</span>(express.<span class="title function_">urlencoded</span>(&#123;<span class="attr">exrended</span>:<span class="literal">false</span>&#125;))</span><br><span class="line"></span><br><span class="line">app.<span class="title function_">listen</span>(<span class="string">&#x27;3008&#x27;</span>,<span class="keyword">function</span>(<span class="params"></span>)&#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;api server running at http://127.0.0.1:3008&#x27;</span>);</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><p>3.在项目根目录，新建 router 文件夹，存放路由模块；新建router_handler文件夹，存放路由处理函数模块</p><p>4.在router文件夹中，新建 user.js  文件，作为用户的路由模块，并写入如下代码：</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 导入express</span></span><br><span class="line"><span class="keyword">const</span> express = <span class="built_in">require</span>(<span class="string">&#x27;express&#x27;</span>)</span><br><span class="line"><span class="comment">// 导入router</span></span><br><span class="line"><span class="keyword">const</span> router = express.<span class="title class_">Router</span>()</span><br><span class="line"><span class="comment">// 暴露</span></span><br><span class="line"><span class="variable language_">module</span>.<span class="property">exports</span> = router</span><br></pre></td></tr></table></figure><p>5.在 app.js 中导入并使用路由模块</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 导入并使用路由模块</span></span><br><span class="line"><span class="keyword">const</span> userRouter = <span class="built_in">require</span>(<span class="string">&#x27;./router/user&#x27;</span>)</span><br><span class="line">app.<span class="title function_">use</span>(<span class="string">&#x27;/api&#x27;</span>,userRouter)</span><br></pre></td></tr></table></figure><p>6.在 router_handler 文件夹中，新建 userhandler.js ，作为存放用户路由处理函数模块</p><h3 id="3-配置MySQL模块"><a href="#3-配置MySQL模块" class="headerlink" title="3.配置MySQL模块"></a>3.配置MySQL模块</h3><p>1.安装mysql模块</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm i mysql@2.18.1</span><br></pre></td></tr></table></figure><p>2.在 server 文件中 新建 /db/index.js 文件，创建数据库连接对象：</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 导入mysql模块</span></span><br><span class="line"><span class="keyword">const</span> mysql = <span class="built_in">require</span>(<span class="string">&#x27;mysql&#x27;</span>)</span><br><span class="line"><span class="comment">// 配置数据库</span></span><br><span class="line"><span class="keyword">const</span> db = mysql.<span class="title function_">createPool</span>(&#123;</span><br><span class="line">    <span class="attr">host</span>:<span class="string">&#x27;127.0.0.1&#x27;</span>,</span><br><span class="line">    <span class="attr">user</span>:<span class="string">&#x27;root&#x27;</span>,</span><br><span class="line">    <span class="attr">password</span>:<span class="string">&#x27;123456&#x27;</span>,</span><br><span class="line">    <span class="attr">database</span>:<span class="string">&#x27;test&#x27;</span></span><br><span class="line">&#125;)</span><br><span class="line"><span class="comment">// 暴露</span></span><br><span class="line"><span class="variable language_">module</span>.<span class="property">exports</span> = db</span><br></pre></td></tr></table></figure><h3 id="4-编写接口"><a href="#4-编写接口" class="headerlink" title="4.编写接口"></a>4.编写接口</h3><p>1.在 \router_handler\userHeandler.js 中导入 index.js 数据库文件</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 导入index文件</span></span><br><span class="line"><span class="keyword">const</span> db = <span class="built_in">require</span>(<span class="string">&#x27;../db/index&#x27;</span>)</span><br></pre></td></tr></table></figure><p>2.使用exports对象，编写 路由处理函数</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//查询用户信息</span></span><br><span class="line"><span class="built_in">exports</span>.<span class="property">getUserInfo</span> = <span class="function">(<span class="params">req, res</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">const</span> sql = <span class="string">`select * from t_user`</span></span><br><span class="line">    db.<span class="title function_">query</span>(sql,<span class="function">(<span class="params">err,results</span>)=&gt;</span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (err) &#123;</span><br><span class="line">            res.<span class="title function_">send</span>(&#123;<span class="attr">code</span>:<span class="number">201</span>,<span class="attr">message</span>:<span class="string">&#x27;查询失败&#x27;</span>&#125;)</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            res.<span class="title function_">send</span>(&#123; <span class="attr">code</span>: <span class="number">200</span>, <span class="attr">message</span>: <span class="string">&#x27;查询成功&#x27;</span>,<span class="attr">data</span>:results&#125;)</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>3.在 \router\user.js 中导入userHandler文件并使用</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 导入userHandler文件并使用</span></span><br><span class="line"><span class="keyword">const</span> userHandler = <span class="built_in">require</span>(<span class="string">&#x27;../router_handler/userHeandler&#x27;</span>)</span><br><span class="line">router.<span class="title function_">get</span>(<span class="string">&#x27;/user/list&#x27;</span>,userHandler.<span class="property">getUserInfo</span>)</span><br></pre></td></tr></table></figure><p>4.运行app.js，使用postman调试接口</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">node app.js</span><br></pre></td></tr></table></figure><p>5.编写其他接口函数</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//新增用户</span></span><br><span class="line"><span class="built_in">exports</span>.<span class="property">addUserInfo</span> = <span class="function">(<span class="params">req, res</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">const</span> data = req.<span class="property">body</span></span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(data);</span><br><span class="line">    <span class="keyword">const</span> sql = <span class="string">`insert into t_user(u_name,u_email,u_sex,u_province,u_hobby) values(&#x27;<span class="subst">$&#123;data.u_name&#125;</span>&#x27;,&#x27;<span class="subst">$&#123;data.u_email&#125;</span>&#x27;,&#x27;<span class="subst">$&#123;data.u_sex&#125;</span>&#x27;,&#x27;<span class="subst">$&#123;data.u_province&#125;</span>&#x27;,&#x27;<span class="subst">$&#123;data.u_hobby&#125;</span>&#x27;)`</span></span><br><span class="line">    db.<span class="title function_">query</span>(sql,<span class="function">(<span class="params">err,results</span>)=&gt;</span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (err) &#123;</span><br><span class="line">            res.<span class="title function_">send</span>(&#123;<span class="attr">code</span>:<span class="number">201</span>,<span class="attr">message</span>:<span class="string">&#x27;新增失败&#x27;</span>&#125;)</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            res.<span class="title function_">send</span>(&#123; <span class="attr">code</span>: <span class="number">200</span>, <span class="attr">message</span>: <span class="string">&#x27;新增成功&#x27;</span>&#125;)</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;)</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//删除用户</span></span><br><span class="line"><span class="built_in">exports</span>.<span class="property">deleteUserInfo</span> = <span class="function">(<span class="params">req, res</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">const</span> data = req.<span class="property">body</span></span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(data);</span><br><span class="line">    <span class="keyword">const</span> sql = <span class="string">`delete from t_user where u_id = &#x27;<span class="subst">$&#123;data.u_id&#125;</span>&#x27;`</span></span><br><span class="line">    db.<span class="title function_">query</span>(sql,<span class="function">(<span class="params">err,results</span>)=&gt;</span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (err) &#123;</span><br><span class="line">            res.<span class="title function_">send</span>(&#123;<span class="attr">code</span>:<span class="number">201</span>,<span class="attr">message</span>:<span class="string">&#x27;删除失败&#x27;</span>&#125;)</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            res.<span class="title function_">send</span>(&#123; <span class="attr">code</span>: <span class="number">200</span>, <span class="attr">message</span>: <span class="string">&#x27;删除成功&#x27;</span>&#125;)</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>6.在 \router\user.js 中使用</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">router.<span class="title function_">post</span>(<span class="string">&#x27;/user/add&#x27;</span>,userHandler.<span class="property">addUserInfo</span>)</span><br><span class="line">router.<span class="title function_">post</span>(<span class="string">&#x27;/user/delete&#x27;</span>,userHandler.<span class="property">deleteUserInfo</span>)</span><br></pre></td></tr></table></figure><h3 id="5-Vue实现页面渲染"><a href="#5-Vue实现页面渲染" class="headerlink" title="5.Vue实现页面渲染"></a>5.Vue实现页面渲染</h3><p>1.在 src 文件夹下，新建一个 /api/index.js 和 /api/api.js</p><p>2.在 index.js 中导入 axios 并获取后端地址：</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 导入axios</span></span><br><span class="line"><span class="keyword">import</span> axios <span class="keyword">from</span> <span class="string">&#x27;axios&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> serve = axios.<span class="title function_">create</span>(&#123;</span><br><span class="line">    <span class="attr">baseURL</span>:<span class="string">&quot;http://127.0.0.1:3008/api&quot;</span>,</span><br><span class="line">    <span class="attr">timeout</span>:<span class="number">3000</span>,</span><br><span class="line"></span><br><span class="line">&#125;)</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> serve</span><br></pre></td></tr></table></figure><p>3.在 api.js 中导入index.js文件，并封装接口</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> serve <span class="keyword">from</span> <span class="string">&#x27;../api/index&#x27;</span></span><br><span class="line"><span class="keyword">import</span> qs <span class="keyword">from</span> <span class="string">&#x27;qs&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//获取用户信息</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">function</span> <span class="title function_">getUserInfo</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="title function_">serve</span>(&#123;</span><br><span class="line">        <span class="attr">method</span>: <span class="string">&#x27;GET&#x27;</span>,</span><br><span class="line">        <span class="attr">url</span>: <span class="string">&#x27;/user/list&#x27;</span>,</span><br><span class="line">    &#125;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>4.在vue文件中使用接口</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//获取用户信息</span></span><br><span class="line"><span class="keyword">async</span> <span class="title function_">getUserList</span>(<span class="params"></span>)&#123;</span><br><span class="line">    <span class="keyword">const</span> &#123;<span class="attr">data</span>:res&#125; = <span class="keyword">await</span> <span class="title function_">getUserInfo</span>()</span><br><span class="line"><span class="keyword">if</span> (res.<span class="property">code</span> != <span class="number">200</span>) <span class="keyword">return</span> <span class="variable language_">this</span>.<span class="property">$message</span>.<span class="title function_">error</span>(<span class="string">&quot;查询用户失败！&quot;</span>);</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">tableData</span> = res.<span class="property">data</span></span><br><span class="line">&#125;,</span><br></pre></td></tr></table></figure><h3 id="6-Vue页面代码汇总"><a href="#6-Vue页面代码汇总" class="headerlink" title="6.Vue页面代码汇总"></a>6.Vue页面代码汇总</h3><p>1.HomeView.js页面代码</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">template</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;home&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">form</span> @<span class="attr">submit.prevent</span>=<span class="string">&quot;demo&quot;</span> <span class="attr">class</span>=<span class="string">&quot;home-form&quot;</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">table</span> <span class="attr">border</span>=<span class="string">&quot;1&quot;</span> <span class="attr">cellspacing</span>=<span class="string">&quot;0&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">tr</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">td</span>&gt;</span>用户名：<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">td</span>&gt;</span><span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;text&quot;</span> <span class="attr">v-model</span>=<span class="string">&quot;userInfo.u_name&quot;</span> /&gt;</span><span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">tr</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">tr</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">td</span>&gt;</span>邮箱：<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">td</span>&gt;</span><span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;text&quot;</span> <span class="attr">v-model</span>=<span class="string">&quot;userInfo.u_email&quot;</span> /&gt;</span><span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">tr</span>&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="tag">&lt;<span class="name">tr</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">td</span>&gt;</span>性别：<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">td</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">input</span></span></span><br><span class="line"><span class="tag">              <span class="attr">type</span>=<span class="string">&quot;radio&quot;</span></span></span><br><span class="line"><span class="tag">              <span class="attr">v-model</span>=<span class="string">&quot;userInfo.u_sex&quot;</span></span></span><br><span class="line"><span class="tag">              <span class="attr">name</span>=<span class="string">&quot;u_sex&quot;</span></span></span><br><span class="line"><span class="tag">              <span class="attr">value</span>=<span class="string">&quot;男&quot;</span></span></span><br><span class="line"><span class="tag">              <span class="attr">checked</span>=<span class="string">&quot;checked&quot;</span></span></span><br><span class="line"><span class="tag">            /&gt;</span>男</span><br><span class="line">            <span class="tag">&lt;<span class="name">input</span></span></span><br><span class="line"><span class="tag">              <span class="attr">type</span>=<span class="string">&quot;radio&quot;</span></span></span><br><span class="line"><span class="tag">              <span class="attr">v-model</span>=<span class="string">&quot;userInfo.u_sex&quot;</span></span></span><br><span class="line"><span class="tag">              <span class="attr">name</span>=<span class="string">&quot;u_sex&quot;</span></span></span><br><span class="line"><span class="tag">              <span class="attr">value</span>=<span class="string">&quot;女&quot;</span></span></span><br><span class="line"><span class="tag">            /&gt;</span>女</span><br><span class="line">            <span class="tag">&lt;<span class="name">input</span></span></span><br><span class="line"><span class="tag">              <span class="attr">type</span>=<span class="string">&quot;radio&quot;</span></span></span><br><span class="line"><span class="tag">              <span class="attr">v-model</span>=<span class="string">&quot;userInfo.u_sex&quot;</span></span></span><br><span class="line"><span class="tag">              <span class="attr">name</span>=<span class="string">&quot;u_sex&quot;</span></span></span><br><span class="line"><span class="tag">              <span class="attr">value</span>=<span class="string">&quot;未知&quot;</span></span></span><br><span class="line"><span class="tag">            /&gt;</span>未知</span><br><span class="line">          <span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">tr</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">tr</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">td</span>&gt;</span>省份：<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">td</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">select</span> <span class="attr">v-model</span>=<span class="string">&quot;userInfo.u_province&quot;</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">option</span> <span class="attr">value</span>=<span class="string">&quot;湖北省&quot;</span>&gt;</span>湖北省<span class="tag">&lt;/<span class="name">option</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">option</span> <span class="attr">value</span>=<span class="string">&quot;上海市&quot;</span>&gt;</span>上海市<span class="tag">&lt;/<span class="name">option</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">option</span> <span class="attr">value</span>=<span class="string">&quot;重庆市&quot;</span>&gt;</span>重庆市<span class="tag">&lt;/<span class="name">option</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">option</span> <span class="attr">value</span>=<span class="string">&quot;湖南省&quot;</span>&gt;</span>湖南省<span class="tag">&lt;/<span class="name">option</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">tr</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">tr</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">td</span>&gt;</span>爱好：<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">td</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">input</span></span></span><br><span class="line"><span class="tag">              <span class="attr">type</span>=<span class="string">&quot;checkbox&quot;</span></span></span><br><span class="line"><span class="tag">              <span class="attr">v-model</span>=<span class="string">&quot;userInfo.u_hobby&quot;</span></span></span><br><span class="line"><span class="tag">              <span class="attr">value</span>=<span class="string">&quot;篮球&quot;</span></span></span><br><span class="line"><span class="tag">            /&gt;</span>篮球</span><br><span class="line">            <span class="tag">&lt;<span class="name">input</span></span></span><br><span class="line"><span class="tag">              <span class="attr">type</span>=<span class="string">&quot;checkbox&quot;</span></span></span><br><span class="line"><span class="tag">              <span class="attr">v-model</span>=<span class="string">&quot;userInfo.u_hobby&quot;</span></span></span><br><span class="line"><span class="tag">              <span class="attr">value</span>=<span class="string">&quot;读书&quot;</span></span></span><br><span class="line"><span class="tag">            /&gt;</span>读书</span><br><span class="line">            <span class="tag">&lt;<span class="name">input</span></span></span><br><span class="line"><span class="tag">              <span class="attr">type</span>=<span class="string">&quot;checkbox&quot;</span></span></span><br><span class="line"><span class="tag">              <span class="attr">v-model</span>=<span class="string">&quot;userInfo.u_hobby&quot;</span></span></span><br><span class="line"><span class="tag">              <span class="attr">value</span>=<span class="string">&quot;插画&quot;</span></span></span><br><span class="line"><span class="tag">            /&gt;</span>插画</span><br><span class="line">            <span class="tag">&lt;<span class="name">input</span></span></span><br><span class="line"><span class="tag">              <span class="attr">type</span>=<span class="string">&quot;checkbox&quot;</span></span></span><br><span class="line"><span class="tag">              <span class="attr">v-model</span>=<span class="string">&quot;userInfo.u_hobby&quot;</span></span></span><br><span class="line"><span class="tag">              <span class="attr">value</span>=<span class="string">&quot;编程&quot;</span></span></span><br><span class="line"><span class="tag">            /&gt;</span>编程</span><br><span class="line">            <span class="tag">&lt;<span class="name">input</span></span></span><br><span class="line"><span class="tag">              <span class="attr">type</span>=<span class="string">&quot;checkbox&quot;</span></span></span><br><span class="line"><span class="tag">              <span class="attr">v-model</span>=<span class="string">&quot;userInfo.u_hobby&quot;</span></span></span><br><span class="line"><span class="tag">              <span class="attr">value</span>=<span class="string">&quot;弹琴&quot;</span></span></span><br><span class="line"><span class="tag">            /&gt;</span>弹琴</span><br><span class="line">          <span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">tr</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">table</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">button</span>&gt;</span>新增<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">form</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;home-box&quot;</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">el-table</span> <span class="attr">:data</span>=<span class="string">&quot;tableData&quot;</span> <span class="attr">border</span> <span class="attr">style</span>=<span class="string">&quot;width: 100%&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">el-table-column</span> <span class="attr">prop</span>=<span class="string">&quot;u_id&quot;</span> <span class="attr">label</span>=<span class="string">&quot;id&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">el-table-column</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">el-table-column</span> <span class="attr">prop</span>=<span class="string">&quot;u_name&quot;</span> <span class="attr">label</span>=<span class="string">&quot;用户名&quot;</span> &gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">el-table-column</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">el-table-column</span> <span class="attr">prop</span>=<span class="string">&quot;u_email&quot;</span> <span class="attr">label</span>=<span class="string">&quot;邮箱&quot;</span>&gt;</span> <span class="tag">&lt;/<span class="name">el-table-column</span>&gt;</span></span><br><span class="line">         <span class="tag">&lt;<span class="name">el-table-column</span> <span class="attr">prop</span>=<span class="string">&quot;u_sex&quot;</span> <span class="attr">label</span>=<span class="string">&quot;性别&quot;</span>&gt;</span> <span class="tag">&lt;/<span class="name">el-table-column</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">el-table-column</span> <span class="attr">prop</span>=<span class="string">&quot;u_province&quot;</span> <span class="attr">label</span>=<span class="string">&quot;省份&quot;</span>&gt;</span> <span class="tag">&lt;/<span class="name">el-table-column</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">el-table-column</span> <span class="attr">prop</span>=<span class="string">&quot;u_hobby&quot;</span> <span class="attr">label</span>=<span class="string">&quot;爱好&quot;</span>&gt;</span> <span class="tag">&lt;/<span class="name">el-table-column</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">el-table-column</span> <span class="attr">label</span>=<span class="string">&quot;操作&quot;</span>&gt;</span> </span><br><span class="line">          <span class="tag">&lt;<span class="name">template</span> <span class="attr">slot-scope</span>=<span class="string">&quot;scope&quot;</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">button</span> @<span class="attr">click</span> =<span class="string">&quot;deleteuser(scope.row.u_id)&quot;</span>&gt;</span>删除<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">el-table-column</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">el-table</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br></pre></td></tr></table></figure><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br></pre></td><td class="code"><pre><span class="line">&lt;script&gt;</span><br><span class="line"><span class="keyword">import</span> &#123; getUserInfo,postAddUser,deleteUser&#125; <span class="keyword">from</span> <span class="string">&quot;../api/api&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span><br><span class="line">  <span class="attr">name</span>: <span class="string">&quot;HomeView&quot;</span>,</span><br><span class="line">  <span class="title function_">data</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> &#123;</span><br><span class="line">      <span class="attr">userInfo</span>: &#123;</span><br><span class="line">        <span class="attr">u_name</span>: <span class="string">&quot;&quot;</span>,</span><br><span class="line">        <span class="attr">u_email</span>: <span class="string">&quot;&quot;</span>,</span><br><span class="line">        <span class="attr">u_sex</span>: <span class="string">&quot;&quot;</span>,</span><br><span class="line">        <span class="attr">u_province</span>: <span class="string">&quot;&quot;</span>,</span><br><span class="line">        <span class="attr">u_hobby</span>: [],</span><br><span class="line">      &#125;,</span><br><span class="line">      <span class="attr">tableData</span>:[]</span><br><span class="line">    &#125;;</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="title function_">created</span>(<span class="params"></span>)&#123;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="title function_">getUserList</span>()</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="attr">methods</span>: &#123;</span><br><span class="line">    <span class="keyword">async</span> <span class="title function_">getUserList</span>(<span class="params"></span>)&#123;</span><br><span class="line">      <span class="keyword">const</span> &#123;<span class="attr">data</span>:res&#125; = <span class="keyword">await</span> <span class="title function_">getUserInfo</span>()</span><br><span class="line">      <span class="keyword">if</span> (res.<span class="property">code</span> != <span class="number">200</span>) <span class="keyword">return</span> <span class="variable language_">this</span>.<span class="property">$message</span>.<span class="title function_">error</span>(<span class="string">&quot;查询用户失败！&quot;</span>);</span><br><span class="line">      <span class="variable language_">this</span>.<span class="property">tableData</span> = res.<span class="property">data</span></span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="keyword">async</span> <span class="title function_">demo</span>(<span class="params"></span>) &#123;</span><br><span class="line">      <span class="comment">//JSON.stringify() 将数据转换为json字符串</span></span><br><span class="line">      <span class="keyword">const</span> &#123;<span class="attr">data</span>:res&#125; = <span class="keyword">await</span> <span class="title function_">postAddUser</span>(<span class="variable language_">this</span>.<span class="property">userInfo</span>) </span><br><span class="line">      <span class="keyword">if</span> (res.<span class="property">code</span> != <span class="number">200</span>) <span class="keyword">return</span> <span class="variable language_">this</span>.<span class="property">$message</span>.<span class="title function_">error</span>(<span class="string">&quot;新增用户失败！&quot;</span>);</span><br><span class="line">      <span class="variable language_">this</span>.<span class="title function_">getUserList</span>() </span><br><span class="line"></span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="keyword">async</span> <span class="title function_">deleteuser</span>(<span class="params">id</span>)&#123;</span><br><span class="line">      <span class="keyword">const</span> confirmResult = <span class="keyword">await</span> <span class="variable language_">this</span>.$confirm(</span><br><span class="line">        <span class="string">&quot;此操作将删除该用户, 是否继续?&quot;</span>,</span><br><span class="line">        <span class="string">&quot;提示&quot;</span>,</span><br><span class="line">        &#123;</span><br><span class="line">          <span class="attr">confirmButtonText</span>: <span class="string">&quot;确定&quot;</span>,</span><br><span class="line">          <span class="attr">cancelButtonText</span>: <span class="string">&quot;取消&quot;</span>,</span><br><span class="line">          <span class="attr">type</span>: <span class="string">&quot;warning&quot;</span>,</span><br><span class="line">        &#125;</span><br><span class="line">      ).<span class="title function_">catch</span>(<span class="function">(<span class="params">err</span>) =&gt;</span> err);</span><br><span class="line">      <span class="keyword">if</span> (confirmResult !== <span class="string">&quot;confirm&quot;</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="variable language_">this</span>.<span class="property">$message</span>.<span class="title function_">info</span>(<span class="string">&quot;已取消删除&quot;</span>);</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">const</span> data = &#123;</span><br><span class="line">        u_id : id</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">const</span> &#123;<span class="attr">data</span>:res&#125; = <span class="keyword">await</span> <span class="title function_">deleteUser</span>(data) </span><br><span class="line">      <span class="keyword">if</span> (res.<span class="property">code</span> != <span class="number">200</span>) <span class="keyword">return</span> <span class="variable language_">this</span>.<span class="property">$message</span>.<span class="title function_">error</span>(<span class="string">&quot;删除用户失败！&quot;</span>);</span><br><span class="line">      <span class="variable language_">this</span>.<span class="title function_">getUserList</span>();</span><br><span class="line">      </span><br><span class="line">    &#125;,</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;;</span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></table></figure><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">&lt;style scoped&gt;</span><br><span class="line"><span class="selector-class">.home-form</span> &#123;</span><br><span class="line">  <span class="attribute">width</span>: <span class="number">60%</span>;</span><br><span class="line">  <span class="attribute">margin</span>: <span class="number">0</span> auto;</span><br><span class="line">  <span class="attribute">align-content</span>: center;</span><br><span class="line">  <span class="attribute">margin-top</span>: <span class="number">50px</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.home-form</span> <span class="selector-tag">table</span> &#123;</span><br><span class="line">  <span class="attribute">width</span>: <span class="number">100%</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.home-form</span> <span class="selector-tag">button</span> &#123;</span><br><span class="line">  <span class="attribute">display</span>: flex;</span><br><span class="line">  <span class="attribute">margin-top</span>: <span class="number">10px</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.home-box</span> &#123;</span><br><span class="line">  <span class="attribute">width</span>: <span class="number">60%</span>;</span><br><span class="line">  <span class="attribute">margin</span>: <span class="number">0</span> auto;</span><br><span class="line">  <span class="attribute">align-content</span>: center;</span><br><span class="line">  <span class="attribute">margin-top</span>: <span class="number">20px</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.home-box</span> <span class="selector-class">.el-table</span> &#123;</span><br><span class="line">  <span class="attribute">width</span>: <span class="number">100%</span>;</span><br><span class="line">&#125;</span><br><span class="line">&lt;/style&gt;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>2.api.js代码</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> serve <span class="keyword">from</span> <span class="string">&#x27;../api/index&#x27;</span></span><br><span class="line"><span class="keyword">import</span> qs <span class="keyword">from</span> <span class="string">&#x27;qs&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//获取用户信息</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">function</span> <span class="title function_">getUserInfo</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="title function_">serve</span>(&#123;</span><br><span class="line">        <span class="attr">method</span>: <span class="string">&#x27;GET&#x27;</span>,</span><br><span class="line">        <span class="attr">url</span>: <span class="string">&#x27;/user/list&#x27;</span>,</span><br><span class="line">    &#125;)</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//新增用户</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">function</span> <span class="title function_">postAddUser</span>(<span class="params">data</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="title function_">serve</span>(&#123;</span><br><span class="line">        <span class="attr">method</span>: <span class="string">&#x27;POST&#x27;</span>,</span><br><span class="line">        <span class="attr">url</span>: <span class="string">&#x27;/user/add&#x27;</span>,</span><br><span class="line">        <span class="attr">data</span>:qs.<span class="title function_">stringify</span>(data)</span><br><span class="line">    &#125;)</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// 删除用户</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">function</span> <span class="title function_">deleteUser</span>(<span class="params">data</span>) &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(data);</span><br><span class="line">    <span class="keyword">return</span> <span class="title function_">serve</span>(&#123;</span><br><span class="line">        <span class="attr">method</span>: <span class="string">&#x27;POST&#x27;</span>,</span><br><span class="line">        <span class="attr">url</span>: <span class="string">&#x27;/user/delete&#x27;</span>,</span><br><span class="line">        <span class="attr">data</span>:qs.<span class="title function_">stringify</span>(data)</span><br><span class="line">    &#125;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="7-效果展示"><a href="#7-效果展示" class="headerlink" title="7.效果展示"></a>7.效果展示</h3><img src="/article/39fd23a9/xg.gif" class title="效果展示"> ]]></content>
      
      
      <categories>
          
          <category> js </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Node.js </tag>
            
            <tag> js </tag>
            
            <tag> Vue </tag>
            
        </tags>
      
    </entry>
    
    
  
  
</search>
